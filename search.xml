<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[Git è¿›é˜¶ä½¿ç”¨]]></title>
    <url>%2F2020%2F02%2F01%2Fgit-usage-improve%2F</url>
    <content type="text"><![CDATA[æ€»ç»“æ—¥å¸¸å¼€å‘ä¸­çš„ Git è¿›é˜¶ä½¿ç”¨ è®°å½•å¤š SSH é…ç½®ï¼Œgit reflog è§£å†³ detached-head ä»£ç ä¸¢å¤±é—®é¢˜ æ€»ç»“å›¢é˜Ÿåä½œä¸‹ï¼Œå¦‚ä½•ä¿æŒ git æäº¤ä¿¡æ¯ç®€æ´ Changelog 2018/07/09ï¼Œæ’°å†™ 2019/03/10ï¼Œæ·»åŠ å¤šSSHé…ç½® 2019/04/26ï¼Œæ·»åŠ  git cherry-pick 2019/10/07ï¼Œæ·»åŠ å¦‚ä½•åˆ é™¤gitæ‰€æœ‰åŽ†å²æäº¤ä¿¡æ¯ 2019/10/14ï¼Œæ·»åŠ  git merge --no-ff 2019/12/14ï¼Œæ·»åŠ  git reflog ä½¿ç”¨ 2020/02/01ï¼Œæ·»åŠ  åˆ é™¤æ‰€æœ‰åŽ†å²æäº¤è®°å½• 2020/02/01ï¼Œæ·»åŠ  å›¢é˜Ÿåä½œä¸‹ï¼Œå¦‚ä½•ä¿æŒ git æäº¤ä¿¡æ¯ç®€æ´ Ref GitUp å¦‚ä½•é«˜æ•ˆä½¿ç”¨github git reflog è§£å†³æäº¤ä»£ç ä¸¢å¤± detached-headreflog æ˜¯ Git æ“ä½œçš„ä¸€é“å®‰å…¨ä¿éšœï¼Œå®ƒèƒ½å¤Ÿè®°å½•å‡ ä¹Žæ‰€æœ‰æœ¬åœ°ä»“åº“çš„æ”¹å˜ã€‚åŒ…æ‹¬æ‰€æœ‰åˆ†æ”¯ commit æäº¤ï¼Œå·²ç»åˆ é™¤ï¼ˆå…¶å®žå¹¶æœªè¢«å®žé™…åˆ é™¤ï¼‰commit éƒ½ä¼šè¢«è®°å½•ã€‚æ€»ç»“è€Œè¨€ï¼Œåªè¦ HEAD å‘ç”Ÿå˜åŒ–ï¼Œå°±å¯ä»¥é€šè¿‡ reflog æŸ¥çœ‹åˆ°ã€‚ detached-head ä»£ç ä¸¢å¤±æ‰¾å›ž gitæäº¤åˆ°HEAD detachedå¯¼è‡´ä»£ç ä¸¢å¤± StackOverflow - gitx How do I get my â€˜Detached HEADâ€™ commits back into master èƒŒæ™¯æ—¥å¸¸å¼€å‘ä¸­ï¼Œåˆ‡æ¢åˆ†æ”¯è¯¯æ“ä½œï¼Œé€ æˆæœ¬åœ°ä»£ç ä¿®æ”¹ä¸¢å¤±ã€‚ æ­¤æ—¶ï¼Œå¯ä»¥å€ŸåŠ© git reflog æ‰¾å›žä¸¢å¤±çš„ä»£ç ä¿®æ”¹ã€‚ ä¸¢å¤±äº§ç”ŸåŽŸå› å’Œæ­¥éª¤é¦–å…ˆåœ¨ master åˆ†æ”¯ä¸Šå¼€å‘ï¼Œæ­¤æ—¶çº¿ä¸Šå‡ºçŽ° bug ä¸”å›žåˆ°æ—§ç‰ˆæœ¬çš„ tagã€‚è¿™æ—¶ master åˆ†æ”¯ä¸Šæœ‰ä¸€éƒ¨åˆ†ä»£ç ä¿®æ”¹ä½†æœªæäº¤ã€‚ åœ¨ master åˆ†æ”¯ä¸Šæ‰§è¡Œ git statusï¼Œæœ‰æœªæäº¤çš„ä»£ç ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º åœ¨ master åˆ†æ”¯ä¸Šæ‰§è¡Œ git tagæŸ¥çœ‹æ ‡ç­¾ä¿¡æ¯ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º æ­¤æ—¶æœ‰æœªæäº¤çš„ä»£ç ï¼Œç„¶åŽæ‰§è¡Œ git checkout v1.0 è¿™ä¸ªæ—¶å€™ï¼Œæç¤ºå½“å‰åˆ†æ”¯ä¸º detached HEAD ç„¶åŽå†æ‰§è¡Œ git add ./git commit å’Œ git checkout masterï¼Œåˆ‡æ¢å›ž master åˆ†æ”¯ã€‚è¿™ä¸ªæ—¶å€™å‘çŽ° detached HEAD åˆ†æ”¯ä¸è§äº†ï¼Œmaster åˆ†æ”¯ä¸Šæœªæäº¤çš„ä»£ç ä¹Ÿä¸è§äº†ã€‚ ä»£ç æ‰¾å›žæ‰§è¡Œ git reflog æŸ¥çœ‹æäº¤è®°å½• æŸ¥æ‰¾å¯¹åº”æäº¤çš„ commitId ä¸º 247e11bï¼Œç„¶åŽæ‰§è¡Œä¸‹è¿°å‘½ä»¤è¡Œï¼Œæ‰¾å›žä¸¢å¤±çš„ä»£ç  1234git checkout 247e11b //æ£€å‡ºå¯¹åº”çš„æäº¤git checkout -b diff //æ–°å»ºä¸€ä¸ªæ–°çš„diffåˆ†æ”¯git checkout master //åˆ‡æ¢åˆ°masteråˆ†æ”¯git merge diff //å°†æ–°å»ºçš„diffåˆ†æ”¯åˆå¹¶åˆ°masteråˆ†æ”¯ åˆ é™¤æ‰€æœ‰åŽ†å²æäº¤è®°å½• How to delete all commit history in github | Stackoverflow æ­¤å¤„ä»‹ç»å¦‚ä½•åˆ é™¤æ‰€æœ‰åŽ†å²æäº¤è®°å½•ï¼Œå½¢æˆä¸€ä¸ªå…¨æ–°çš„ä»“åº“ã€‚ 1 - Checkout 1git checkout --orphan new_branch 2 - Add all the files 123git add -A//ç­‰æ•ˆäºŽ git add --all æˆ– git add . git add ä¸­ä½¿ç”¨å‚æ•° -A æˆ– --all è¡¨ç¤ºè¿½è¸ªæ‰€æœ‰æ“ä½œï¼ŒåŒ…å«æ–°å¢žã€ä¿®æ”¹å’Œåˆ é™¤ Git 2.0ç‰ˆå¼€å§‹ï¼Œ-A å‚æ•°ä¸ºé»˜è®¤å‚æ•°ï¼Œå³ git add . ç­‰æ•ˆäºŽ git add -A æˆ– git add --all 3 - Commit the changes 1git commit -am "commit message" 4 - Delete the branch 1git branch -D master //åŒæ—¶åˆ é™¤æœ¬åœ°å’Œè¿œç¨‹åˆ†æ”¯ 5 - Rename the current branch to master 1git branch -m master 6 - force update your repository 1git push -f origin master ä¸‹é¢å¯¹ä¸Šè¿°æ­¥éª¤è¿›è¡Œè¯´æ˜Ž git checkout â€“orphanå¦‚æžœä½ çš„æŸä¸ªåˆ†æ”¯ä¸Šç§¯ç´¯äº†æ— æ•°æ¬¡çš„æ— æ„ä¹‰çš„æäº¤ï¼Œgit log ä¿¡æ¯æ»¡å¤©é£žï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ git checkout --orphan &lt;new_branch_name&gt; åŸºäºŽå½“å‰åˆ†æ”¯åˆ›å»ºä¸€ä¸ªæ–°çš„â€œå­¤å„¿(orphan)â€çš„åˆ†æ”¯ï¼Œæ²¡æœ‰ä»»ä½•æäº¤åŽ†å²ï¼Œä½†åŒ…å«å½“å‰åˆ†æ”¯æ‰€æœ‰å†…å®¹ æ‰§è¡Œä¸Šè¿°å‘½ä»¤åŽï¼Œå·¥ä½œåŒºï¼ˆWorkspaceï¼‰ä¸­æ‰€æœ‰æ–‡ä»¶å‡è¢«è®¤ä¸ºåœ¨è¯¥æ“ä½œä¸­æ–°å¢ž(git statue æŸ¥çœ‹çŠ¶æ€ï¼Œæ‰€æœ‰æ–‡ä»¶çŠ¶æ€å‡ä¸º new fileï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º)ï¼Œæ­¤æ—¶æ‰§è¡Œ git add . ä¼šæŠŠæ‰€æœ‰æ–‡ä»¶æ·»åŠ åˆ°ç¼“å­˜åŒºï¼ˆIndexï¼‰ ä¸¥æ ¼æ„ä¹‰ä¸Šè¯´ï¼Œæ‰§è¡Œ git checkout --orphan &lt;new_branch_name&gt; åŽï¼Œåˆ›å»ºçš„å¹¶ä¸æ˜¯ä¸€ä¸ªåˆ†æ”¯ï¼Œå› ä¸ºæ­¤æ—¶ HEAD æŒ‡å‘çš„å¼•ç”¨ä¸­æ²¡æœ‰ commit å€¼ã€‚åªæœ‰åœ¨è¿›è¡Œä¸€æ¬¡æäº¤åŽï¼Œå®ƒæ‰ç®—å¾—ä¸ŠçœŸæ­£çš„åˆ†æ”¯ã€‚ orphan è¯‘ä¸ºâ€œå­¤å„¿â€ï¼Œè¯¥å‚æ•°è¡¨ç¤ºåˆ›å»ºä¸€ä¸ªå­¤ç«‹çš„åˆ†æ”¯ï¼Œæ²¡æœ‰ä»»ä½•æäº¤åŽ†å²ï¼Œä¸”ä¸Žå½“å‰åˆ†æ”¯ä¸å­˜åœ¨ä»»ä½•å…³ç³»ï¼ˆæŸ¥çœ‹æäº¤ä¿¡æ¯ï¼Œå¯å‘çŽ°å…¶ä¸ºä¸€ä¸ªå­¤ç«‹çš„ç‚¹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰ å­¤å„¿ï¼ˆorphanï¼‰æ— çˆ¶è¾ˆä¿¡æ¯ï¼ŒåŒç†ï¼Œåˆ›å»ºçš„åˆ†æ”¯ä¹Ÿä¸åŒ…å«ä»»ä½•åŽ†å²æäº¤ä¿¡æ¯ git commit -am git commit -m ä¸Ž git commit -am çš„åŒºåˆ« git branch -mé‡å‘½å git push -f origin mastergité¡¹ç›®åä½œâ€”â€”ä¿è¯gitä¿¡æ¯ç®€æ´åŒä¸€åˆ†æ”¯ git pull ä½¿ç”¨ rebaseé»˜è®¤æƒ…å†µä¸‹ï¼Œgit pull ä½¿ç”¨çš„æ˜¯ merge è¡Œä¸ºã€‚å¤šäººåä½œå¼€å‘æ—¶ï¼Œä¼šäº§ç”Ÿä¸å¿…è¦çš„ merge æäº¤è®°å½•ï¼Œé€ æˆæäº¤é“¾æ··ä¹±ä¸å ªã€‚ æŽ¨èåœ¨åŒä¸€ä¸ªåˆ†æ”¯æ›´æ–°ä»£ç æ—¶ï¼Œä½¿ç”¨ git pull --rebaseã€‚ 12345# ä¸ºæŸä¸ªåˆ†æ”¯å•ç‹¬è®¾ç½®ï¼Œè¿™é‡Œæ˜¯è®¾ç½® dev åˆ†æ”¯git config branch.dev.rebase true# å…¨å±€è®¾ç½®ï¼Œæ‰€æœ‰çš„åˆ†æ”¯ git pull å‡ä½¿ç”¨ --rebasegit config --global pull.rebase truegit config --global branch.autoSetupRebase always åˆ†æ”¯åˆå¹¶ä½¿ç”¨ merge â€“no-ffUsage Fast-Forwardï¼šå½“å‰åˆ†æ”¯åˆå¹¶åˆ°å¦ä¸€åˆ†æ”¯æ—¶ï¼Œå¦‚æžœæ²¡æœ‰å†²çªè¦è§£å†³ï¼Œå°±ä¼šç›´æŽ¥ç§»åŠ¨æ–‡ä»¶æŒ‡é’ˆï¼Œå¹¶ä¸”ä¸ä¼šäº§ç”Ÿåˆå¹¶æäº¤è®°å½•ã€‚è¯¥è¿‡ç¨‹ä¸­ï¼Œå­˜åœ¨git æ–‡ä»¶æŒ‡é’ˆå¿«é€Ÿç§»åŠ¨ï¼Œ å› æ­¤è¯¥è¿‡ç¨‹ç§°ä¸º Fast-Forwardã€‚ --no-ff(no fast foward)ï¼šæ¯ä¸€æ¬¡çš„åˆå¹¶ï¼Œéƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ commit è®°å½•ã€‚ä½¿ç”¨ --no-ffï¼Œå¯ä»¥ä¿æŒåŽŸæœ‰åˆ†æ”¯æäº¤é“¾çš„å®Œæ•´æ€§ï¼Œå¹¶ä¸”å½“è¯¥åˆ†æ”¯è¢«åˆ é™¤æ—¶ï¼Œæäº¤ä¿¡æ¯ä¾æ—§å­˜åœ¨ã€‚ ç»“åˆä¸Šå›¾åˆ†æžï¼Œåœ¨ devï¼ˆç»¿è‰²ï¼‰ åˆ†æ”¯ä¸Šæ£€å‡º feature-1 åˆ†æ”¯ï¼ˆè“è‰²ï¼‰ï¼Œä¸” dev åˆ†æ”¯ä¸è¿›è¡Œä»»ä½•æäº¤ ç›´æŽ¥ mergeï¼Œé»˜è®¤é‡‡ç”¨ Fast-Forwardï¼Œä¸¤ä¸ªåˆ†æ”¯çš„æäº¤é“¾ä¼šåˆå¹¶ä¸ºä¸€æ¡ç›´çº¿ï¼Œä¸åˆ©äºŽåŽæœŸä»£ç å®¡æŸ¥å’Œç»´æŠ¤ ä½¿ç”¨ git merge --no-ff feature-1 åˆå¹¶ä»£ç ï¼Œä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„æäº¤ï¼Œä¸”ä¸¤ä¸ªåˆ†æ”¯çš„æäº¤é“¾ä¸ä¼šé‡å ï¼Œåˆ©äºŽåŽæœŸä»£ç å®¡æŸ¥å’Œç»´æŠ¤ merge é»˜è®¤è®¾ç½®git merge é»˜è®¤ä½¿ç”¨ fast-forwardï¼Œå¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼ï¼Œä¿®æ”¹ä¸ºé»˜è®¤ä½¿ç”¨ --no-ffã€‚ 12git config --global merge.commit nogit config --global merge.ff no æ­¤å¤–ï¼ŒSourceTree åœ¨è®¾ç½®ä¸­ä¹Ÿå¯ä»¥è®¾ç½® --no-ffã€‚ IDEä¸­ä½¿ç”¨GitVSCodeä¸­ä½¿ç”¨Git VSCode ä¸­ä½¿ç”¨Gitå®žè·µ æŽ¨èå®‰è£… Git Lens å’Œ Git History æ’ä»¶ å…‹éš†ä»£ç  Ctrl + Shift + P æ‰“å¼€å‘½ä»¤é¢æ¿ï¼Œè¾“å…¥ Gitï¼Œé€‰æ‹© Git Clone è¿›è¡Œå…‹éš†ä»£ç  æŸ¥çœ‹ä¿®æ”¹ï¼ˆVSCodeä¼šä½¿ç”¨ä¸åŒé¢œè‰²è¿›è¡Œæ ‡è¯†ï¼‰ çº¢è‰²ç®­å¤´ - æ ‡è¯†åˆ é™¤è¡Œ è“è‰²ç«–çº¿ - è¯¥å¤„æœ‰ä¿®æ”¹ ç»¿è‰²ç®­å¤´ - è¯¥å¤„ä¸ºæ–°å¢ž æäº¤ä»£ç  Ctrl + Shift + G æ‰“å¼€ä»£ç ç®¡ç†å™¨è¿›è¡Œæ“ä½œ git clone è®¾ç½®ç¼“å­˜åŒºå½“å·¥ç¨‹è¾ƒå¤§æ—¶ï¼Œä½¿ç”¨ git clone æ‹‰å–ä»£ç ï¼Œå¯èƒ½ä¼šå‡ºçŽ° early EOF çš„æŠ¥é”™æˆ–è€…æ‹‰å–ä»£ç å¤±è´¥ã€‚ è¿™æ˜¯å› ä¸º git clone æœ¬è´¨ä¸Šæ˜¯å»ºç«‹ä¸€ä¸ª HTTP è¿žæŽ¥ï¼Œå·¥ç¨‹è¾ƒå¤§æ—¶ä¼šè¶…è¿‡é»˜è®¤è®¾ç½®çš„ç¼“å­˜å¤§å°ã€‚ ä½¿ç”¨ git config --list æŸ¥çœ‹ http.postbuffer çš„å¤§å°ï¼Œç¡®è®¤æ˜¯å¦å°äºŽä¸‹è½½çš„å·¥ç¨‹å¤§å°ã€‚ ä½¿ç”¨ git config --global http.postbuffer 524288000 //500x1024x1024 è®¾ç½®ä¸º500M å¯ä»¥å¯¹ç¼“å­˜åŒºå¤§å°è¿›è¡Œè®¾ç½®ã€‚ git clean git clean -n - æŸ¥çœ‹å“ªäº›æ–‡ä»¶å°†è¢« git clean æ¸…é™¤ï¼Œåªæ˜¯æŸ¥çœ‹ï¼Œå¹¶ä¸ä¼šçœŸæ­£æ‰§è¡Œæ¸…é™¤æ“ä½œ git clean -f - åˆ é™¤æœªè·Ÿè¸ªçš„æ–‡ä»¶ untracked files git clean -fd - è¿žåŒæœªè·Ÿè¸ªçš„ç›®å½•ä¹Ÿä¸€èµ·åˆ é™¤ git clean -fdx - åˆ é™¤æœªè·Ÿè¸ªçš„æ–‡ä»¶å’Œæ–‡ä»¶ç›®å½•ï¼Œå¹¶ç§»é™¤è¢«å¿½ç•¥çš„æ–‡ä»¶ã€‚å…¶ä¸­ï¼Œ-x è¡¨ç¤ºç§»é™¤è¢«å¿½ç•¥çš„æ–‡ä»¶å¹¶ä¸” .gitignore æ–‡ä»¶ä¸­æŒ‡å®šçš„æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ä¹Ÿä¼šæ¸…é™¤æˆ–è€…æ¸…é™¤æ›´æ”¹ git tag git tagï¼š æ˜¾ç¤ºæ‰€æœ‰æ ‡ç­¾ git tag -l &#39;v1.0.*&#39;ï¼š ç”¨é€šé…ç¬¦æŸ¥çœ‹ç¬¦åˆç­›é€‰æ¡ä»¶çš„æ ‡ç­¾ git show xxxï¼š æŸ¥çœ‹æ ‡ç­¾ä¿¡æ¯ï¼ˆæäº¤è€…ï¼Œé‚®ç®±ç­‰ï¼‰ git tag xxxï¼š åˆ›å»ºè½»é‡æ ‡ç­¾ git tag -a xxxï¼š åˆ›å»ºå«æœ‰é™„æ³¨çš„æ ‡ç­¾ git tag -a xxx -m &#39;xxxx&#39;ï¼š åˆ›å»ºå«æœ‰é™„æ³¨çš„æ ‡ç­¾ï¼Œå¹¶é™„åŠ æäº¤ä¿¡æ¯ï¼ˆé»˜è®¤æ ‡ç­¾æ‰“åˆ°å½“å‰Headæäº¤çŠ¶æ€ï¼‰ git tag -a xxx -m &#39;xxxx&#39; \&lt;commitID&gt;ï¼š åˆ›å»ºè¡¥ä¸æ ‡ç­¾ï¼Œå³å¯¹ä¹‹å‰çš„æäº¤æ·»åŠ æ ‡ç­¾ git tag -d xxxï¼š åˆ é™¤æœ¬åœ°æ ‡ç­¾ git push origin --delete tag &lt;tagname&gt;ï¼š åˆ é™¤è¿œç¨‹æ ‡ç­¾ éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒGit ä½¿ç”¨çš„æ ‡ç­¾æœ‰ 2 ç§ç±»åž‹ï¼šè½»é‡çº§çš„ï¼ˆlightweightï¼‰å’Œå«é™„æ³¨çš„ï¼ˆannotatedï¼‰ã€‚ â€”â€” git tag | Doc è½»é‡çº§æ ‡ç­¾å°±åƒæ˜¯ä¸ªä¸ä¼šå˜åŒ–çš„åˆ†æ”¯ï¼Œå®žé™…ä¸Šå®ƒå°±æ˜¯ä¸ªæŒ‡å‘ç‰¹å®šæäº¤å¯¹è±¡çš„å¼•ç”¨ã€‚ å«é™„æ³¨æ ‡ç­¾ï¼Œå®žé™…ä¸Šæ˜¯å­˜å‚¨åœ¨ä»“åº“ä¸­çš„ä¸€ä¸ªç‹¬ç«‹å¯¹è±¡ï¼Œå®ƒæœ‰è‡ªèº«çš„æ ¡éªŒå’Œä¿¡æ¯ï¼ŒåŒ…å«ç€æ ‡ç­¾çš„åå­—ï¼Œç”µå­é‚®ä»¶åœ°å€å’Œæ—¥æœŸï¼Œä»¥åŠæ ‡ç­¾è¯´æ˜Žï¼Œæ ‡ç­¾æœ¬èº«ä¹Ÿå…è®¸ä½¿ç”¨ GNU Privacy Guard (GPG) æ¥ç­¾ç½²æˆ–éªŒè¯ã€‚ ä¸€èˆ¬æˆ‘ä»¬éƒ½å»ºè®®ä½¿ç”¨å«é™„æ³¨åž‹çš„æ ‡ç­¾ï¼Œä»¥ä¾¿ä¿ç•™ç›¸å…³ä¿¡æ¯ï¼›å½“ç„¶ï¼Œå¦‚æžœåªæ˜¯ä¸´æ—¶æ€§åŠ æ³¨æ ‡ç­¾ï¼Œæˆ–è€…ä¸éœ€è¦æ—æ³¨é¢å¤–ä¿¡æ¯ï¼Œç”¨è½»é‡çº§æ ‡ç­¾ä¹Ÿæ²¡é—®é¢˜ã€‚ cherry-pick Cherry-Pick | æŽ˜é‡‘ ä½¿ç”¨åœºæ™¯cherry è¯‘ä¸ºæ¨±æ¡ƒï¼Œpick è¯‘æŒ‘é€‰ã€‚git cherry-pick å³é€‰æ‹©æŸä¸€ä¸ªåˆ†æ”¯ä¸­çš„ä¸€ä¸ªæˆ–å‡ ä¸ªæäº¤ï¼Œåˆå¹¶åˆ°å…¶ä»–åˆ†æ”¯ä¸­ï¼ˆé€‰æ‹©çš„æäº¤å³æ‰€éœ€çš„æ¨±æ¡ƒï¼‰ï¼Œä¸»è¦ä½¿ç”¨åœºæ™¯ä¸º æƒ…å†µ1ï¼š æŠŠå¼„é”™åˆ†æ”¯çš„æäº¤ç§»åŠ¨åˆ°æ­£ç¡®çš„åˆ†æ”¯ä¸Š æƒ…å†µ2ï¼š å°†å…¶ä»–åˆ†æ”¯çš„æäº¤æ·»åŠ åˆ°å½“å‰åˆ†æ”¯ Demoå‡è®¾å·¥ç¨‹æœ‰ä¸ªç¨³å®šç‰ˆåˆ†æ”¯ v2.0ï¼Œè¿˜æœ‰ä¸ªå¼€å‘ç‰ˆåˆ†æ”¯ v3.0ã€‚å¼€å‘åˆ†æ”¯è¿˜æœªå½»åº•å®Œæˆï¼Œä¸èƒ½ç›´æŽ¥æŠŠä¸¤ä¸ªåˆ†æ”¯åˆå¹¶ï¼Œè¿™æ ·ä¼šå¯¼è‡´ç¨³å®šç‰ˆæœ¬æ··ä¹±ï¼Œä½†æ˜¯åˆæƒ³å¢žåŠ ä¸€ä¸ª v3.0 ä¸­çš„åŠŸèƒ½åˆ° v2.0 ä¸­ï¼Œè¿™é‡Œå°±å¯ä»¥ä½¿ç”¨ cherry-pick äº†ã€‚ 12345678910// å…ˆåœ¨v3.0ä¸­æŸ¥çœ‹è¦åˆå¹¶çš„commitçš„commit idgit log// å‡è®¾æ˜¯ commit f79b0b1ffe445cab6e531260743fa4e08fb4048b// åˆ‡åˆ°v2.0ä¸­git checkout v2.0// åˆå¹¶commitgit cherry-pick f79b0b1ffe445cab6e531260743fa4e08fb4048b git cherry-pick -x f79b0b1ffe445cab6e531260743fa4e08fb4048b //è¡¨ç¤ºä¿ç•™åŽŸæäº¤çš„ä½œè€…ä¿¡æ¯è¿›è¡Œæäº¤ è¯­æ³• git cherry_pick commitIDï¼šå°†å…¶ä»–åˆ†æ”¯çš„ commitID æäº¤åˆå¹¶åˆ°å½“å‰åˆ†æ”¯ git cherry_pick commitIDï¼šå°†å…¶ä»–åˆ†æ”¯çš„ commitID æäº¤åˆå¹¶åˆ°å½“å‰åˆ†æ”¯ï¼Œ-x è¡¨ç¤ºä¿ç•™åŽŸæäº¤çš„ä½œè€…ä¿¡æ¯è¿›è¡Œæäº¤ git cherry_pick &lt;start-commit-id&gt;â€¦&lt;end-commit-id&gt;: è¯¥åŠŸèƒ½åœ¨Git 1.7.2 ç‰ˆæœ¬åŽæ‰æ”¯æŒï¼Œå°†ä¸€ä¸ªè¿žç»­åŒºé—´èŒƒå›´çš„æäº¤ï¼Œåˆå¹¶åˆ°åˆ°å½“å‰åˆ†æ”¯ã€‚æäº¤èŒƒå›´åŒºé—´å·¦å¼€å³é—­ï¼Œå³(start, end] git cherry_pick &lt;start-commit-id&gt;^ â€¦ &lt;end-commit-id&gt;: åŒä¸Šï¼Œä½¿ç”¨ ^ è¡¨ç¤ºåŒ…å« start-commit-idï¼Œå³[start, end] JetBranins ç³»åˆ—IDEï¼Œå†…ç½®äº†git cherry-pick å¿«æ·é”®ï¼ˆæ¨±æ¡ƒå›¾æ ‡ï¼‰ gitå‘½ä»¤è¡Œä»£ç†è®¾ç½®è®¾ç½®ä»£ç†12git config --global http.proxy 'socks5://127.0.0.1:1086'git config --global https.proxy 'socks5://127.0.0.1:1086' å–æ¶ˆä»£ç†12git config --global --unset http.proxygit config --global --unset https.proxy GitUp Work quickly, safely, and without headaches.The Git interface youâ€™ve been missingall your life has finally arrived. GitUp Tutorial GitG gitgæ˜¯ä¸€ä¸ªgitå›¾å½¢åŒ–ç•Œé¢ã€‚ å®‰è£… 1brew install gitg //å®‰è£… ä½¿ç”¨ 1gitg // åœ¨ç›®å½•ç»ˆç«¯ä¸‹è¾“å…¥gitgå³å¯ Git ä»£ç å›žæ»š è°ˆè°ˆ Git ä»£ç å›žæ»š åœºæ™¯æè¿°æŸé¡¹ç›®ï¼Œå¹¶è¡Œå¼€å‘ç€nä¸ªéœ€æ±‚ã€‚ææµ‹æ—¶ï¼Œå„éœ€æ±‚çš„ä»£ç è¢«åˆå¹¶åˆ°æµ‹è¯•åˆ†æ”¯ã€‚ä¸ä¹…ä¹‹åŽï¼Œè¦æ±‚æŠŠéƒ¨åˆ†éœ€æ±‚ä»£ç ä»Žæµ‹è¯•åˆ†æ”¯æŠ½ç¦»å‡ºåŽ»ã€‚ä½¿ç”¨ä¸‹å›¾åœºæ™¯è¿›è¡Œæè¿°ã€‚å¹¶è¡Œå¼€å‘3ä¸ªéœ€æ±‚ï¼Œåˆ†åˆ«æ˜¯feature1ï¼Œfeature2ï¼Œfeature3ã€‚æµ‹è¯•åˆ†æ”¯ä¸ºmasterã€‚ feature2ä¸Žfeature3å¯¹åŒä¸€æ–‡ä»¶è¿›è¡Œä¿®æ”¹ï¼Œæ•…æ„åˆ¶é€ ä¸€ä¸ªå†²çªã€‚ ææµ‹æ—¶ï¼Œå„åˆ†æ”¯ä»£ç è¢«åˆå¹¶åˆ°æµ‹è¯•åˆ†æ”¯ï¼ˆmasterï¼‰ã€‚é¦–å…ˆï¼Œfeatuer1åˆ†æ”¯è¢«åˆå¹¶åˆ°æµ‹è¯•åˆ†æ”¯ã€‚ ä¹‹åŽï¼Œfeatuer2åˆ†æ”¯ä¹Ÿè¢«åˆå¹¶åˆ°æµ‹è¯•åˆ†æ”¯ã€‚ æœ€åŽï¼Œåˆå¹¶feature3è‡³æµ‹è¯•åˆ†æ”¯ã€‚åˆå¹¶æ—¶ï¼Œäº§ç”Ÿäº†ä¸Žfeature2ä»£ç çš„å†²çªã€‚ è§£å†³å†²çªä¹‹åŽï¼Œç»§ç»­å°†feature3åˆå¹¶è‡³æµ‹è¯•åˆ†æ”¯ã€‚ åœ¨feature3ææµ‹åŽï¼Œåœ¨æµ‹è¯•åˆ†æ”¯ä¸Šç»§ç»­ä¿®å¤å‡ ä¸ªbugã€‚ æ³¨æ„ï¼Œæ­¤æ—¶feature2è™½å·²ææµ‹ä½†å¹¶æœªè¿›å…¥æµ‹è¯•ï¼Œæ­¤æ—¶çš„bugä¿®å¤å‡æ˜¯é’ˆå¯¹ feature1ä¸Žfeature3ã€‚ å‡ å¤©ä¹‹åŽï¼Œæ”¶åˆ°é€šçŸ¥ï¼Œfeature2çš„æµ‹è¯•æ— æ³•æ­£å¸¸è¿›è¡Œï¼Œéœ€å°†ä»£ç ä»Žæµ‹è¯•åˆ†æ”¯ä¸ŠæŠ½å‡ºã€‚ ä»£ç å›žæ»šæ“ä½œStep 1 åˆ‡æ¢åˆ†æ”¯é¦–å…ˆï¼Œåˆ‡æ¢åˆ°featuer2åˆ†æ”¯ã€‚ä»¥é˜²ä¸‡ä¸€ï¼Œåˆ›å»ºfeature2-copyåˆ†æ”¯ï¼Œå¯¹è¯¥åˆ†æ”¯è¿›è¡Œå¤‡ä»½ã€‚ 1234567git checkout feature2 //åˆ‡æ¢åˆ°feature2åˆ†æ”¯git checkout -b feature2-copy //åˆ›å»ºå¹¶åˆ‡æ¢åˆ°feature2-copy//ç¬¬2è¡Œä»£ç ç­‰åŒäºŽgit branch feature2-copy //åˆ›å»ºfeature2-copyåˆ†æ”¯git checkout feature2-copy //åˆ‡æ¢åˆ°feature2-copyåˆ†æ”¯ Step 2 ç¡®å®šè¦å›žæ»šçš„æäº¤è®°å½•ä½¿ç”¨git logæŸ¥çœ‹feature2-copyåˆ†æ”¯çš„æäº¤è®°å½•ï¼ˆè¾“å…¥qé€€å‡ºgit logçŽ¯å¢ƒï¼‰ã€‚ 1git log å¦‚å›¾æ‰€ç¤ºï¼Œéœ€è¦å›žæ»šæœ€æ–°çš„3ä¸ªæäº¤ã€‚å®žé™…æƒ…å†µä¸­ï¼Œé’ˆå¯¹æŸéœ€æ±‚çš„æäº¤ç»ä¸æ­¢3ä¸ªã€‚è‹¥æ˜¯å°†æäº¤é€ä¸€revertï¼Œå·¥ä½œé‡æ˜¯éžå¸¸å¤§çš„ã€‚éœ€è¦è€ƒè™‘å°†nä¸ªcommitåˆå¹¶ä¸ºä¸€ä¸ªcommitï¼Œæœ€åŽä¸€åŒrevertã€‚ Step 3 git rebase åˆå¹¶æäº¤ä½¿ç”¨git rebase -iæ¥åˆå¹¶commitï¼Œä¼ å…¥éœ€è¦æ‹¼æŽ¥å›žæ»šè‡³çš„æäº¤çš„hashcodeã€‚ï¼ˆæ­¤å¤„ï¼Œå°†æ‰€æœ‰å›žæ»šçš„æäº¤åˆå¹¶åˆ°éœ€è¦å›žæ»šçš„commité›†åˆä¸­ç¬¬ä¸€ä¸ªæäº¤ï¼‰ 12//hashcodeä¸ºéœ€è¦å›žæ»šçš„commité›†åˆä¸­ç¬¬ä¸€ä¸ªæäº¤git rebase -i e08ddaf558b9ad84422db5e4b620dcab97623fde å°†æœ€è¿‘2æ¬¡æäº¤çš„commandä»Žpickæ”¹ä¸ºsã€‚ åœ¨Vimä¸­ï¼Œ è¾“å…¥iï¼Œè¿›å…¥INSERTæ¨¡å¼ã€‚ è¾“å…¥ESCï¼Œè¿›å…¥å‘½ä»¤è¡Œæ¨¡å¼ã€‚ è¾“å…¥:wqï¼Œä¿å­˜å¹¶é€€å‡ºVIMç¼–è¾‘å™¨ã€‚ ä¿®æ”¹åŽï¼Œä¿å­˜å¹¶é€€å‡ºï¼Œè¿›å…¥å¦‚ä¸‹å¯¹è¯æ¡†ã€‚ æ­¤æ—¶ï¼Œå¯¹æœ€åˆä¸€æ¬¡çš„æäº¤çš„commit messageè¿›è¡Œä¿®æ”¹ã€‚ ä¿®æ”¹åŽä¿å­˜å¹¶é€€å‡ºï¼Œä½¿ç”¨git log å†æ¬¡æŸ¥çœ‹ feature2-copy åˆ†æ”¯çš„ä¿¡æ¯ã€‚ å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œ3æ¬¡æäº¤è¢«æˆåŠŸåˆå¹¶ã€‚ Step 4 git revert æ’¤é”€æäº¤1git revert e544464c3de69adef5ca7556001abebaf40b218b ä¿å­˜å¹¶é€€å‡ºï¼Œå†æ¬¡æŸ¥çœ‹feature2-copyåˆ†æ”¯çš„æäº¤è®°å½•ã€‚ Step 5 git cherry-pick12git checkout master //åˆ‡æ¢åˆ°æµ‹è¯•åˆ†æ”¯git cherry-pick b309f7944d2422d8fe647dca61bda518b192628f åˆ‡æ¢åˆ°æµ‹è¯•åˆ†æ”¯ï¼Œå¹¶æ‰§è¡Œ git cherry-pick å‘½ä»¤ã€‚è‡³æ­¤ï¼ŒæˆåŠŸçš„å°†feature2åˆ†æ”¯ä»Žæµ‹è¯•åˆ†æ”¯ä¸ŠæŠ½ç¦»ã€‚ Gitä»£ç ç®¡ç†ä¸Žå›¢é˜Ÿåä½œ è§†é¢‘æ•™ç¨‹ | Segmentfault ä»£ç æœ€ç»ˆæäº¤æ•ˆæžœå¦‚ä¸Šå›¾æ‰€ç¤ºã€‚ ä¸»åˆ†æ”¯ä¸ºmasterï¼Œåˆ›å»ºä¸€ä¸ªdevelopåˆ†æ”¯ç”¨äºŽå¼€å‘ã€‚ å¼€å‘è€…leoå’Œjackåˆ›å»ºè‡ªå·±çš„åˆ†æ”¯leoå’Œjackè¿›è¡Œå¼€å‘ã€‚å¼€å‘å®ŒæˆåŽï¼Œå°†å…¶åˆå¹¶åˆ°developåˆ†æ”¯ä¸Šã€‚ é¡¹ç›®è¿›å±•åˆ°éœ€è¦å‘å¸ƒæ—¶ï¼Œä»Ždevelopåˆ†æ”¯åˆ›å»ºreleaseåˆ†æ”¯ï¼Œç”¨äºŽæµ‹è¯•ã€‚æµ‹è¯•é€šè¿‡åŽï¼Œå°†releaseåˆ†æ”¯åˆå¹¶åˆ°developåˆ†æ”¯å’Œmasteråˆ†æ”¯ä¸Šã€‚ Demoç›®å½•å’Œåˆå§‹åŒ–12345//ç›®å½•ç»“æž„-- c4---|--- origin //æ¨¡æ‹Ÿè¿œç¨‹ä»“åº“ git init --bare åˆ›å»º---|--- leo //å¼€å‘è€…1 è®¾ç½®user.name = 'leo'---|--- jack //å¼€å‘è€…2 è®¾ç½®user.name = 'jack' git init --bare ç”¨äºŽåˆ›å»ºä¸€ä¸ªâ€œè£¸ä»“åº“â€â€”â€”åªå«æœ‰ .git ç›®å½•ï¼Œä¸å«æºæ–‡ä»¶ã€‚è¯¦æƒ…å‚è€ƒ Refã€‚ 1234567891011mkdir c4cd c4mkdir origin cd origin git init --bare //åˆ›å»ºä¸€ä¸ªè£¸ä»“åº“cd ..//å…‹éš†è¿œç¨‹ä»“åº“è‡³ä¸¤ä¸ªå¼€å‘è€…ç›®å½•â€”â€”leo, jackgit clone origin leogit clone origin jack ä¸ºäº†æ¨¡æ‹Ÿå›¢é˜Ÿåä½œï¼Œå¯¹ä¸¤ä¸ªå¼€å‘è€…ç›®å½•ï¼Œåˆ†åˆ«è®¾ç½®ä¸åŒçš„ user.name ä¿¡æ¯ã€‚ git config --localï¼Œä½¿ç”¨ --local å‚æ•°ï¼Œåªå¯¹æœ¬åœ°å‚æ•°è¿›è¡Œé…ç½®ã€‚ 12345cd leogit config --local user.name 'leo'cd jackgit config --local user.name 'jack' å¼€å‘æµç¨‹master åˆ†æ”¯åˆå§‹åŒ–12345678cd leo echo a = 1 &gt; leo1.py // å°†a=1å†™å…¥leo1.pyæ–‡ä»¶cat leo1.py //æ˜¾ç¤ºæ–‡ä»¶çš„å†…å®¹git add . git commit -m "c4 é¡¹ç›®åˆå§‹åŒ–"git tag 0.0.1 //æ·»åŠ æ ‡ç­¾ æ–¹ä¾¿ç®¡ç† åˆ›å»ºdevelopåˆ†æ”¯123456789git checkout -b developecho b = 2 &gt; leo1.pygit add .git commit -m "å»ºç«‹å¼€å‘åˆ†æ”¯å¹¶æäº¤"git push origin develop //æŽ¨é€åˆ°è¿œç¨‹åˆ†æ”¯gitg // ä½¿ç”¨gitgå›¾å½¢åŒ–å·¥å…·æŸ¥çœ‹æäº¤ä¿¡æ¯ leoè¿›è¡Œå¼€å‘12345678910git checkout -b leoecho c=3 &gt; leo2.pygit add .git commit -m "åˆ›å»ºleoåˆ†æ”¯å¹¶å¼€å‘"//åˆå¹¶å½“å‰å¼€å‘åˆ°devåˆ†æ”¯git checkout developgit merge --no-ff leo //åˆå¹¶åˆ†æ”¯ å¹¶ä¿ç•™leoåˆ†æ”¯ä¿¡æ¯gitg //æŸ¥çœ‹æäº¤åŽ†å²æ ‘ gui git merge --no-ff leoï¼Œåˆå¹¶åˆ†æ”¯ï¼Œå¹¶ä¿ç•™leoåˆ†æ”¯çš„ä¿¡æ¯ã€‚å…³äºŽå‚æ•°--no-ffçš„è¯¦æƒ…ï¼Œå‚è€ƒ Refã€‚ æœ€åŽï¼Œå°†å¼€å‘åˆ†æ”¯æŽ¨é€åˆ°è¿œç¨‹ã€‚ 123git push origin developgitg jackè¿›è¡Œå¼€å‘é¦–å…ˆï¼Œä»Žè¿œç¨‹æ‹‰å–æœ€æ–°ä»£ç ã€‚ 1git pull origin ä¹‹åŽï¼Œjackè¿›è¡Œæ—¥å¸¸å¼€å‘ï¼Œæµç¨‹åŒleoå¼€å‘ï¼Œæ­¤å¤„ä¸å†èµ˜è¿°ã€‚ releaseåˆ†æ”¯æµ‹è¯•é¡¹ç›®è¿›å±•åˆ°éœ€å‘å¸ƒæ—¶ï¼Œä»Ždevelopåˆ†æ”¯åˆ›å»ºreleaseåˆ†æ”¯ï¼Œç”¨äºŽæµ‹è¯•ã€‚æµ‹è¯•é€šè¿‡åŽï¼Œå°†releaseåˆ†æ”¯åˆå¹¶åˆ°developåˆ†æ”¯å’Œmasteråˆ†æ”¯ä¸Šã€‚ è¿œç¨‹å¤šåˆ†æ”¯ä»£ç æ‹‰å–æ­¤å¤„è®°å½•å¦‚ä½•æ‹‰å–è¿œç¨‹æ‰€æœ‰åˆ†æ”¯ï¼Œå¹¶å»ºç«‹æœ¬åœ°åˆ†æ”¯è¿½è¸ªè¿œç¨‹åˆ†æ”¯ã€‚ Step 1ï¼š clone è¿œç¨‹ä»£ç  Step 2ï¼š åœ¨sourcetreeä¸­å¯ä»¥çœ‹å‡ºï¼Œè¿œç¨‹åˆ†æ”¯æœ‰origin/masterï¼Œorigin/devå’Œorigin/webtestã€‚æ­¤æ—¶æœ¬åœ°åˆ†æ”¯ä¸ºdevï¼Œå¹¶å»ºç«‹äº†è¿½è¸ªå…³ç³»ã€‚ Step 3ï¼š åœ¨å¯¹åº”çš„è¿œç¨‹åˆ†æ”¯ï¼ˆorigin/masterï¼‰ä¸Šç‚¹å‡»ï¼Œæ£€å‡ºåˆ†æ”¯ï¼Œè®¾å®šæœ¬åœ°åˆ†æ”¯åï¼Œå¹¶è¿½è¸ªè¿œç¨‹åˆ†æ”¯å³å¯ã€‚ Step 4ï¼š æœ€ç»ˆæ•ˆæžœå¦‚ä¸‹å›¾ï¼Œæ£€å‡ºæœ¬åœ°åˆ†æ”¯å¹¶è¿½è¸ªè¿œç¨‹ã€‚ Tip git branch -rï¼š æŸ¥çœ‹è¿œç¨‹åˆ†æ”¯ git branch -aï¼š æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯ Ref: Blog å¤šSSHé…ç½® å–æ¶ˆå…¨å±€è´¦æˆ·å’Œé‚®ç®±è®¾ç½® 12git config --unset --global user.namegit config --unset --global user.email æ–°å»ºSSH keyï¼š 123cd ~/.sshssh-keygen -t rsa -C "liubaoshuai1@jd.com" Enter file in which to save the key (/User/lbs/.ssh/id_rsa): id_rsa_jd # è¾“å…¥æ–‡ä»¶å æ–°å¯†é’¥æ·»åŠ åˆ° SSH Agent é»˜è®¤åªè¯»å– id_rsaï¼Œä¸ºäº†è®© SSH è¯†åˆ«æ–°çš„ç§é’¥ï¼Œéœ€å°†å…¶æ·»åŠ åˆ° SSH Agent ä¸­ 1ssh-add ~/.ssh/id_rsa_jd è‹¥å‡ºçŽ° Could not open a connection to your authentication agent é”™è¯¯ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ 12ssh-agent bashssh-add ~/.ssh/id_rsa_jd ä¿®æ”¹ config æ–‡ä»¶ 1vim config # è‹¥æ²¡æœ‰ï¼Œå¯åˆ›å»º touch config 1234567891011121314# default user (lbs1203940926@163.com)Host github.com HostName github.com User lbs1203940926@163.com PreferredAuthentications publickey IdentityFile /Users/lbs/.ssh/id_rsa# jd-gitlab(liubaoshuai1@jd.com))Host git.jd.com HostName git.jd.comm User liubaoshuai1@jd.com PreferredAuthentications publickey IdentityFile /Users/lbs/.ssh/id_rs_jd æ‹‰å–JDä»£ç  1234567# æµ‹è¯•æš‚ä¸æ”¯æŒSourceTreeä¸­è¿œç¨‹æ‹‰å–ï¼Œéœ€è¦ç»ˆç«¯å‘½ä»¤è¡Œæ‹‰å–# ä¸”æš‚åªæ”¯æŒhttpsåè®®git clone http://git.jd.com/jdreact/jdreact-jsbundle-jdreactonehourarrive# UserName: liubaoshuai# PassWord: ERP's password]]></content>
      <categories>
        <category>Develop Tools</category>
      </categories>
      <tags>
        <tag>Develop Tools</tag>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[RedisåŸºç¡€çŸ¥è¯†æ¢³ç†]]></title>
    <url>%2F2020%2F01%2F31%2Fredis-basic%2F</url>
    <content type="text"><![CDATA[å¯¹ Redis åŸºç¡€çŸ¥è¯†è¿›è¡Œæ¢³ç†ï¼ŒåŒ…æ‹¬Redisçš„5ç§æ•°æ®ç±»åž‹ï¼Œäº‹åŠ¡ï¼Œè¿‡æœŸæ—¶é—´ï¼Œæ¶ˆæ¯é€šçŸ¥ï¼Œä¼˜å…ˆçº§é˜Ÿåˆ—ï¼Œç®¡é“ï¼Œæ•°æ®æŒä¹…åŒ–ï¼Œå¤åˆ¶ï¼Œå“¨å…µï¼Œäº‹åŠ¡ç­‰ æ›´æ–°æ—¥å¿— 2020/01/30ï¼Œæ’°å†™ å­¦ä¹ èµ„æ–™æ±‡æ€» Rediså®˜ç½‘ Redisä¸­æ–‡å®˜ç½‘ Redisèœé¸Ÿæ•™ç¨‹ Redisæºç  â€”â€” ä½¿ç”¨Cè¯­è¨€å¼€å‘ï¼Œæºç åªæœ‰3ä¸‡å¤šè¡Œï¼Œé™ä½Žäº†ç”¨æˆ·é€šè¿‡ä¿®æ”¹Redisæºç æ¥æå‡æ€§èƒ½çš„é—¨æ§› Redis åˆè¯† Redis = Remote Dictionary Serverï¼Œè¿œç¨‹å­—å…¸æœåŠ¡å™¨ Redis æ˜¯ä¸€ä¸ª é«˜æ€§èƒ½çš„ key-value å­˜å‚¨ç³»ç»Ÿï¼Œé€šå¸¸è¢«ç§°ä¸ºæ•°æ®ç»“æž„æœåŠ¡å™¨ï¼Œå› ä¸ºå€¼ï¼ˆvalueï¼‰å¯ä»¥æ˜¯ å­—ç¬¦ä¸²(String), å“ˆå¸Œ(Hash), åˆ—è¡¨(list), é›†åˆ(sets) å’Œæœ‰åºé›†åˆ(sorted sets)ç­‰ç±»åž‹ã€‚ Redis ä¸Žå…¶ä»– key - value ç¼“å­˜äº§å“æœ‰ä»¥ä¸‹3ä¸ªç‰¹ç‚¹ Redisæ”¯æŒæ•°æ®çš„æŒä¹…åŒ–ï¼Œå¯ä»¥å°†å†…å­˜ä¸­çš„æ•°æ®ä¿å­˜åœ¨ç£ç›˜ä¸­ï¼Œé‡å¯çš„æ—¶å€™å¯ä»¥å†æ¬¡åŠ è½½è¿›è¡Œä½¿ç”¨ Redisä¸ä»…ä»…æ”¯æŒç®€å•çš„key-valueç±»åž‹çš„æ•°æ®ï¼ŒåŒæ—¶è¿˜æä¾›listï¼Œsetï¼Œzsetï¼Œhashç­‰æ•°æ®ç»“æž„çš„å­˜å‚¨ Redisæ”¯æŒæ•°æ®çš„å¤‡ä»½ï¼Œå³master-slaveæ¨¡å¼çš„æ•°æ®å¤‡ä»½ Redis æ€§èƒ½æžé«˜ï¼Œè¯»å–é€Ÿåº¦æ˜¯110000æ¬¡/sï¼Œå†™å…¥çš„é€Ÿåº¦æ˜¯81000æ¬¡/sã€‚Redisæ•°æ®åº“ä¸­çš„æ‰€æœ‰æ•°æ®éƒ½å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œå†…å­˜è¯»å†™é€Ÿåº¦è¿œå¿«äºŽç£ç›˜ã€‚ RedisåŠŸèƒ½ä¸°å¯Œï¼Œé™¤äº†ç”¨äºŽæ•°æ®åº“å¼€å‘ï¼Œè¿˜å¯ä»¥ç”¨äºŽç¼“å­˜ï¼Œé˜Ÿåˆ—ç³»ç»Ÿç­‰ã€‚ Redisçš„æ‰€æœ‰æ“ä½œéƒ½æ˜¯åŽŸå­æ€§çš„ï¼Œæ„æ€å°±æ˜¯è¦ä¹ˆæˆåŠŸæ‰§è¡Œè¦ä¹ˆå¤±è´¥å®Œå…¨ä¸æ‰§è¡Œã€‚å•ä¸ªæ“ä½œæ˜¯åŽŸå­æ€§çš„ã€‚å¤šä¸ªæ“ä½œä¹Ÿæ”¯æŒäº‹åŠ¡ï¼Œå³åŽŸå­æ€§ï¼Œé€šè¿‡MULTIå’ŒEXECæŒ‡ä»¤åŒ…èµ·æ¥ã€‚ RedisçŽ¯å¢ƒé…ç½®å®‰è£… Redis Macä¸Šï¼Œå»ºè®®ä½¿ç”¨Homebrewå®‰è£…Redis 12345678910brew install redis //ä¼šé»˜è®¤å®‰è£…å½“å‰æœ€æ–°çš„ç¨³å®šç‰ˆæœ¬/// æ­¤å¤„å®‰è£…è·¯å¾„ä¸º usr/local/Cellar/redis/5.0.7//==&gt; Caveats// To have launchd start redis now and restart at login:// brew services start redis//Or, if you don't want/need a background service you can just run:// redis-server /usr/local/etc/redis.conf//==&gt; Summary//ðŸº /usr/local/Cellar/redis/5.0.7: 13 files, 3.1MB å¦‚æžœéœ€è¦åŽå°è¿è¡ŒRedisæœåŠ¡ï¼Œä½¿ç”¨å‘½ä»¤ brew services start redis å¦‚æžœä¸éœ€è¦åŽå°è¿è¡ŒRedisæœåŠ¡ï¼Œä½¿ç”¨å‘½ä»¤ redis-server /usr/local/etc/redis.conf å¯åŠ¨/åœæ­¢Redisæ‰§è¡Œ brew services start redi å‘½ä»¤ï¼Œç¬¬ä¸€æ¬¡å¯åŠ¨ Redis åŽï¼Œåœ¨ /usr/local/bin ç›®å½•ä¸‹ï¼Œä¼šç”Ÿæˆå¦‚ä¸‹æ–‡ä»¶å¤¹ æ–‡ä»¶å è¯´æ˜Ž redis-server redis æœåŠ¡å™¨ redis-cli redis å‘½ä»¤è¡Œå®¢æˆ·ç«¯ redis-benchmark redis æ€§èƒ½æµ‹è¯•å·¥å…· redis-check-aof AOF æ–‡ä»¶ä¿®å¤å·¥å…· redis-check-dump RDB æ–‡ä»¶æ£€æŸ¥å·¥å…· redis-sentinel Sentinel æœåŠ¡å™¨ å¯åŠ¨Redis 123redis-server //é»˜è®¤ç«¯å£å· 6379redis-server --port 6380 //æŒ‡å®šç«¯å£å· åœæ­¢Redis è€ƒè™‘åˆ° Redis æœ‰å¯èƒ½æ­£åœ¨å°†å†…å­˜ä¸­æ•°æ®åŒæ­¥åˆ°ç¡¬ç›˜ä¸­ï¼Œå¼ºè¡Œç»ˆæ­¢Redisè¿›ç¨‹å¯èƒ½ä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±ã€‚å› æ­¤ï¼Œæ­£ç¡®åœæ­¢Redisçš„æ–¹å¼åº”è¯¥æ˜¯å‘Rediså‘é€ SHUTDOWN å‘½ä»¤ï¼Œæ–¹æ³•ä¸º 1redis-cli SHUTDOWN å½“ Redis æ”¶åˆ° SHUTDOWN å‘½ä»¤åŽï¼Œä¼šå…ˆæ–­å¼€æ‰€æœ‰å®¢æˆ·ç«¯è¿žæŽ¥ï¼Œç„¶åŽæ ¹æ®é…ç½®æ‰§è¡Œæ•°æ®æŒä¹…åŒ–ï¼Œæœ€åŽå®Œæˆé€€å‡ºã€‚ Redis å¯ä»¥å¦¥å–„å¤„ç† SIGTERM ä¿¡å·ï¼Œæ‰€ä»¥ä½¿ç”¨ kill Redis è¿›ç¨‹çš„ PIDï¼Œä¹Ÿå¯ä»¥æ­£å¸¸ç»“æŸ Redisï¼Œæ•ˆæžœå’Œå‘é€ SHUTDOWN å‘½ä»¤ä¸€æ ·ã€‚ redis-cliRedis å‘½ä»¤ç”¨äºŽåœ¨ Redis æœåŠ¡ä¸Šæ‰§è¡Œæ“ä½œã€‚è¦åœ¨ Redis æœåŠ¡ä¸Šæ‰§è¡Œå‘½ä»¤éœ€è¦ä¸€ä¸ª Redis å®¢æˆ·ç«¯ã€‚ redis-cli æ˜¯Redisè‡ªå¸¦çš„åŸºäºŽå‘½ä»¤è¡Œçš„Rediså®¢æˆ·ç«¯ï¼Œä¸‹é¢ä»‹ç»å¦‚æžœé€šè¿‡ redis-cli å‘ Redis å‘é€å‘½ä»¤ã€‚ é€šè¿‡ redis-cli å‘ Redis å‘é€å‘½ä»¤æœ‰2ç§æ–¹å¼ æ–¹å¼1ï¼šå°†å‘½ä»¤ä½œä¸º redis-cli çš„å‚æ•°æ‰§è¡Œã€‚ä¾‹å¦‚ redis-cli SHUTDOWN æ–¹å¼2ï¼šæ‰§è¡Œ redis-cliï¼ˆä¸é™„å¸¦ä»»ä½•å‚æ•°ï¼‰ï¼Œè¿›å…¥äº¤äº’æ¨¡å¼åŽï¼Œå¯ä»¥è‡ªç”±è¾“å…¥å‘½ä»¤ 12345678910// æ–¹å¼1ï¼šå°†å‘½ä»¤ä½œä¸º redis-cli çš„å‚æ•°æ‰§è¡Œredis-cli SHUTDOWN//redisé»˜è®¤æœåŠ¡å™¨åœ°å€127.0.0.1ï¼Œé»˜è®¤ç«¯å£å·6379 //ä¹Ÿå¯ä»¥ä½¿ç”¨-hæŒ‡å®šæœåŠ¡å™¨åœ°å€ï¼Œ-pæŒ‡å®šç«¯å£å·redis-cli -h 127.0.0.1 -p 6379 //ä½¿ç”¨PINGå‘½ä»¤æµ‹è¯•å®¢æˆ·ç«¯å’ŒRedisçš„è¿žæŽ¥æ˜¯å¦æ­£å¸¸redis-cli PING //è¿”å›žPONG è¡¨ç¤ºè¿žæŽ¥æ­£å¸¸ 12345//æ–¹å¼2: æ‰§è¡Œ redis-cliï¼ˆä¸é™„å¸¦ä»»ä½•å‚æ•°ï¼‰ï¼Œè¿›å…¥äº¤äº’æ¨¡å¼åŽï¼Œå¯ä»¥è‡ªç”±è¾“å…¥å‘½ä»¤lbsMacBook-Pro:~ lbs$ redis-cli127.0.0.1:6379&gt; PINGPONG127.0.0.1:6379&gt; å¤šæ•°æ®åº“Redis æ˜¯ä¸€ä¸ªå­—å…¸ç»“æž„çš„å­˜å‚¨æœåŠ¡å™¨ï¼Œä¸€ä¸ª Redis å®žä¾‹æä¾›äº†å¤šä¸ªç”¨æ¥å­˜å‚¨çš„å­—å…¸ï¼Œå¯ä»¥æŠŠå…¶ä¸­çš„æ¯ä¸ªå­—å…¸éƒ½ç†è§£æˆä¸€ä¸ªç‹¬ç«‹çš„æ•°æ®åº“ã€‚ æ¯ä¸ªæ•°æ®åº“å¯¹å¤–éƒ½æ˜¯ä¸€ä¸ªä»Ž0å¼€å§‹çš„é€’å¢žæ•°å­—å‘½åï¼ŒRedisé»˜è®¤æ”¯æŒ16ä¸ªæ•°æ®åº“ Redisä¸æ”¯æŒè‡ªå®šä¹‰æ•°æ®åº“åç§°ï¼Œæ¯ä¸ªæ•°æ®åº“éƒ½ä»¥ç¼–å·å‘½å éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸€ä¸ªRediså®žä¾‹çš„å¤šä¸ªæ•°æ®åº“ä¹‹é—´å¹¶ä¸æ˜¯å®Œå…¨éš”ç¦»çš„ï¼Œæ¯”å¦‚ FLUSHALL å‘½ä»¤å¯ä»¥æ¸…ç©ºä¸€ä¸ª Redis å®žä¾‹ä¸­æ‰€æœ‰æ•°æ®åº“ä¸­çš„æ•°æ®ã€‚ç»¼ä¸Šæ‰€è¿°ï¼Œè¿™äº›æ•°æ®åº“æ›´åƒæ˜¯ä¸€ç§å‘½åç©ºé—´ï¼Œè€Œä¸é€‚å®œå­˜å‚¨ä¸åŒåº”ç”¨ç¨‹åºçš„æ•°æ®ã€‚æ¯”å¦‚ï¼Œå¯ä»¥ä½¿ç”¨0å·æ•°æ®åº“å­˜å‚¨åº”ç”¨Açš„ç”Ÿäº§çŽ¯å¢ƒæ•°æ®ï¼Œä½¿ç”¨1å·æ•°æ®åº“å­˜å‚¨åº”ç”¨Açš„æµ‹è¯•çŽ¯å¢ƒæ•°æ®ï¼Œè€Œä¸åº”è¯¥ä½¿ç”¨1å·æ•°æ®åº“å­˜å‚¨åº”ç”¨Bçš„æ•°æ®ã€‚ ä¸åŒçš„åº”ç”¨ï¼Œåº”è¯¥ä½¿ç”¨ä¸åŒçš„Rediså®žä¾‹å­˜å‚¨æ•°æ®ã€‚ ç”±äºŽRediséžå¸¸è½»é‡ï¼Œä¸€ä¸ªç©ºçš„Rediså®žä¾‹å ç”¨çš„å†…å­˜åªæœ‰1MBï¼Œæ‰€ä»¥ä¸ç”¨æ‹…å¿ƒå¤šä¸ªRediså®žä¾‹ä¼šé¢å¤–å ç”¨å¾ˆå¤šå†…å­˜ã€‚ Redis å…¥é—¨å‘½ä»¤è¡ŒåŸºç¡€ èŽ·å¾—ç¬¦åˆè§„åˆ™çš„é”®ååˆ—è¡¨ 1KEYS pattern pattern æ”¯æŒ glob é£Žæ ¼é€šé…ç¬¦æ ¼å¼ï¼Œå…·ä½“å¦‚ä¸‹ ç¬¦å· å«ä¹‰ ? åŒ¹é…ä¸€ä¸ªå­—ç¬¦ * åŒ¹é…ä»»æ„ä¸ªï¼ˆåŒ…æ‹¬0ä¸ªï¼‰å­—ç¬¦ [] åŒ¹é…æ‹¬å·é—´çš„ä»»ä¸€å­—ç¬¦ï¼Œå¯ä»¥ä½¿ç”¨ - è¡¨ç¤ºä¸€ä¸ªèŒƒå›´ï¼Œå¦‚ [1-9] \x ç”¨äºŽè½¬ä¹‰å­—ç¬¦ ä¾‹å¦‚ï¼ŒæŸ¥è¯¢å½“å‰çš„æ‰€æœ‰é”®ååˆ—è¡¨ 1234&gt; set bar 1OK&gt; KEYS *1) "bar" åˆ¤æ–­ä¸€ä¸ªé”®æ˜¯å¦å­˜åœ¨ 1234EXISTS key//è¿”å›ž(integer) 1ï¼Œè¡¨ç¤ºå­˜åœ¨//è¿”å›ž(integer) 0ï¼Œè¡¨ç¤ºä¸å­˜åœ¨ åˆ é™¤é”® 1234DEL key [key ...]//è¿”å›ž(integer) 1ï¼Œè¡¨ç¤ºåˆ é™¤æˆåŠŸ//è¿”å›ž(integer) 0ï¼Œè¡¨ç¤ºåˆ é™¤ä¸æˆåŠŸ èŽ·å¾—é”®å€¼çš„æ•°æ®ç±»åž‹ 123TYPE key//è¿”å›ž string list ç­‰ Redis 5 ç§æ•°æ®ç±»åž‹Redis æ”¯æŒ5ç§æ•°æ®ç±»åž‹ stringï¼ˆå­—ç¬¦ä¸²ï¼‰ hashï¼ˆå“ˆå¸Œæˆ–æ•£åˆ—ï¼‰ listï¼ˆåˆ—è¡¨ï¼‰ setï¼ˆé›†åˆï¼‰ zset(sorted setï¼Œæœ‰åºé›†åˆ) å­—ç¬¦ä¸²ç±»åž‹ èµ‹å€¼å’Œå–å€¼ 123SET key valueGET key //å½“é”®ä¸å­˜åœ¨æ—¶ä¼šè¿”å›žç©ºç»“æžœ é€’å¢žæ•°å­— 1INCR key å½“è¦æ“ä½œçš„é”®ä¸å­˜åœ¨æ—¶ï¼Œé»˜è®¤é”®å€¼ä¸º0ï¼Œæ‰€ä»¥ç¬¬ä¸€æ¬¡é€’å¢žåŽç»“æžœä¸º1ï¼Œå¦‚ä¸‹æ‰€ç¤º 1234&gt; INCR num(integer) 1&gt; INCR num(integer) 2 å¢žåŠ æŒ‡å®šçš„æ•´æ•° 1INCRBY key increment å‡å°‘æŒ‡å®šçš„æ•´æ•° 123DECR keyDECRBY key increment å¢žåŠ æŒ‡å®šæµ®ç‚¹æ•° 1INCRBYFLOAT key increment å‘å°¾éƒ¨è¿½åŠ å€¼ 1APPEND key value APPEND å‘½ä»¤ä¸­ï¼Œè‹¥é”®ä¸å­˜åœ¨ï¼Œåˆ™å°†è¯¥é”®çš„å€¼è®¾ä¸º valueï¼Œç›¸å½“äºŽæ‰§è¡Œäº† SET key valueã€‚ èŽ·å–å­—ç¬¦ä¸²é•¿åº¦ 1STRLEN key å¯¹äºŽæ±‰å­—ï¼ŒRedisä½¿ç”¨UTF-8ç¼–ç çš„ä¸­æ–‡ï¼Œå¦‚ä¸‹ç¤ºä¾‹ä¸­ï¼Œâ€œä½ â€å’Œâ€œå¥½â€ä¸¤ä¸ªå­—çš„UTF-8ç¼–ç çš„é•¿åº¦éƒ½æ˜¯3ï¼Œæ‰€ä»¥è¿”å›žçš„å­—ç¬¦ä¸²é•¿åº¦ä¸º6ã€‚ 1234&gt; SET key1 ä½ å¥½OK&gt; STRLEN key1(integer) 6 åŒæ—¶èŽ·å¾—/è®¾ç½®å¤šä¸ªé”®å€¼ 123MSET key1 value1 key2 value2 key3 value3MGET key1 key2 key3 ä½æ“ä½œ 1234567GETBIT key offset //èŽ·å–ä¸€ä¸ªå­—ç¬¦ä¸²ç±»åž‹é”®æŒ‡å®šä½ç½®çš„äºŒè¿›åˆ¶ä½çš„å€¼ï¼ˆ0æˆ–1ï¼‰ SETBIT key offset value //è®¾ç½®æŒ‡å®šä½ç½®çš„äºŒè¿›åˆ¶ä½çš„å€¼BITCOUNT key [start] [end] //èŽ·å¾—å­—ç¬¦ä¸²ç±»åž‹é”®ä¸­å€¼æ˜¯1çš„äºŒè¿›åˆ¶ä½ä¸ªæ•°BITOP operation destkey key [key ...] //å¯¹å¤šä¸ªå­—ç¬¦ä¸²ç±»åž‹é”®è¿›è¡Œä½è¿ç®—ï¼Œç»“æžœå­˜å‚¨åœ¨destkey ä¸€ä¸ªå­—èŠ‚ç”±8ä¸ªäºŒè¿›åˆ¶ä½ç»„æˆã€‚Redis æä¾›äº† 4 ä¸ªå‘½ä»¤å¯ä»¥ç›´æŽ¥å¯¹äºŒè¿›åˆ¶ä½æ“ä½œã€‚ ä¸‹é¢è¿›è¡Œç¤ºä¾‹åˆ†æžã€‚ 1SET foo bar â€œbarâ€çš„3ä¸ªå­—æ¯å¯¹åº”çš„ASCIIç åˆ†åˆ«æ˜¯98ï¼Œ97ï¼Œ114ï¼Œè½¬æ¢ä¸ºå¯¹åº”çš„äºŒè¿›åˆ¶æ•°å€¼ï¼Œfoo é”®ä¸­çš„äºŒè¿›åˆ¶ä½ç»“æž„ä¸º01100010,01100001,01110010ã€‚ (1) ä½¿ç”¨ GETBIT key offset èŽ·å–ä¸€ä¸ªå­—ç¬¦ä¸²ç±»åž‹é”®æŒ‡å®šä½ç½®çš„äºŒè¿›åˆ¶ä½çš„å€¼ï¼ˆ0æˆ–1ï¼‰ 12redis&gt; GETBIT foo 6(integer) 1 å¦‚æžœèŽ·å–çš„äºŒè¿›åˆ¶ä½çš„ç´¢å¼•è¶…å‡ºäº†é”®å€¼çš„äºŒè¿›åˆ¶ä½çš„å®žé™…é•¿åº¦ï¼Œåˆ™é»˜è®¤è¿”å›ž 0 (2) BITOP operation destkey key [key ...] å¯ä»¥å¯¹å¤šä¸ªå­—ç¬¦ä¸²ç±»åž‹é”®è¿›è¡Œä½è¿ç®—ï¼Œç»“æžœå­˜å‚¨åœ¨ destkey 12345678127.0.0.1:6379&gt; SET foo1 barOK127.0.0.1:6379&gt; SET foo2 aarOK127.0.0.1:6379&gt; BITOP OR res foo1 foo2 //æˆ–è¿ç®—(integer) 3127.0.0.1:6379&gt; GET res"car" å“ˆå¸Œï¼ˆæ•£åˆ—ï¼‰ç±»åž‹å“ˆå¸Œï¼ˆæˆ–æ•£åˆ—ï¼‰hash ç±»åž‹çš„é”®å€¼ä¹Ÿæ˜¯ä¸€ç§å­—å…¸ç»“æž„ï¼Œå…¶å­˜å‚¨äº†å­—æ®µï¼ˆfieldï¼‰å’Œå­—æ®µå€¼çš„æ˜ å°„ï¼Œä½†å­—æ®µå€¼åªèƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œä¸æ”¯æŒå…¶ä»–æ•°æ®ç±»åž‹ã€‚ èµ‹å€¼å’Œå–å€¼ 1234567HSET key field value //ä¸åŒºåˆ†æ’å…¥å’Œæ›´æ–°æ“ä½œï¼Œå³æ›´æ–°æ•°æ®æ—¶ä¸ç”¨äº‹å…ˆåˆ¤æ–­æ˜¯å¦å­˜åœ¨ HGET key fieldHMSET key field value [field value ...]HMGET key field [field ...]HGETALL key åˆ¤æ–­å­—æ®µæ˜¯å¦å­˜åœ¨ 1HEXISTS key field ä»…ä»…åœ¨å­—æ®µä¸å­˜åœ¨æ˜¯èµ‹å€¼ 1HSETNX key field value HSETNX å’Œ HSET å‘½ä»¤ç±»ä¼¼ï¼ŒåŒºåˆ«åœ¨äºŽå¦‚æžœå­—æ®µå·²ç»å­˜åœ¨ï¼ŒHSETNX å‘½ä»¤å°†ä¸æ‰§è¡Œä»»ä½•æ“ä½œã€‚ HSETNX ä¸­çš„ NX è¡¨ç¤º if Not eXistsã€‚ å¢žåŠ æ•°å­— 1HINCRBY key filed increment åˆ é™¤å­—æ®µ 1HDEL key field [field ...] åªèŽ·å–å­—æ®µåç§°æˆ–å­—æ®µå€¼ 123HKEYS keyHVALS key èŽ·å¾—å­—æ®µæ•°é‡ 1HLEN key åˆ—è¡¨ç±»åž‹åˆ—è¡¨ï¼ˆlistï¼‰å¯ä»¥å­˜å‚¨ä¸€ä¸ªæœ‰åºçš„å­—ç¬¦ä¸²åˆ—è¡¨ï¼Œå¸¸ç”¨çš„æ“ä½œæ˜¯å‘åˆ—è¡¨ä¸¤ç«¯æ·»åŠ å…ƒç´ ï¼Œæˆ–è€…èŽ·å–åˆ—è¡¨çš„æŸä¸€ä¸ªç‰‡æ®µã€‚ åˆ—è¡¨ç±»åž‹å†…éƒ¨ä½¿ç”¨çš„æ˜¯åŒå‘é“¾è¡¨å®žçŽ°çš„ï¼Œæ‰€ä»¥æƒ³åˆ—è¡¨ä¸¤ç«¯æ·»åŠ å…ƒç´ çš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(1)ï¼ŒèŽ·å–è¶ŠæŽ¥è¿‘ä¸¤ç«¯çš„å…ƒç´ é€Ÿåº¦å°±è¶Šå¿«ï¼Œä½†æ˜¯é€šè¿‡ç´¢å¼•è®¿é—®å…ƒç´ ä¼šæ¯”è¾ƒæ…¢ã€‚å› æ­¤ï¼Œé’ˆå¯¹åŒå‘é“¾è¡¨çš„ç‰¹ç‚¹ï¼Œåˆ—è¡¨ç±»åž‹ç‰¹åˆ«é€‚åˆå¦‚ä¸‹åœºæ™¯ å¦‚ç¤¾äº¤ç½‘ç«™çš„æ–°é²œäº‹ï¼Œæˆ‘ä»¬åªå…³å¿ƒæœ€æ–°å†…å®¹ï¼Œå³ä½¿æ–°é²œäº‹è¾¾åˆ°å‡ åƒä¸‡æ¡ï¼ŒèŽ·å–åˆ—è¡¨å°¾éƒ¨çš„100æ¡æœ€æ–°æ•°æ®ä¹Ÿæ˜¯å¾ˆå¿«çš„ å¦‚æ—¥å¿—è®°å½•åœºæ™¯ï¼ŒåŒå‘é“¾è¡¨ä¿è¯äº†æ’å…¥æ–°æ—¥å¿—çš„é€Ÿåº¦ä¸ä¼šå—åˆ°å·²æœ‰æ—¥å¿—æ•°é‡çš„å½±å“ å€ŸåŠ©åˆ—è¡¨ç±»åž‹ï¼ŒRedisè¿˜å¯ä»¥ä½œä¸ºé˜Ÿåˆ—ä½¿ç”¨ å‘åˆ—è¡¨ä¸¤ç«¯å¢žåŠ å…ƒç´  12LPUSH key value [value ...] //å‘åˆ—è¡¨å·¦è¾¹æ’å…¥å…ƒç´ RPUSH key value [value ...] ä»Žåˆ—è¡¨ä¸¤ç«¯å¼¹å‡ºå…ƒç´  12LPOP key RPOP key èŽ·å–åˆ—è¡¨ä¸­å…ƒç´ ä¸ªæ•° 1LLEN key // å½“é”®ä¸å­˜åœ¨åˆ™è¿”å›ž0 èŽ·å¾—åˆ—è¡¨ç‰‡æ®µ 1LRANGE key start stop //è¿”å›žåŒºé—´[start,stop]çš„åˆ—è¡¨ç‰‡æ®µï¼ˆåŒºé—´é—­åˆï¼‰ï¼Œä¸æ”¹å˜åŽŸåˆ—è¡¨ åˆ é™¤åˆ—è¡¨ä¸­æŒ‡å®šçš„å€¼ 12LREM key count value //åˆ é™¤åˆ—è¡¨ä¸­å‰countä¸ªå€¼ä¸ºvalueçš„å…ƒç´ ï¼Œè¿”å›žå€¼æ˜¯å®žé™…åˆ é™¤çš„å…ƒç´ ä¸ªæ•° å½“ count å¤§äºŽ0æ—¶ï¼Œä¼šä»Žåˆ—è¡¨å·¦è¾¹å¼€å§‹åˆ é™¤å‰count ä¸ªï¼›å½“å°äºŽ0æ—¶ï¼Œä¼šä»Žåˆ—è¡¨å³è¾¹è¾¹å¼€å§‹ï¼›å½“ count ç­‰äºŽ0æ—¶ï¼Œä¼šåˆ é™¤åˆ—è¡¨ä¸­æ‰€æœ‰å€¼ä¸º value çš„å…ƒç´ ã€‚ èŽ·å¾—/è®¾ç½®æŒ‡å®šç´¢å¼•çš„å…ƒç´ å€¼ 123LINDEX key indexLSET key index value è‹¥ index å°äºŽ0ï¼Œè¡¨ç¤ºä»Žåˆ—è¡¨å³è¾¹å¼€å§‹è®¡ç®—ç´¢å¼•ï¼Œæœ€å³è¾¹çš„å…ƒç´ çš„ç´¢å¼•å€¼æ˜¯ -1ã€‚ åªä¿ç•™åˆ—è¡¨æŒ‡å®šç‰‡æ®µ 1LTRIM key start stop //åªä¿ç•™åŒºé—´[start,stop]çš„åˆ—è¡¨ç‰‡æ®µï¼ˆåŒºé—´é—­åˆï¼‰ï¼Œæ”¹å˜äº†åŽŸåˆ—è¡¨ å‘åˆ—è¡¨ä¸­æ’å…¥å…ƒç´  12LINSERT key BEFORE|AFTER pivot value //ä»Žå·¦åˆ°å³æŸ¥æ‰¾åˆ—è¡¨çš„pivotå…ƒç´ ï¼Œåœ¨è¯¥å…ƒç´ å‰æˆ–åŽï¼Œæ’å…¥valueå…ƒç´  å°†å…ƒç´ ä»Žä¸€ä¸ªåˆ—è¡¨è½¬åˆ°å¦ä¸€ä¸ªåˆ—è¡¨ 12RPOPLPUSH source destination//RPOPLPUSHè¡¨ç¤ºå…ˆæ‰§è¡ŒRPOPï¼Œå†æ‰§è¡ŒLPUSH é›†åˆç±»åž‹ç›¸æ¯”äºŽåˆ—è¡¨ï¼Œé›†åˆï¼ˆsetï¼‰ä¸­çš„å…ƒç´ æ˜¯å…¨å±€å”¯ä¸€çš„ï¼Œå¹¶ä¸”æ˜¯æ— åºçš„ã€‚ é›†åˆï¼ˆsetï¼‰ç±»åž‹åœ¨Rediså†…éƒ¨æ˜¯ä½¿ç”¨å€¼ä¸ºç©ºçš„æ•£åˆ—è¡¨(hash table)å®žçŽ°çš„ï¼Œæ‰€ä»¥å‘é›†åˆä¸­æ’å…¥æˆ–åˆ é™¤å…ƒç´ ï¼Œåˆ¤æ–­å…ƒç´ æ˜¯å¦å­˜åœ¨ï¼Œè¿™äº›æ“ä½œçš„æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ O(1)ã€‚ æ›´æ–¹ä¾¿çš„æ˜¯ï¼Œé‡‡ç”¨é›†åˆç±»åž‹ï¼Œå¤šä¸ªé›†åˆç±»åž‹ä¹‹é—´è¿˜å¯ä»¥è¿›è¡Œäº¤é›†ï¼Œå¹¶é›†å’Œå·®é›†è¿ç®—ã€‚ å¢žåŠ /åˆ é™¤å…ƒç´  12SADD key member [menber ...] //å¦‚æžœé”®ä¸å­˜åœ¨ï¼Œåˆ™è‡ªåŠ¨åˆ›å»ºï¼Œè¿”å›žå€¼ä¸ºæˆåŠŸåŠ å…¥çš„å…ƒç´ çš„æ•°é‡SREM key member [menber ...] èŽ·å¾—é›†åˆæ‰¾é‚£ä¸ªæ‰€æœ‰çš„å…ƒç´  1SMEMBERS key åˆ¤æ–­å…ƒç´ æ˜¯å¦åœ¨é›†åˆä¸­ 12// æ—¶é—´å¤æ‚åº¦ä½O(1) é€Ÿåº¦è¾ƒå¿«SISMEMBER key member é›†åˆä¹‹é—´çš„è¿ç®— 123SDIFF key [key ...] //å·®é›†SINTER key [key ...] //äº¤é›†SUNION key [key ...] //å¹¶é›† èŽ·å–é›†åˆä¸­å…ƒç´ ä¸ªæ•° 1SCARD key è¿›è¡Œé›†åˆè¿ç®—å¹¶å°†ç»“æžœå­˜å‚¨ 123SDIFFSTORE destination key [key ...]SINTERSTORE destination key [key ...]SUNIONSTORE destination key [key ...] éšæœºèŽ·å¾—é›†åˆä¸­çš„å…ƒç´  1SRANDMEMBER key [count] ä»Žé›†åˆä¸­å¼¹å‡ºä¸€ä¸ªå…ƒç´  1SPOP key æœ‰åºé›†åˆç±»åž‹æœ‰åºé›†åˆ(sorted list)ç±»åž‹ï¼Œæ˜¯åœ¨é›†åˆç±»åž‹çš„åŸºç¡€ä¸Šï¼Œä¸ºæ¯ä¸ªå…ƒç´ å…³è”ä¸€ä¸ªåˆ†æ•°ï¼ˆscoreï¼Œå¯ä»¥ç†è§£ä¸ºç´¢å¼•å€¼ï¼‰ï¼Œä½¿å¾—å…ƒç´ æœ‰åºã€‚ Redisä¸­ï¼Œé‡‡ç”¨å“ˆå¸Œè¡¨å’Œè·³è·ƒè¡¨ï¼ˆSkip listï¼‰å®žçŽ°æœ‰åºé›†åˆç±»åž‹ã€‚æ‰€ä»¥å³ä½¿è¯»å–ä½äºŽä¸­é—´éƒ¨åˆ†çš„æ•°æ®ï¼Œé€Ÿåº¦ä¹Ÿæ˜¯å¾ˆå¿«çš„ï¼ˆæ—¶é—´å¤æ‚åº¦æ˜¯``O(logN)`ï¼‰ã€‚ å¢žåŠ å…ƒç´  12//æ·»åŠ ä¸€ä¸ªmemberå…ƒç´ å’Œè¯¥å…ƒç´ çš„åˆ†æ•°scoreZADD key score member [score member] èŽ·å¾—å…ƒç´ çš„åˆ†æ•° 1ZSCORE key member èŽ·å¾—æŽ’ååœ¨æŸä¸ªèŒƒå›´çš„å…ƒç´ åˆ—è¡¨ 123456//æŒ‰ç…§å…ƒç´ åˆ†æ•°ä»Žå°åˆ°å¤§çš„é¡ºåºï¼Œè¿”å›žç´¢å¼•åœ¨åŒºé—´[start,stop]çš„æ‰€æœ‰å…ƒç´ //å¦‚æžœæœ‰å‚æ•°WITHSCORESï¼Œè¡¨ç¤ºè¿”å›žçš„å…ƒç´ åˆ—è¡¨åŒ…å«åˆ†æ•°ä¿¡æ¯ZRANGE key start stop [WITHSCORES]//ç±»ä¼¼ZRANGEï¼Œåªä¸è¿‡æ˜¯æŒ‰ç…§åˆ†æ•°ä»Žå¤§åˆ°å°çš„é¡ºåºZREVRANGE key start stop [WITHSCORES] èŽ·å¾—æŒ‡å®šåˆ†æ•°èŒƒå›´çš„å…ƒç´  123456//æŒ‰ç…§å…ƒç´ åˆ†æ•°ä»Žå°åˆ°å¤§çš„é¡ºåºï¼Œè¿”å›žç´¢å¼•åœ¨åŒºé—´[start,stop]çš„æ‰€æœ‰å…ƒç´ //å¦‚æžœæœ‰å‚æ•°WITHSCORESï¼Œè¡¨ç¤ºè¿”å›žçš„å…ƒç´ åˆ—è¡¨åŒ…å«åˆ†æ•°ä¿¡æ¯ZRANGE key start stop [WITHSCORES]//ç±»ä¼¼ZRANGEï¼Œåªä¸è¿‡æ˜¯æŒ‰ç…§åˆ†æ•°ä»Žå¤§åˆ°å°çš„é¡ºåºZREVRANGE key start stop [WITHSCORES] èŽ·å¾—æŒ‡å®šåˆ†æ•°èŒƒå›´çš„å…ƒç´  123//æŒ‰ç…§å…ƒç´ åˆ†æ•°ä»Žå°åˆ°å¤§ï¼Œè¿”å›žåˆ†æ•°åœ¨åŒºé—´[min,max]ä¹‹é—´çš„å…ƒç´ //LIMIT offset count è¡¨ç¤ºåœ¨èŽ·å¾—å…ƒç´ åˆ—è¡¨çš„åŸºç¡€ä¸Šï¼Œå‘åŽåç§»ï¼ˆè·³è¿‡ï¼‰offsetä¸ªå…ƒç´ ï¼Œå¹¶ä¸”åªèŽ·å–ä¹‹åŽçš„å‰countä¸ªå…ƒç´ ZRANGEBYSCORE key min max [WITHSCORES] [LIMIT offset count] å¢žåŠ æŸä¸ªå…ƒç´ çš„åˆ†æ•° 1ZINCRBY key increment member èŽ·å¾—é›†åˆä¸­å…ƒç´ çš„æ•°é‡ 1ZCARD key èŽ·å¾—æŒ‡å®šåˆ†æ•°èŒƒå›´å†…çš„å…ƒç´ ä¸ªæ•° 1ZCOUNT key min max æŒ‰ç…§æŽ’åèŒƒå›´åˆ é™¤å…ƒç´  12//æŒ‰ç…§å…ƒç´ åˆ†æ•°ä»Žå°åˆ°å¤§é¡ºåºï¼Œåˆ é™¤æŒ‡å®šæŽ’åèŒƒå›´å†…çš„å…ƒç´ ï¼Œå¹¶è¿”å›žåˆ é™¤çš„å…ƒç´ æ•°é‡ZREMRANGEBYRANK key start stop æŒ‰ç…§åˆ†æ•°èŒƒå›´åˆ é™¤å…ƒç´  12//è¿”å›žåˆ é™¤çš„å…ƒç´ æ•°é‡ZREMRANGEBYSCORE key min max èŽ·å¾—å…ƒç´ çš„æŽ’å 12ZRANK key member //æŒ‰ç…§åˆ†æ•°ä»Žå°åˆ°å¤§é¡ºåºZRANK key member //æŒ‰ç…§åˆ†æ•°ä»Žå¤§åˆ°å°é¡ºåº Redisè¿›é˜¶äº‹åŠ¡MULTI EXECäº‹åŠ¡(transaction)æ˜¯ä¸€ç»„å‘½ä»¤çš„é›†åˆï¼Œäº‹åŠ¡åŒå‘½ä»¤ä¸€æ ·ï¼Œéƒ½æ˜¯Redisçš„æœ€å°æ‰§è¡Œå•ä½ã€‚ä¸€ä¸ªäº‹åŠ¡ä¸­çš„å‘½ä»¤è¦ä¹ˆéƒ½æ‰§è¡Œï¼Œè¦ä¹ˆéƒ½ä¸æ‰§è¡Œã€‚äº‹åŠ¡çš„åº”ç”¨éžå¸¸æ™®éï¼Œå¦‚é“¶è¡Œè½¬è´¦ç­‰ã€‚ Redisçš„äº‹åŠ¡è¿˜å¯ä»¥ä¿è¯ä¸€ä¸ªäº‹åŠ¡å†…çš„å‘½ä»¤ä¸€æ¬¡æ‰§è¡Œè€Œä¸è¢«å…¶ä»–å‘½ä»¤æ’å…¥ã€‚ äº‹åŠ¡çš„åŽŸç†æ˜¯å…ˆå°†å±žäºŽä¸€ä¸ªäº‹åŠ¡çš„å‘½ä»¤å‘é€ç»™Redisï¼Œç„¶åŽå†è®©Redisä¸€æ¬¡æ‰§è¡Œè¿™äº›å‘½ä»¤ï¼Œä¾‹å¦‚ 123456789redis&gt; MULTIOKredis&gt; SADD "user:1:following" 2QUEEDredis&gt; SADD "user:2:following" 1QUEEDredis&gt; EXEC1) (integer) 12) (integer) 1 ä¸Šé¢çš„ä»£ç æ¼”ç¤ºäº†äº‹åŠ¡çš„ä½¿ç”¨æ–¹å¼ã€‚é¦–å…ˆä½¿ç”¨ MULIL å‘½ä»¤å‘Šè¯‰Redisï¼šâ€œä¸‹é¢æˆ‘å‘ç»™ä½ çš„å‘½ä»¤å±žäºŽåŒä¸€ä¸ªäº‹åŠ¡ï¼Œä½ å…ˆä¸è¦æ‰§è¡Œï¼Œè€Œæ˜¯æŠŠå®ƒä»¬æš‚æ—¶å­˜èµ·æ¥â€ã€‚ éšåŽå‘é€ä¸¤ä¸ª SADD å‘½ä»¤æ‰§è¡Œäº‹åŠ¡æ“ä½œï¼ŒRedisè¿”å›ž QUEED è¡¨ç¤ºè¿™2æ¡å‘½ä»¤å·²ç»è¿›å…¥ç­‰å¾…æ‰§è¡Œçš„äº‹åŠ¡é˜Ÿåˆ—ä¸­äº†ã€‚ æœ€åŽï¼Œå‘é€ EXEC å‘½ä»¤å‘Šè¯‰Rediså°†ç­‰å¾…æ‰§è¡Œçš„äº‹åŠ¡é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰å‘½ä»¤æŒ‰ç…§å‘é€é¡ºåºæ‰§è¡Œã€‚ äº‹åŠ¡ä¸­çš„å‘½ä»¤æ˜¯åœ¨ EXEC ä¹‹åŽæ‰æ‰§è¡Œçš„ï¼Œå› æ­¤ï¼Œä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œåªæœ‰å½“æ‰€æœ‰å‘½ä»¤éƒ½ä¾æ¬¡æ‰§è¡Œå®ŒæˆåŽï¼Œæ‰èƒ½å¾—åˆ°æ¯ä¸ªç»“æžœçš„è¿”å›žå€¼ã€‚ WATCHä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œåªæœ‰å½“æ‰€æœ‰å‘½ä»¤éƒ½ä¾æ¬¡æ‰§è¡Œå®ŒæˆåŽæ‰èƒ½å¾—åˆ°æ¯ä¸ªç»“æžœçš„è¿”å›žå€¼ã€‚ å¯æ˜¯æœ‰äº›æƒ…å†µä¸‹ï¼Œéœ€è¦å…ˆèŽ·å¾—ä¸€æ¡å‘½ä»¤çš„è¿”å›žå€¼ï¼Œæ ¹æ®è¿”å›žå€¼å†æ‰§è¡Œä¸‹ä¸€æ¡å‘½ä»¤ã€‚é’ˆå¯¹è¯¥æƒ…å†µï¼Œå¯ä»¥ä½¿ç”¨ WATCH å‘½ä»¤ã€‚ WATCH å‘½ä»¤å¯ä»¥ç›‘æŽ§ä¸€ä¸ªæˆ–å¤šä¸ªé”®ï¼Œä¸€æ—¦å…¶ä¸­æœ‰ä¸€ä¸ªé”®è¢«ä¿®æ”¹æˆ–åˆ é™¤ï¼Œä¹‹åŽçš„äº‹åŠ¡å°±ä¸ä¼šæ‰§è¡Œã€‚ç›‘æŽ§ä¸€ç›´åˆ° EXEC å‘½ä»¤ã€‚ï¼ˆäº‹åŠ¡ä¸­çš„å‘½ä»¤æ˜¯åœ¨ EXEC ä¹‹åŽæ‰æ‰§è¡Œçš„ï¼Œæ‰€ä»¥åœ¨ MULTI å‘½ä»¤åŽå¯ä»¥ä¿®æ”¹ WATCH ç›‘æŽ§çš„é”®å€¼ï¼‰ 1234567891011121314redis&gt; SET key 1OKredis&gt; WATCH keyOKredis&gt; SET key 2OKredis&gt; MULTIOKredis&gt; SET key 3QUEEDredis&gt; EXECnilredis&gt; GET key"2" ä¸Šä¾‹ä¸­ï¼Œæ‰§è¡Œ WATCH å‘½ä»¤åŽï¼Œäº‹åŠ¡ä¿®æ”¹äº† key å€¼ï¼Œæ‰€ä»¥æœ€åŽäº‹åŠ¡ä»£ç å¹¶æ²¡æœ‰æ‰§è¡Œï¼ŒEXEC å‘½ä»¤è¿”å›žç»“æžœä¸º nilã€‚ æ‰§è¡Œ EXEC å‘½ä»¤åŽæ‚”å–æ¶ˆå¯¹æ‰€æœ‰é”®çš„ç›‘æŽ§ã€‚ è¿‡æœŸæ—¶é—´Redis ä¸­å¯ä»¥ä½¿ç”¨ EXPTRE å‘½ä»¤è®¾ç½®ä¸€ä¸ªé”®çš„è¿‡æœŸæ—¶é—´ï¼Œåˆ°æ—¶é—´åŽ Redis ä¼šè‡ªåŠ¨åˆ é™¤å®ƒã€‚ è®¾ç½®è¿‡æœŸæ—¶é—´ 123EXPIRE key seconds //seconds å•ä½ä¸ºç§’PEXPIRE key milliseconds //milliseconds å•ä½ä¸ºæ¯«ç§’ æŸ¥è¯¢é”®è¿˜æœ‰å¤šå°‘æ—¶é—´ä¼šè¢«åˆ é™¤ 123456TTL key //è¿”å›žæ—¶é—´å•ä½ä¸ºç§’PTTL key //è¿”å›žæ—¶é—´å•ä½ä¸ºæ¯«ç§’// é”®ä¸å­˜åœ¨æ—¶ï¼Œå‘½ä»¤è¿”å›ž-2// é”®æœªè®¾ç½®è¿‡æœŸæ—¶é—´æ—¶ï¼Œå‘½ä»¤è¿”å›ž-1 å–æ¶ˆé”®çš„è¿‡æœŸæ—¶é—´è®¾ç½® 1PERSIST key é™¤äº† PERSIST å‘½ä»¤å¤–ï¼Œä½¿ç”¨ SET æˆ– GETSET å‘½ä»¤ä¸ºé”®èµ‹å€¼ï¼Œä¹Ÿä¼šåŒæ—¶æ¸…é™¤é”®çš„è¿‡æœŸæ—¶é—´ã€‚ å®žçŽ°è®¿é—®é¢‘çŽ‡é™åˆ¶è€ƒè™‘å¦‚ä¸‹åœºæ™¯â€”â€”ä¸ºäº†å‡è½»æœåŠ¡å™¨çš„åŽ‹åŠ›ï¼Œé™åˆ¶æ¯ä¸ªç”¨æˆ·ï¼ˆIPï¼‰æ¯åˆ†é’Ÿæœ€å¤šåªèƒ½è®¿é—®10æ¬¡ï¼Œå°±å¯ä»¥ä½¿ç”¨è¿‡æœŸæ—¶é—´ EXPIRE å®žçŽ° åˆ›å»ºä¸€ä¸ª rate.limiting:userIP çš„é”® è®¾ç½® EXPIRE key secondsï¼Œè¿‡æœŸæ—¶é—´ä¸º60sã€‚ä¸€åˆ†é’ŸåŽï¼Œè¯¥é”®ä¼šè¢«è‡ªåŠ¨åˆ é™¤ ç”¨æˆ·æ¯æ¬¡è®¿é—®æœåŠ¡å™¨ï¼Œä½¿ç”¨ INCR é€’å¢žè¯¥é”®å€¼ å½“è®¿é—®æ¬¡æ•°è¾¾åˆ°10åŽï¼Œæç¤ºç”¨æˆ·ç¨åŽè®¿é—® ä¸Šè¿°æµç¨‹çš„ä¼ªä»£ç å¦‚ä¸‹ 1234567891011$isKeyExists = EXISTS rate.limiting:$IPif isKeyExists is 1 $time = INCR rate.limiting:$IP if $time &gt; 10 print è®¿é—®é¢‘çŽ‡è¶…è¿‡äº†é™åˆ¶ï¼Œè¯·ç¨åŽå†è¯• exitelse MULTI //ä½¿ç”¨äº‹åŠ¡ï¼Œé¿å…EXPIREå› ä¸ºæŸç§åŽŸå› æœªæ‰§è¡Œï¼Œå¯¼è‡´è¯¥é”®å€¼ä¸€ç›´å­˜åœ¨ INCR rate.limiting:$IP EXPIRE $keyName, 60 EXEC ä¸Šè¿°ä»£ç è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œæ¯”å¦‚ç”¨æˆ·åœ¨ç¬¬1åˆ†é’Ÿçš„æœ€åŽä¸€ç§’è®¿é—®äº†9æ¬¡ï¼Œåˆåœ¨ä¸‹ä¸€åˆ†é’Ÿçš„ç¬¬ä¸€ç§’è®¿é—®äº†10æ¬¡ã€‚è¿™ç§è®¿é—®æ˜¯å¯ä»¥é€šè¿‡ä¸Šè¿°è®¿é—®é™åˆ¶çš„ï¼Œä½†å®žé™…ä¸Šç”¨æˆ·åœ¨2ç§’å†…è®¿é—®äº†19æ¬¡æœåŠ¡å™¨ã€‚ ä¸ºäº†å¤„ç†ä¸Šè¿°åœºæ™¯ï¼Œå¯ä»¥å¯¹ä»£ç è¿›è¡Œä¼˜åŒ– ä½¿ç”¨ä¸€ä¸ªåˆ—è¡¨å­˜å‚¨ç”¨æˆ·æœ€è¿‘10æ¬¡è®¿é—®æœåŠ¡å™¨çš„æ—¶é—´ ä¸€æ—¦é”®ä¸­çš„å…ƒç´ å¤§äºŽ10ä¸ªï¼Œå°±åˆ¤æ–­æ—¶é—´æœ€æ—©çš„å…ƒç´ è·çŽ°åœ¨çš„æ—¶é—´æ˜¯å¦å°äºŽ1åˆ†é’Ÿã€‚ å¦‚æžœæ˜¯ï¼Œåˆ™è¡¨ç¤ºç”¨æˆ·æœ€è¿‘ä¸€åˆ†é’Ÿçš„è®¿é—®æ¬¡æ•°è¶…è¿‡äº†10æ¬¡ï¼Œè¿›è¡Œé™æµæé†’ã€‚ å¦‚æžœä¸æ˜¯ï¼Œå°±å°†çŽ°åœ¨çš„æ—¶é—´åŠ å…¥åˆ°åˆ—è¡¨ä¸­ï¼ŒåŒæ—¶æŠŠæœ€æ—©çš„å…ƒç´ åˆ é™¤ã€‚ 12345678910$listLength = LLEN rate.limiting:$IPif listLength &lt; 10 LPUSH rate.limiting:$IP,now()else $time = LINDEX rate.limiting:$IP, -1 if now() - $time &gt; 60 print è®¿é—®é¢‘çŽ‡è¶…è¿‡äº†é™åˆ¶ï¼Œè¯·ç¨åŽå†è¯• else LPUSH rate.limiting:$IP,now() LTRIM rate.limiting:$IP,0,9 å®žçŽ°ç¼“å­˜ä¸ºäº†æé«˜æœåŠ¡å™¨è´Ÿè½½èƒ½åŠ›ï¼Œå¸¸å¸¸éœ€è¦å°†ä¸€äº›è®¿é—®é¢‘çŽ‡è¾ƒé«˜ä½†æ˜¯CPUæˆ–åˆ™IOèµ„æºæ¶ˆè€—è¾ƒå¤§çš„æ“ä½œçš„ç»“æžœç¼“å­˜èµ·æ¥ï¼Œå¹¶å¸Œæœ›è®©è¿™äº›ç¼“å­˜è¿‡ä¸€æ®µæ—¶é—´åŽè‡ªåŠ¨è¿‡æœŸã€‚ å®žé™…å¼€å‘ä¸­å¾ˆéš¾ä¸ºç¼“å­˜é”®è®¾å®šåˆç†çš„è¿‡æœŸæ—¶é—´ï¼Œä¸ºæ­¤å¯ä»¥é™åˆ¶Rediså¯ä»¥ä½¿ç”¨çš„æœ€å¤§å†…å­˜ï¼Œå¹¶è®©RedisæŒ‰ç…§ä¸€å®šçš„è§„åˆ™æ·˜æ±°ä¸éœ€è¦çš„ç¼“å­˜é”®ã€‚è¿™ç§æ–¹å¼åœ¨åªå°†Redisç”¨ä½œç¼“å­˜ç³»ç»Ÿæ—¶éžå¸¸å®žç”¨ã€‚ Redisé…ç½®æ–‡ä»¶çš„ maxmemory å±žæ€§é™å®šäº†Rediså¯ä»¥ä½¿ç”¨çš„æœ€å¤§å†…å­˜ã€‚å½“è¶…å‡ºè¿™ä¸ªé™åˆ¶æ—¶ï¼ŒRedisä¼šä¾æ® maxmemory-policy å‚æ•°æŒ‡å®šçš„ç­–ç•¥æ¥åˆ é™¤ä¸è¦çš„é”®å€¼ç›´åˆ°Rediså ç”¨çš„å†…å­˜å¤§å°å°äºŽæŒ‡å®šå†…å­˜ã€‚ maxmemory-policy æ”¯æŒLRU(Least Recently Used) ç®—æ³•è§„åˆ™ï¼Œå³â€œæœ€è¿‘æœ€å°‘ä½¿ç”¨åŽŸåˆ™â€ï¼Œå…¶è®¤ä¸ºæœ€è¿‘æœ€å°‘ä½¿ç”¨çš„é”®åœ¨æœªæ¥ä¸€æ®µæ—¶é—´å†…ä¹Ÿä¸ä¼šè¢«ç”¨åˆ°ï¼Œå½“å†…å­˜ä¸è¶³æ—¶è¿™äº›é”®æ˜¯å¯ä»¥è¢«åˆ é™¤çš„ã€‚ æŽ’åºSORT å‘½ä»¤å¯ä»¥å¯¹åˆ—è¡¨ç±»åž‹ï¼Œé›†åˆç±»åž‹å’Œæœ‰åºé›†åˆç±»åž‹é”®è¿›è¡ŒæŽ’åºï¼Œå¹¶ä¸”å¯ä»¥å®Œæˆå’Œå…³ç³»æ•°æ®åº“ä¸­çš„è¿žæŽ¥æŸ¥è¯¢ç±»ä¼¼çš„ä»»åŠ¡ã€‚ 1SORT key BY å‚è€ƒé”® GET ... STORE destkey BY å‚è€ƒé”®ä¸­ï¼Œå¦‚æžœæä¾›äº† BY å‚æ•°ï¼ŒSORT å‘½ä»¤å°†ä¸å†ä¾æ®å…ƒç´ è‡ªèº«çš„å€¼è¿›è¡ŒæŽ’åºï¼Œè€Œæ˜¯å¯¹æ¯ä¸ªå…ƒç´ ä½¿ç”¨å…ƒç´ çš„å€¼æ›¿æ¢å‚è€ƒé”®ä¸­çš„ç¬¬ä¸€ä¸ª &quot;*&quot; å¹¶èŽ·å–å…¶å€¼ï¼Œç„¶åŽä¾æ®è¯¥å€¼å¯¹å…ƒç´ è¿›è¡ŒæŽ’åºã€‚ ä¾‹å¦‚ï¼Œä¸‹è¿°è¯­å¥å°†è¯»å–å¦‚ post:2ï¼Œpost:6ï¼Œpost:12ï¼Œpost:26 å‡ ä¸ªæ•£åˆ—é”®ä¸­çš„ time å­—æ®µçš„å€¼å¹¶ä»¥æ­¤å†³å®šæŽ’åºç»“æžœã€‚ 1SORT tag:ruby:posts BY post:*-&gt;time DESC GET å‚æ•°ä¸å½±å“æŽ’åºï¼Œå®ƒçš„ä½œç”¨æ˜¯ä½¿ SORT å‘½ä»¤çš„è¿”å›žç»“æžœä¸å†æ˜¯å…ƒç´ è‡ªèº«çš„å€¼ï¼Œè€Œæ˜¯ GET å‚æ•°ä¸­æŒ‡å®šçš„é”®å€¼ã€‚ STORE å‚æ•°ç”¨äºŽå°†æŽ’åºç»“æžœå­˜å‚¨åˆ°æŒ‡å®šçš„é”®ä¸­ æ€§èƒ½ä¼˜åŒ–SORT å‘½ä»¤çš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(n+mlog(m))ï¼Œå…¶ä¸­ n è¡¨ç¤ºè¦æŽ’åºçš„åˆ—è¡¨ï¼ˆæˆ–é›†åˆæˆ–æœ‰åºé›†åˆï¼‰ä¸­çš„å…ƒç´ ä¸ªæ•°ï¼Œmè¡¨ç¤ºè¦è¿”å›žçš„å…ƒç´ ä¸ªæ•°ã€‚å½“ n è¾ƒå¤§çš„æ—¶å€™ï¼ŒæŽ’åºå‘½ä»¤çš„æ€§èƒ½ç›¸å¯¹è¾ƒä½Žï¼Œå¹¶ä¸” Redis åœ¨æŽ’åºå‰ä¼šå»ºç«‹ä¸€ä¸ªé•¿åº¦ä¸º n çš„å®¹å™¨æ¥å­˜å‚¨å¾…æŽ’åºçš„å…ƒç´ ï¼Œè™½ç„¶æ˜¯ä¸€ä¸ªä¸´æ—¶çš„è¿‡ç¨‹ï¼Œä½†æ˜¯å¦‚æžœåŒæ—¶è¿›è¡Œè¾ƒå¤šçš„å¤§æ•°æ®é‡çš„æŽ’åºæ“ä½œåˆ™ä¼šä¸¥é‡å½±å“æ€§èƒ½ã€‚ æ‰€ä»¥å¼€å‘ä¸­ä½¿ç”¨ SORT å‘½ä»¤éœ€è¦æ³¨æ„ å°½å¯èƒ½å‡å°‘å¾…æŽ’åºé”®ä¸­å…ƒç´ çš„æ•°é‡ï¼ˆä½¿ n å°½å¯èƒ½å°ï¼‰ ä½¿ç”¨ LIMIT å‚æ•°åªèŽ·å–éœ€è¦çš„æ•°æ®ï¼ˆä½¿ m å°½å¯èƒ½å°ï¼‰ å¦‚æžœéœ€è¦æŽ’åºçš„æ•°æ®é‡è¾ƒå¤§ï¼Œå°½å¯èƒ½ä½¿ç”¨ STORE å‚æ•°å°†ç»“æžœç¼“å­˜ æ¶ˆæ¯é€šçŸ¥ä»»åŠ¡é˜Ÿåˆ—ä»»åŠ¡é˜Ÿåˆ—ï¼Œå³â€œä¼ é€’ä»»åŠ¡çš„é˜Ÿåˆ—â€ã€‚å’Œä»»åŠ¡é˜Ÿåˆ—è¿›è¡Œäº¤äº’çš„å®žä½“æœ‰ä¸¤ç±»ï¼Œä¸€ç±»æ˜¯ç”Ÿäº§è€…ï¼ˆproducerï¼‰ï¼Œå¦ä¸€ç±»æ˜¯æ¶ˆè´¹è€…ï¼ˆconsumerï¼‰ã€‚ç”Ÿäº§è€…ä¼šå°†éœ€è¦å¤„ç†çš„ä»»åŠ¡æ”¾å…¥ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼Œè€Œæ¶ˆè´¹è€…ä¼šä¸æ–­åœ°ä»Žä»»åŠ¡é˜Ÿåˆ—ä¸­è¯»å…¥ä»»åŠ¡ä¿¡æ¯å¹¶æ‰§è¡Œã€‚ ä½¿ç”¨ä»»åŠ¡é˜Ÿåˆ—çš„å¥½å¤„ æ¾è€¦åˆï¼šç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä¸éœ€è¦çŸ¥é“å½¼æ­¤çš„å®žçŽ°ç»†èŠ‚ï¼Œåªéœ€çº¦å®šå¥½çš„ä»»åŠ¡çš„æè¿°æ ¼å¼å³å¯ã€‚ æ˜“äºŽæ‰©å±•ï¼šæ¶ˆè´¹è€…å¯ä»¥æ‰©å±•åˆ°å¤šä¸ªï¼Œè€Œä¸”å¯ä»¥åˆ†å¸ƒåœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸­ï¼Œå¯ä»¥è½»æ˜“åœ°é™ä½Žå•å°æœåŠ¡å™¨çš„è´Ÿè½½ ä½¿ç”¨Rediså®žçŽ°ä»»åŠ¡é˜Ÿåˆ—ä½¿ç”¨Redisçš„åˆ—è¡¨ç»“æž„å’Œ RPOPï¼ŒLPUSH å‘½ä»¤ï¼Œå¯ä»¥å®žçŽ°ç®€å•çš„ä»»åŠ¡é˜Ÿåˆ—ï¼Œä¼ªä»£ç å¦‚ä¸‹æ‰€ç¤º 123456789# æ— é™å¾ªçŽ¯è¯»å–ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„å†…å®¹loop $task = RPOP queue if $task # å¦‚æžœä»»åŠ¡é˜Ÿåˆ—ä¸­æœ‰ä»»åŠ¡åˆ™æ‰§è¡Œä»»åŠ¡ execute($task) else # å¦‚æžœæ²¡æœ‰åˆ™ç­‰å¾…1ç§’ï¼Œä»¥å…è¿‡äºŽé¢‘ç¹åœ°è¯·æ±‚æ•°æ® wait 1 second ä¸Šè¿°ä¼ªä»£ç æœ‰ä¸ªä¸è¶³ä¹‹å¤„ï¼Œå½“ä»»åŠ¡é˜Ÿåˆ—ä¸­æ²¡æœ‰ä»»ä½•ä»»åŠ¡æ—¶ï¼Œæ¶ˆè´¹è€…æ¯ç§’éƒ½ä¼šè°ƒç”¨ä¸€æ¬¡ RPOP å‘½ä»¤æŸ¥è¯¢æ˜¯å¦æœ‰æ–°ä»»åŠ¡ã€‚ å¦‚æžœå¯ä»¥å®žçŽ°ä¸€æ—¦æœ‰æ–°ä»»åŠ¡åŠ å…¥ä»»åŠ¡é˜Ÿåˆ—å°±é€šçŸ¥æ¶ˆè´¹è€…å°±å¥½äº†ã€‚å…¶å®žå€ŸåŠ© BRPOP å‘½ä»¤å°±å¯ä»¥å®žçŽ°è¿™æ ·çš„éœ€æ±‚ã€‚ å¦‚ä¸Šä¼ªä»£ç å¯ä»¥ä¼˜åŒ–ä¸º 12345loop # å¦‚æžœä»»åŠ¡é˜Ÿåˆ—ä¸­æ²¡æœ‰æ–°ä»»åŠ¡ï¼ŒBRPOPå‘½ä»¤ä¼šä¸€ç›´é˜»å¡žï¼Œä¸ä¼šæ‰§è¡Œexecute() $task = BRPOP queue, 0 # è¿”å›žå€¼æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„ç¬¬2ä¸ªå…ƒç´ æ˜¯æˆ‘ä»¬éœ€è¦çš„ä»»åŠ¡ execute($task[1]) BRPOP å’Œ RPOP å‘½ä»¤ç±»ä¼¼ï¼Œå”¯ä¸€çš„åŒºåˆ«å°±æ˜¯å½“åˆ—è¡¨ä¸­æ²¡æœ‰å…ƒç´ æ—¶ï¼ŒBRPOP å‘½ä»¤ä¼šä¸€ç›´é˜»å¡žè¿žæŽ¥ï¼Œç›´åˆ°æœ‰æ–°å…ƒç´ åŠ å…¥ã€‚ 1BRPOP key [key ...] timeout BRPOP å‘½ä»¤æŽ¥æ”¶2ä¸ªå‚æ•°ï¼Œç¬¬1ä¸ªå‚æ•°æ˜¯é”®åï¼Œç¬¬2ä¸ªå‚æ•°æ˜¯è¶…æ—¶æ—¶é—´ï¼Œå•ä½æ˜¯ç§’ã€‚å½“è¶…è¿‡äº†æ­¤æ—¶é—´ä»ç„¶æ²¡æœ‰èŽ·å¾—æ–°å…ƒç´ çš„è¯ï¼Œå°±ä¼šè¿”å›ž nilã€‚å¦‚æžœä¼ å…¥æ—¶é—´å‚æ•°ä¸º0ï¼ˆå¦‚ä¸‹ä¼ªä»£ç ç¤ºä¾‹ï¼‰ï¼Œåˆ™è¡¨ç¤ºä¸é™åˆ¶ç­‰å¾…æ—¶é—´ï¼Œå³å¦‚æžœæ²¡æœ‰æ–°å…ƒç´ åŠ å…¥é˜Ÿåˆ—å°±ä¼šæ°¸è¿œé˜»å¡žä¸‹åŽ»ã€‚ èŽ·å¾—ä¸€ä¸ªå…ƒç´ åŽï¼ŒBRPOP å‘½ä»¤ä¼šè¿”å›žä¸€ä¸ªæ•°ç»„ï¼Œå…±2ä¸ªå€¼ï¼Œåˆ†åˆ«æ˜¯é”®åå’Œå…ƒç´ å€¼ã€‚ç¬¬2ä¸ªå‚æ•°ï¼Œå…ƒç´ å€¼ï¼Œå°±æ˜¯å¾…å¤„ç†çš„ä»»åŠ¡ã€‚ ä¼˜å…ˆçº§é˜Ÿåˆ—åœ¨å®žé™…å¼€å‘ä¸­ï¼Œé’ˆå¯¹å¤šç§ä¸åŒçš„ä»»åŠ¡ï¼Œç»å¸¸ä¼šéœ€è¦æ ¹æ®ä»»åŠ¡çš„ä¼˜å…ˆçº§ï¼ŒåŽ»æ‰§è¡Œä¼˜å…ˆçº§è¾ƒé«˜çš„ä»»åŠ¡ï¼Œå³éœ€è¦å®žçŽ°ä¸€ä¸ªä¼˜å…ˆçº§é˜Ÿåˆ—ã€‚ BRPOP å’Œ BLPOP å‘½ä»¤å¯ä»¥åŒæ—¶æŽ¥æ”¶å¤šä¸ªé”®ï¼Œå¯ä»¥å®žçŽ°ä¼˜å…ˆçº§é˜Ÿåˆ—ã€‚ 1BRPOP key [key ...] timeout ä¾‹å¦‚ï¼ŒBLPOP queue:1 queue:2 0ï¼Œè¡¨ç¤ºåŒæ—¶æ£€æµ‹å¤šä¸ªé”®â€”â€”queue:1 å’Œ queue:2 å¦‚æžœæ‰€æœ‰é”®éƒ½æ²¡å…ƒç´ åˆ™é˜»å¡ž å¦‚æžœæœ‰ä¸€ä¸ªé”®æœ‰å…ƒç´ åˆ™ä¼šä»Žè¯¥é”®ä¸­å¼¹å‡ºå…ƒç´  å¦‚æžœå¤šä¸ªé”®éƒ½æœ‰å…ƒç´ ï¼Œåˆ™æŒ‰ç…§ä»Žå·¦åˆ°å³é¡ºåºè¯»å–ç¬¬ä¸€ä¸ªé”®ä¸­çš„ä¸€ä¸ªå…ƒç´  1234567891011121314redis&gt; LPUSH queue:2 task11) (integer) 1redis&gt; LPUSH queue:3 task21) (integer) 1//...redis&gt;BRPOP queue:1 queue:2 queue:3 01) "queue:2"2) "task1"redis&gt;BLPOP queue:1 queue:2 queue:3 01) "queue:3"2) "task2" ä½¿ç”¨ BRPOP åˆ›å»ºä¼˜å…ˆçº§é˜Ÿåˆ—æ—¶ï¼ŒRPOP è¡¨ç¤ºé˜Ÿåˆ—å·¦è¿›å³å‡ºï¼Œå› æ­¤æœ‰å¦‚ä¸‹ç»“æž„ã€‚å³ BRPOP queue:1 queue:2 queue:3 0 å‘½ä»¤ä¸­ï¼Œè¶Šé å·¦çš„é”®ä¼˜å…ˆçº§è¶Šé«˜ï¼ˆqueue:1 çš„ä¼˜å…ˆçº§æœ€é«˜ï¼Œå› æ­¤ä¼šæŒ‰ç…§ä»Žå·¦åˆ°å³é¡ºåºè¯»å–ç¬¬ä¸€ä¸ªé”®ä¸­çš„ä¸€ä¸ªå…ƒç´ ã€‚ 1(L-å·¦è¿›)--- | queue:3| queue:2| queue:1| --&gt; (R-å³å‡º) ä½¿ç”¨ BLPOP åˆ›å»ºä¼˜å…ˆçº§é˜Ÿåˆ—æ—¶ï¼ŒLPOP è¡¨ç¤ºé˜Ÿåˆ—å³è¿›å·¦å‡ºï¼Œå› æ­¤æœ‰å¦‚ä¸‹ç»“æž„ã€‚å³ BLPOP queue:1 queue:2 queue:3 0 å‘½ä»¤ä¸­ï¼Œè¶Šé å³çš„é”®ä¼˜å…ˆçº§è¶Šé«˜ï¼ˆqueue:3 çš„ä¼˜å…ˆçº§æœ€é«˜ï¼‰ï¼Œå› æ­¤ä¼šæŒ‰ç…§ä»Žå³åˆ°å·¦é¡ºåºè¯»å–ç¬¬ä¸€ä¸ªé”®ä¸­çš„ä¸€ä¸ªå…ƒç´ ã€‚ 1(L-å·¦å‡º) &lt;--- | queue:1| queue:2| queue:3| --- (R-å³è¿›) â€œå‘å¸ƒ/è®¢é˜…â€æ¨¡å¼â€œå‘å¸ƒ/è®¢é˜…â€æ¨¡å¼åŒ…å«ä¸¤ç§è§’è‰²ï¼Œåˆ†åˆ«æ˜¯å‘å¸ƒè€…å’Œè®¢é˜…è€…ã€‚è®¢é˜…è€…å¯ä»¥è®¢é˜…ä¸€ä¸ªæˆ–å¤šä¸ªé¢‘é“ï¼ˆchannelï¼‰ï¼Œå‘å¸ƒè€…å¯ä»¥å‘æŒ‡å®šçš„é¢‘é“å‘é€æ¶ˆæ¯ï¼Œæ‰€æœ‰è®¢é˜…è¯¥é¢‘é“çš„è®¢é˜…è€…éƒ½ä¼šå—åˆ°æ”¹æ¶ˆæ¯ã€‚ å‘å¸ƒæ¶ˆæ¯ 1PUBLISH channel message //å‘½ä»¤è¿”å›žå€¼è¡¨ç¤ºæŽ¥æ”¶åˆ°è¿™æ¡æ¶ˆæ¯çš„è®¢é˜…è€…çš„æ•°é‡ å‘å¸ƒå‡ºåŽ»çš„æ¶ˆæ¯ä¸ä¼šè¢«æŒä¹…åŒ–ï¼Œä¹Ÿå°±æ˜¯è¯´å½“æœ‰å®¢æˆ·è®¢é˜…è¯¥é¢‘é“ channelåŽåªèƒ½æ”¶åˆ°åŽç»­å‘å¸ƒçš„æ¶ˆæ¯ï¼Œä¹‹å‰å‘é€çš„æ¶ˆæ¯å°±æ”¶ä¸åˆ°äº†ã€‚ è®¢é˜…æ¶ˆæ¯ 1SUBSCRIBE channel [channel ...] æ‰§è¡Œ SUBSCRIBE å‘½ä»¤åŽå®¢æˆ·ç«¯ä¼šè¿›å…¥è®¢é˜…çŠ¶æ€ï¼Œæ­¤çŠ¶æ€ä¸‹çš„å®¢æˆ·ç«¯ä¸èƒ½ä½¿ç”¨ SUBSCRIBE, UNSUBSCRIBE, PSUBSCRIBE å’Œ PUNSUBSCRIBE è¿™4ä¸ªå±žäºŽ â€œå‘å¸ƒ/è®¢é˜…â€æ¨¡å¼çš„å‘½ä»¤ä¹‹å¤–çš„å‘½ä»¤ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚ è¿›å…¥è®¢é˜…çŠ¶æ€åŽçš„å®¢æˆ·ç«¯ï¼Œå¯èƒ½æ”¶åˆ°3ç§ç±»åž‹çš„å›žå¤ï¼Œæ¯ç§ç±»åž‹çš„å›žå¤éƒ½åŒ…æ‹¬3ä¸ªå€¼ã€‚ç¬¬ä¸€ä¸ªå€¼æ˜¯æ¶ˆæ¯ç±»åž‹ï¼Œæ ¹æ®æ¶ˆæ¯ç±»åž‹çš„ä¸åŒï¼Œç¬¬äºŒï¼Œç¬¬ä¸‰ä¸ªå€¼çš„å«ä¹‰ä¹Ÿä¸åŒã€‚æ¶ˆæ¯ç±»åž‹çš„å–å€¼å¯èƒ½æœ‰ä»¥ä¸‹3ä¸ª subscribeã€‚è¡¨ç¤ºè®¢é˜…æ¶ˆæ¯æˆåŠŸçš„åé¦ˆã€‚ç¬¬2ä¸ªå€¼æ˜¯è®¢é˜…æˆåŠŸçš„é¢‘é“åç§°ï¼Œç¬¬3ä¸ªå€¼æ˜¯å½“å‰å®¢æˆ·ç«¯è®¢é˜…çš„é¢‘é“æ•°é‡ messageã€‚è¡¨ç¤ºæŽ¥æ”¶åˆ°çš„æ¶ˆæ¯ã€‚ç¬¬2ä¸ªå‚æ•°è¡¨ç¤ºé¢‘é“åç§°ï¼Œç¬¬3ä¸ªå‚æ•°æ˜¯æ¶ˆæ¯å†…å®¹ unscribeã€‚è¡¨ç¤ºæˆåŠŸå–æ¶ˆè®¢é˜…æŸä¸ªé¢‘é“ã€‚ç¬¬2ä¸ªå‚æ•°è¡¨ç¤ºé¢‘é“åç§°ï¼Œç¬¬3ä¸ªå‚æ•°æ˜¯å½“å‰å®¢æˆ·ç«¯è®¢é˜…çš„é¢‘é“æ•°é‡ï¼Œå½“è¯¥å€¼ä¸º0æ—¶ï¼Œå®¢æˆ·ç«¯ä¼šé€€å‡ºè®¢é˜…çŠ¶æ€ã€‚ ä¸‹é¢çœ‹ä¸€ä¸ªå®žä¾‹ã€‚ é¦–å…ˆRedisçš„ä¸€ä¸ªå®žä¾‹RedisAåœ¨é¢‘é“ channel1.1 å‘å¸ƒä¸€ä¸ªæ¶ˆæ¯ 123//RedisAredisA&gt; PUBLISH channel1.1 hi(integer) 0 //è¡¨ç¤ºå½“å‰æ²¡æœ‰å®¢æˆ·ç«¯è®¢é˜…è¯¥æ¶ˆæ¯ Redisçš„å¦å¤–ä¸€ä¸ªå®žä¾‹RedisB è®¢é˜…é¢‘é“ channel1.1 123456//RedisBredisB&gt; SUBSCRIBE channel1.1Reading messages... (press Ctrl-C to quit)1) "subscribe" //è®¢é˜…æ¶ˆæ¯æˆåŠŸ2) "channel1.1"3) (integer) 1 å®žä¾‹RedisAç»§ç»­åœ¨é¢‘é“ channel1.1 å‘å¸ƒä¸€ä¸ªæ¶ˆæ¯ 123//RedisAredisA&gt; PUBLISH channel1.1 hello(integer) 1 //è¡¨ç¤ºå½“å‰æ²¡æœ‰å®¢æˆ·ç«¯è®¢é˜…è¯¥æ¶ˆæ¯ æ­¤æ—¶ï¼Œå®žä¾‹RedisB ä¼šæ”¶åˆ°å¦‚ä¸‹æ¶ˆæ¯ 1231) "message"2) "channel1.1"3) "hello" æŒ‰ç…§è§„åˆ™è®¢é˜…å¯ä»¥ä½¿ç”¨ PSUBSCRIBE è®¢é˜…æŒ‡å®šçš„è§„åˆ™ï¼Œè§„åˆ™æ”¯æŒ glob é£Žæ ¼é€šé…ç¬¦æ ¼å¼ã€‚ ç¬¦å· å«ä¹‰ ? åŒ¹é…ä¸€ä¸ªå­—ç¬¦ * åŒ¹é…ä»»æ„ä¸ªï¼ˆåŒ…æ‹¬0ä¸ªï¼‰å­—ç¬¦ [] åŒ¹é…æ‹¬å·é—´çš„ä»»ä¸€å­—ç¬¦ï¼Œå¯ä»¥ä½¿ç”¨ - è¡¨ç¤ºä¸€ä¸ªèŒƒå›´ï¼Œå¦‚ [1-9] \x ç”¨äºŽè½¬ä¹‰å­—ç¬¦ ä¾‹å¦‚ PSUBSCRIBE channel1.?*å‘½ä»¤ä¸­ï¼Œè§„åˆ™ channel1.?* å¯ä»¥åŒ¹é… channel1.1 å’Œ channel1.10ï¼Œä½†ä¸ä¼šåŒ¹é… channel1.1ã€‚ ç®¡é“ å®¢æˆ·ç«¯å’ŒRedisä½¿ç”¨TCPåè®®è¿žæŽ¥ã€‚ ä¸è®ºæ˜¯å®¢æˆ·ç«¯å‘Rediså‘é€å‘½ä»¤ï¼Œè¿˜æ˜¯Rediså‘å®¢æˆ·ç«¯è¿”å›žå‘½ä»¤ç»“æžœï¼Œéƒ½éœ€è¦ç»è¿‡ç½‘ç»œä¼ è¾“ã€‚è¿™ä¸¤ä¸ªéƒ¨åˆ†çš„æ€»è€—æ—¶æˆä¸ºå¾€è¿”æ—¶å»¶ã€‚ å¤§è‡´æ¥è¯´ï¼Œåˆ°æœ¬åœ°å›žçŽ¯åœ°å€ï¼ˆloop back addressï¼‰çš„å¾€è¿”æ—¶é—´ï¼Œåœ¨æ•°é‡çº§ä¸Šç›¸å½“äºŽRediså¤„ç†ä¸€æ¡ç®€å•å‘½ä»¤ (å¦‚ LPUSH list 1 2 3) çš„æ—¶é—´ã€‚ Redisçš„åº•å±‚é€šä¿¡åè®®å¯¹ç®¡é“ï¼ˆpipeliningï¼‰æä¾›äº†æ”¯æŒã€‚é€šè¿‡ç®¡é“å¯ä»¥ä¸€æ¬¡æ€§å‘é€å¤šæ¡å‘½ä»¤å¹¶åœ¨æ‰§è¡Œå®ŒåŽä¸€æ¬¡æ€§å°†ç»“æžœè¿”å›žã€‚ å½“ä¸€ç»„å‘½ä»¤ä¸­æ¯æ¡å‘½ä»¤éƒ½ä¸ä¾èµ–äºŽä¹‹å‰å‘½ä»¤çš„æ‰§è¡Œç»“æžœæ—¶å°±å¯ä»¥å°†è¿™ä¸€ç»„å‘½ä»¤ä¸€èµ·é€šè¿‡ç®¡é“å‘å‡ºã€‚ç®¡é“é€šè¿‡å‡å°‘å®¢æˆ·ç«¯å’ŒRedisçš„é€šä¿¡æ¬¡æ•°ï¼Œæ¥å®žçŽ°é™ä½Žå¾€è¿”æ—¶å»¶ç´¯è®¡å€¼çš„ç›®çš„ã€‚ èŠ‚çœç©ºé—´Redisæ˜¯ä¸€ä¸ªåŸºäºŽå†…å­˜çš„æ•°æ®åº“ï¼Œæ‰€æœ‰æ•°æ®éƒ½å­˜å‚¨åœ¨å†…å­˜ä¸­ã€‚å› æ­¤å¦‚ä½•èŠ‚çœå†…å­˜ï¼ŒæŽ§åˆ¶æˆæœ¬ï¼Œè‡³å…³é‡è¦ã€‚èŠ‚çœå†…å­˜ç©ºé—´ï¼Œå¯ä»¥ä»Žä»¥ä¸‹æ–¹é¢è€ƒè™‘ ç²¾ç®€é”®åå’Œé”®å€¼ å†…éƒ¨ç¼–ç ä¼˜åŒ– Redisä¸ºæ¯ç§æ•°æ®ç±»åž‹éƒ½æä¾›äº†2ç§å†…éƒ¨ç¼–ç æ–¹å¼ï¼Œç”¨äºŽèŠ‚çœå†…å­˜ç©ºé—´ã€‚ ä»¥æ•£åˆ—ç±»åž‹ä¸ºä¾‹ï¼Œæ•£åˆ—ç±»åž‹æ˜¯é€šè¿‡æ•£åˆ—è¡¨å®žçŽ°çš„ï¼Œè¿™æ ·å¯ä»¥å®žçŽ°æ—¶é—´å¤æ‚åº¦ O(1) çš„æŸ¥æ‰¾ï¼Œèµ‹å€¼æ“ä½œã€‚ç„¶è€Œå½“å…ƒç´ è¾ƒå°‘æ—¶ï¼ŒO(1)çš„æ“ä½œå¹¶ä¸ä¼šæ¯” O(n) æœ‰æ˜Žæ˜¾çš„æ€§èƒ½æé«˜ã€‚æ‰€ä»¥Redisä¼šæ ¹æ®å®žé™…æƒ…å†µè‡ªåŠ¨è°ƒæ•´ï¼Œé‡‡ç”¨ä¸€ç§æ›´ä¸ºç´§å‡‘ä½†æ€§èƒ½ç¨å·®ï¼ˆæŸ¥æ‰¾å…ƒç´ çš„å¤æ‚åº¦ä¸ºO(n)ï¼‰çš„ç¼–ç æ–¹å¼ã€‚ å†…éƒ¨ç¼–ç æ–¹å¼çš„é€‰æ‹©ï¼Œå¯¹äºŽå¼€å‘è€…æ¥è¯´æ˜¯é€æ˜Žçš„ã€‚ å¯ä»¥ä½¿ç”¨ OBJECT ENCODING key å‘½ä»¤æŸ¥çœ‹æŸä¸ªé”®çš„å†…éƒ¨ç¼–ç æ–¹å¼ã€‚ 1234redis&gt; SET foo barOKredis&gt; OBJECT ENCODING foo"raw" Redis è„šæœ¬Redis è„šæœ¬ä½¿ç”¨ Lua è§£é‡Šå™¨æ¥æ‰§è¡Œè„šæœ¬ã€‚ Redis 2.6 ç‰ˆæœ¬ï¼ˆå’Œä¹‹åŽç‰ˆæœ¬ï¼‰é€šè¿‡å†…åµŒæ”¯æŒ Lua çŽ¯å¢ƒã€‚æ‰§è¡Œè„šæœ¬çš„å¸¸ç”¨å‘½ä»¤ä¸º EVALã€‚ ä½¿ç”¨è„šæœ¬çš„å¥½å¤„åŒ…æ‹¬ å‡å°‘ç½‘ç»œå¼€é”€ï¼šä½¿ç”¨è„šæœ¬å¯ä»¥å°†å¤šä¸ªå‘½ä»¤çš„å¤šæ¬¡è¯·æ±‚ï¼Œé€šè¿‡ä¸€æ¬¡è¯·æ±‚å®Œæˆï¼Œå‡å°‘ç½‘ç»œå¾€è¿”æ—¶å»¶ åŽŸå­æ“ä½œï¼šRediså°†æ•´ä¸ªè„šæœ¬ä½œä¸ºä¸€ä¸ªæ•´ä½“æ‰§è¡Œï¼Œä¸­é—´ä¸ä¼šè¢«å…¶ä»–å‘½ä»¤æ’å…¥ã€‚å³ç¼–å†™è„šæœ¬è¿‡ç¨‹ä¸­æ— éœ€æ‹…å¿ƒä¼šå‡ºçŽ°ç«žæ€æ¡ä»¶ï¼Œä¹Ÿæ— éœ€ä½¿ç”¨äº‹åŠ¡ã€‚äº‹åŠ¡å¯ä»¥å®Œæˆçš„æ‰€æœ‰åŠŸèƒ½éƒ½å¯ä»¥ä½¿ç”¨è„šæœ¬å®žçŽ°ã€‚ å¤ç”¨ï¼šå®¢æˆ·ç«¯å‘é€çš„è„šæœ¬ä¼šæ°¸ä¹…å­˜å‚¨åœ¨Redisä¸­ï¼Œå…¶ä»–å®¢æˆ·ç«¯ä¹Ÿå¯ä»¥å¤ç”¨è¿™ä¸€è„šæœ¬ã€‚ Redis æŒä¹…åŒ–Redis æ”¯æŒ2ç§æ–¹å¼çš„æŒä¹…åŒ– RDB æ–¹å¼ï¼šæ ¹æ®æŒ‡å®šçš„è§„åˆ™â€œå®šæ—¶â€å°†å†…å­˜ä¸­çš„æ•°æ®å­˜å‚¨åœ¨ç¡¬ç›˜ä¸Š AOF æ–¹å¼ï¼šæ¯æ¬¡æ‰§è¡Œå‘½ä»¤åŽå°†å‘½ä»¤æœ¬èº«è®°å½•ä¸‹æ¥ é€šè¿‡ RDB æ–¹å¼å®žçŽ°æŒä¹…åŒ–ï¼Œä¸€æ—¦ Redis å¼‚å¸¸é€€å‡ºï¼Œå°±ä¼šä¸¢å¤±æœ€åŽä¸€æ¬¡å¿«ç…§ä»¥åŽæ›´æ”¹çš„æ‰€æœ‰æ•°æ®ã€‚å¦‚æžœæ•°æ®ç›¸å¯¹é‡è¦ï¼Œå¸Œæœ›æŸå¤±é™åˆ°æœ€å°ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ AOF æ–¹å¼è¿›è¡ŒæŒä¹…åŒ–ã€‚ Redis å…è®¸åŒæ—¶å¼€å¯ RDB å’Œ AOF æ–¹å¼ï¼Œæ—¢ä¿è¯äº†æ•°æ®å®‰å…¨åˆä½¿å¾—è¿›è¡Œå¤‡ä»½ç­‰æ“ä½œååˆ†å®¹æ˜“ã€‚æ­¤æ—¶é‡æ–°å¯åŠ¨ Redis åŽï¼ŒRedis ä¼šä½¿ç”¨ AOF æ–‡ä»¶æ¥æ¢å¤æ•°æ®ï¼Œå› ä¸º AOF æ–¹å¼çš„æŒä¹…åŒ–å¯èƒ½ä¸¢å¤±çš„æ•°æ®æ›´å°‘ã€‚ RDBæ–¹å¼RDB æ–¹å¼çš„æŒä¹…åŒ–æ˜¯é€šè¿‡å¿«ç…§ï¼ˆsnapshotingï¼‰å®Œæˆçš„ï¼Œå½“ç¬¦åˆä¸€å®šæ¡ä»¶æ—¶ Redis ä¼šè‡ªåŠ¨å°†å†…å­˜ä¸­çš„æ‰€æœ‰æ•°æ®ç”Ÿæˆä¸€ä»½å‰¯æœ¬å¹¶å­˜å‚¨åœ¨ç¡¬ç›˜ä¸Šï¼Œè¿™ä¸ªè¿‡ç¨‹å³â€œå¿«ç…§â€ã€‚ å¿«ç…§è§¦å‘æ¡ä»¶Redis ä¼šåœ¨ä»¥ä¸‹å‡ ç§æƒ…å†µä¸‹å¯¹æ•°æ®è¿›è¡Œå¿«ç…§ æ ¹æ®é…ç½®è§„åˆ™è¿›è¡Œè‡ªåŠ¨å¿«ç…§ï¼šæ¯å½“æ—¶é—´çª—å£ M å†…è¢«æ›´æ”¹çš„é”®çš„ä¸ªæ•°å¤§äºŽ N æ—¶ï¼Œå³ç¬¦åˆè‡ªåŠ¨å¿«ç…§æ¡ä»¶ ç”¨æˆ·æ‰§è¡Œ SAVE æˆ– BGSAVE å‘½ä»¤ æ‰§è¡Œ SAVE å‘½ä»¤æ—¶ï¼ŒRedisåŒæ­¥åœ°æ‰§è¡Œå¿«ç…§æ“ä½œã€‚å¿«ç…§æ‰§è¡Œè¿‡ç¨‹ä¸­ä¼šé˜»å¡žæ‰€æœ‰æ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚æ‰€ä»¥åº”è¯¥å°½é‡é¿å…åœ¨ç”Ÿäº§çŽ¯å¢ƒä¸­æ‰§è¡Œè¯¥æŒ‡ä»¤ BGSAVE å‘½ä»¤å¯ä»¥åœ¨åŽå°å¼‚æ­¥åœ°æ‰§è¡Œå¿«ç…§æ“ä½œï¼ŒåŒæ—¶å¯ä»¥å“åº”å®¢æˆ·ç«¯çš„è¯·æ±‚ æ‰§è¡Œ FLUSHALL å‘½ä»¤ FLUSHALL å‘½ä»¤ä¼šæ¸…æ¥šæ•°æ®åº“ä¸­çš„æ‰€æœ‰æ“ä½œ åªè¦è‡ªåŠ¨å¿«ç…§æ¡ä»¶ä¸ä¸ºç©ºï¼ˆå³ä½¿ä¸æ»¡è¶³è¯¥æ¡ä»¶ï¼‰ï¼Œæ‰§è¡Œ FLUSHALL å‘½ä»¤åŽï¼Œä¹Ÿä¼šè§¦å‘å¿«ç…§æ“ä½œ å½“æ²¡æœ‰å®šä¹‰è‡ªåŠ¨å¿«ç…§æ¡ä»¶æ—¶ï¼Œæ‰§è¡Œ FLUSHALL å‘½ä»¤ä¸ä¼šè§¦å‘å¿«ç…§æ“ä½œ æ‰§è¡Œå¤åˆ¶ï¼ˆreplicationï¼‰æ—¶ï¼šè®¾ç½®äº†ä¸»ä»Žæ¨¡å¼æ—¶ï¼ŒRedisä¼šåœ¨å¤åˆ¶åˆå§‹åŒ–æ—¶è¿›è¡Œè‡ªåŠ¨å¿«ç…§ å¿«ç…§åŽŸç†Redis é»˜è®¤ä¼šå°†å¿«ç…§æ–‡ä»¶å­˜å‚¨åœ¨ Redis å½“å‰è¿›ç¨‹çš„å·¥ä½œç›®å½•ç§çš„ dump.rdb æ–‡ä»¶ä¸­ã€‚å¿«ç…§çš„è¿‡ç¨‹å¦‚ä¸‹ Redis ä½¿ç”¨ fork å‡½æ•°å¤åˆ¶ä¸€ä»½å½“å‰è¿›ç¨‹ï¼ˆçˆ¶è¿›ç¨‹ï¼‰çš„å‰¯æœ¬ï¼ˆå­è¿›ç¨‹ï¼‰ çˆ¶è¿›ç¨‹ç»§ç»­æŽ¥æ”¶å¹¶å¤„ç†å®¢æˆ·ç«¯å‘æ¥çš„å‘½ä»¤ï¼Œè€Œå­è¿›ç¨‹å¼€å§‹å°†å†…å­˜ä¸­çš„æ•°æ®å†™å…¥ç¡¬ç›˜ä¸­çš„ä¸´æ—¶æ–‡ä»¶ å½“å­è¿›ç¨‹å†™å…¥å®Œæˆæ‰€æœ‰æ•°æ®åŽä¼šç”¨è¯¥ä¸´æ—¶æ–‡ä»¶æ›¿æ¢æ—§çš„ RDB æ–‡ä»¶ï¼Œè‡³æ­¤ä¸€æ¬¡å¿«ç…§æ“ä½œå®Œæˆã€‚ AOFæ–¹å¼AOF(append only file) æ–¹å¼å¯ä»¥å°† Redis æ‰§è¡Œçš„æ¯ä¸€æ¡å‘½å†™å‘½ä»¤è¿½åŠ åˆ°ç¡¬ç›˜æ–‡ä»¶ä¸­ï¼Œè¿™ä¸€è¿‡ç¨‹æ˜¾ç„¶ä¼šé™ä½Ž Redis æ€§èƒ½ã€‚ä½†å¤§éƒ¨åˆ†æƒ…å†µä¸‹è¿™ä¸ªå½±å“æ˜¯å¯ä»¥æŽ¥æ”¶çš„ï¼Œå¦å¤–ä½¿ç”¨è¾ƒå¿«çš„ç¡¬ç›˜å¯ä»¥æé«˜ AOF çš„æ€§èƒ½ã€‚ å¼€å¯AOF é»˜è®¤æƒ…å†µä¸‹æ²¡æœ‰å¼€å¯AOFï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å¯ä»¥å¼€å¯AOFã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒAOFæ–‡ä»¶çš„ä¿å­˜ä½ç½®å’ŒRDBæ–‡ä»¶çš„ä½ç½®ç›¸åŒï¼Œé»˜è®¤çš„æ–‡ä»¶åæ˜¯ appendonly.aofã€‚ 1appendonly yes AOFçš„å®žçŽ° AOF æ–‡ä»¶çš„å†…å®¹æ­£æ˜¯Rediså®¢æˆ·ç«¯å‘Rediså‘é€çš„åŽŸå§‹é€šä¿¡åè®®çš„å†…å®¹ã€‚ åŒæ­¥ç¡¬ç›˜æ•°æ® ç”±äºŽæ“ä½œç³»ç»Ÿçš„ç¼“å­˜æœºåˆ¶ï¼ŒAOFæ–‡ä»¶æ•°æ®å¹¶æ²¡æœ‰ç›´æŽ¥çœŸæ­£åœ°å†™å…¥ç¡¬ç›˜ï¼Œè€Œæ˜¯è¿›å…¥äº†ç³»ç»Ÿçš„ç¡¬ç›˜ç¼“å­˜ã€‚åœ¨é»˜è®¤æƒ…å†µä¸‹ç³»ç»Ÿæ¯ 30 ç§’ä¼šæ‰§è¡Œä¸€æ¬¡åŒæ­¥æ“ä½œï¼Œä»¥ä¾¿å°†ç¡¬ç›˜ç¼“å­˜ä¸­çš„å†…å®¹çœŸæ­£åœ°å†™å…¥ç¡¬ç›˜ã€‚åœ¨è¿™30ç§’å†…ï¼Œå¦‚æžœç³»ç»Ÿå¼‚å¸¸é€€å‡ºåˆ™ä¼šå¯¼è‡´ç¡¬ç›˜ç¼“å­˜ä¸­çš„æ•°æ®ä¸¢å¤±ã€‚ ä¸€èˆ¬æ¥è®²ï¼Œå¯ç”¨AOFæŒä¹…åŒ–çš„åº”ç”¨éƒ½æ— æ³•å®¹å¿è¿™æ ·çš„æŸå¤±ã€‚è¿™å°±éœ€è¦ Redis åœ¨å†™å…¥AOF æ–‡ä»¶åŽä¸»åŠ¨è¦æ±‚ç³»ç»Ÿå°†ç¡¬ç›˜ç¼“å­˜å†…å®¹åŒæ­¥åˆ°ç¡¬ç›˜ä¸­ã€‚åœ¨ Redis ä¸­ï¼Œå¯ä»¥é€šè¿‡ appendfsync å‚æ•°è®¾ç½®åŒæ­¥çš„æ—¶æœº 123# appendfsync alwaysappendfsync everysec //é»˜è®¤# appendfsync no //ä¸ä¸»åŠ¨è¿›è¡ŒåŒæ­¥æ“ä½œï¼Œå³äº¤ç”±æ“ä½œç³»ç»Ÿå¤„ç†ï¼ˆæ¯30ç§’åŒæ­¥ä¸€æ¬¡ï¼‰ é›†ç¾¤åŒæ—¶æ‹¥æœ‰å¤šä¸ª Redis æœåŠ¡å™¨åŽï¼Œå°±ä¼šé¢ä¸´å¦‚æžœç®¡ç†é›†ç¾¤çš„é—®é¢˜ï¼ŒåŒ…æ‹¬å¦‚ä½•å¢žåŠ èŠ‚ç‚¹ï¼Œæ•…éšœæ¢å¤ç­‰æ“ä½œã€‚ å¤åˆ¶ replicationä¸ºäº†é¿å…å•ç‚¹æ•…éšœï¼Œé€šå¸¸çš„åšæ³•æ˜¯å°†æ•°æ®åº“å¤åˆ¶å¤šä¸ªå‰¯æœ¬ä»¥éƒ¨ç½²åœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸Šã€‚ä¸ºæ­¤ï¼ŒRedisæä¾›äº†å¤åˆ¶ replication åŠŸèƒ½ï¼Œå¯ä»¥å®žçŽ°å½“ä¸€å°æ•°æ®åº“ä¸­çš„æ•°æ®æ›´æ–°åŽï¼Œè‡ªåŠ¨å°†æ›´æ–°çš„æ•°æ®åŒæ­¥åˆ°å…¶ä»–æ•°æ®åº“ä¸­ã€‚ é…ç½®åœ¨å¤åˆ¶çš„æ¦‚å¿µä¸­ï¼Œæ•°æ®åº“åˆ†ä¸º2ç§ ä¸»æ•°æ®åº“ï¼ˆmasterï¼‰ï¼šå¯ä»¥è¿›è¡Œè¯»å†™æ“ä½œï¼Œå½“å†™æ“ä½œå¯¼è‡´æ•°æ®å˜åŒ–æ—¶ä¼šè‡ªåŠ¨å°†æ•°æ®åŒæ­¥ç»™ä»Žæ•°æ®åº“ ä»Žæ•°æ®åº“ ï¼ˆslaveï¼‰ï¼šä¸€èˆ¬æ˜¯åªè¯»çš„ï¼ˆä¹Ÿå¯ä»¥é…ç½®ä¸ºå¯å†™å…¥ï¼‰ï¼Œå¹¶æŽ¥å—ä¸»æ•°æ®åº“åŒæ­¥è¿‡æ¥çš„æ•°æ® Redisä¸­ï¼Œåªéœ€è¦åœ¨ä»Žæ•°æ®åº“é…ç½®æ–‡ä»¶ä¸­åŠ å…¥å¦‚ä¸‹é…ç½®ï¼Œå³å¯å®Œæˆå¤åˆ¶æ“ä½œï¼Œä¸»æ•°æ®åº“ä¸éœ€è¦ä»»ä½•é…ç½®ã€‚ 1salveof ä¸»æ•°æ®åº“åœ°å€ ä¸»æ•°æ®åº“ç«¯å£ ç¤ºä¾‹ å¯åŠ¨ä¸€ä¸ªRediså®žä¾‹ä½œä¸ºä¸»æ•°æ®åº“ï¼Œé»˜è®¤ç«¯å£å·æ˜¯6379 1$redis-server //é»˜è®¤ç«¯å£å·æ˜¯6379 å¯åŠ¨å¦ä¸€ä¸ªRediså®žä¾‹ä½œä¸ºä»Žæ•°æ®åº“ï¼Œç›‘å¬ç«¯å£å· 6380 1$redis-server --port 6380 --slaveof 127.0.0.1 6379 æ­¤æ—¶ä¸»æ•°æ®åº“ä¸­ä»»ä½•æ•°æ®å˜åŒ–ï¼Œéƒ½ä¼šè‡ªåŠ¨åŒæ­¥åˆ°ä»Žæ•°æ®åº“ä¸­ã€‚ æ‰“å¼€ redis-cli å®žä¾‹Aå¹¶è¿žæŽ¥åˆ°ä¸»æ•°æ®åº“ã€‚å†æ‰“å¼€ redis-cli å®žä¾‹Bå¹¶è¿žæŽ¥åˆ°ä»Žæ•°æ®åº“ 12345$redis-cli -p 6379127.0.0.1:6379&gt;$redis-cli -p 6380127.0.0.1:6380&gt; ä½¿ç”¨ INFO replication å‘½ä»¤åœ¨å®žä¾‹Aå’Œå®žä¾‹Bä¸­æŸ¥çœ‹å¤åˆ¶ç›¸å…³çš„ä¿¡æ¯ 123456127.0.0.1:6379&gt; INFO replication# Replicationrole:masterconnected_slaves:1slave0:ip=127.0.0.1,port=6380,state=online,offset=336,lag=1//... å¯ä»¥çœ‹åˆ°ï¼Œå®žä¾‹Açš„è§’è‰²æ˜¯ä¸»æ•°æ®åº“ï¼Œå…¶å·²è¿žæŽ¥çš„ä»Žæ•°æ®åº“çš„ä¸ªæ•°æ˜¯1ã€‚ 12345127.0.0.1:6380&gt; INFO replication# Replicationrole:slavemaster_host:127.0.0.1master_port:6379 å¯ä»¥çœ‹åˆ°ï¼Œå®žä¾‹Bçš„è§’è‰²æ˜¯ä»Žæ•°æ®åº“ã€‚ åœ¨ä¸»æ•°æ®åº“ä¸­æ·»åŠ é”®å€¼ï¼Œå¯ä»¥åœ¨ä»Žæ•°æ®åº“ä¸­è¯»å– 123# ä¸»æ•°æ®åº“å†™å…¥127.0.0.1:6379&gt; SET foo barOK 123# ä»Žæ•°æ®åº“è¯»å–127.0.0.1:6380&gt; GET foo"bar" å›¾ç»“æž„ä»Žæ•°æ®åº“ä¸ä»…å¯ä»¥æŽ¥å—ä¸»æ•°æ®åº“çš„åŒæ­¥æ•°æ®ï¼Œè‡ªå·±ä¹Ÿå¯ä»¥åŒæ—¶ä½œä¸ºä¸»æ•°æ®åº“å­˜åœ¨ï¼Œå½¢æˆç±»ä¼¼å›¾çš„ç»“æž„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ ä¸»æ•°æ®Açš„æ•°æ®ä¼šåŒæ­¥åˆ°Bå’ŒCï¼Œè€ŒBä¸­çš„æ•°æ®ä¼šåŒæ­¥åˆ°Då’ŒEä¸­ã€‚å‘Bä¸­å†™å…¥çš„æ•°æ®ä¸ä¼šåŒæ­¥åˆ°Aæˆ–Cä¸­ã€‚ 1234567graph TBA[ä¸»æ•°æ®åº“A]--&gt;B[ä»Žæ•°æ®åº“B]A[ä¸»æ•°æ®åº“A]--&gt;C[ä»Žæ•°æ®åº“C]B[ä»Žæ•°æ®åº“B]--&gt;D[ä»Žæ•°æ®åº“D]B[ä»Žæ•°æ®åº“B]--&gt;E[ä»Žæ•°æ®åº“E] å“¨å…µé¢ä¸´çš„é—®é¢˜ä¸ºäº†æé«˜æ€§èƒ½ï¼Œå¯ä»¥é€šè¿‡å¤åˆ¶åŠŸèƒ½å»ºç«‹è‹¥å¹²ä¸ªä»Žæ•°æ®åº“ï¼Œå¹¶åœ¨ä»Žæ•°æ®åº“ä¸­å¯ç”¨æŒä¹…åŒ–ï¼ŒåŒæ—¶åœ¨ä¸»æ•°æ®ä¸­ç¦ç”¨æŒä¹…åŒ–ã€‚è¿™æ ·å¯ä»¥ä¿è¯ä¸»æ•°æ®åº“çš„æ€§èƒ½ã€‚ å½“ä»Žæ•°æ®åº“å´©æºƒé‡å¯åŽï¼Œä¸»æ•°æ®åº“ä¼šè‡ªåŠ¨å°†æ•°æ®åŒæ­¥è¿‡æ¥ï¼Œæ‰€ä»¥æ— éœ€æ‹…å¿ƒæ•°æ®ä¸¢å¤± å½“ä¸»æ•°æ®åº“å´©æºƒåŽï¼Œæƒ…å†µå°±æ¯”è¾ƒå¤æ‚äº†ã€‚æ‰‹åŠ¨é€šè¿‡ä»Žæ•°æ®åº“æ¢å¤ä¸»æ•°æ®åº“æ•°æ®æ—¶ï¼Œéœ€è¦ä¸¥æ ¼æ‰§è¡Œå¦‚ä¸‹2æ­¥ åœ¨ä»Žæ•°æ®åº“ä¸­ä½¿ç”¨ SLAVE NO ONE å‘½ä»¤å°†ä»Žæ•°æ®åº“æå‡ä¸ºä¸»æ•°æ®åº“ç»§ç»­æœåŠ¡ å¯åŠ¨ä¹‹å‰å´©æºƒçš„ä¸»æ•°æ®åº“ï¼Œç„¶åŽä½¿ç”¨ SLAVEOF å‘½ä»¤å°†å…¶è®¾ç½®æˆæ–°çš„ä¸»æ•°æ®åº“çš„ä»Žæ•°æ®åº“ï¼Œå³å¯å°†æ•°æ®åŒæ­¥å›žæ¥ å¯è§ï¼Œæ‰‹åŠ¨ç»´æŠ¤ä¸»ä»Žæ•°æ®åº“å´©æºƒåŽçš„æ•°æ®æ¢å¤æ˜¯ç›¸å½“éº»çƒ¦çš„ã€‚Redisæä¾›äº†ä¸€ç§è‡ªåŠ¨åŒ–æ–¹æ¡ˆâ€”â€”å“¨å…µï¼Œé¿å…äº†æ‰‹å·¥ç»´æŠ¤çš„éº»çƒ¦å’Œå®¹æ˜“å‡ºé”™çš„é—®é¢˜ã€‚ å“¨å…µçš„åŠŸèƒ½Redis 2.8ä¸­æä¾›äº†å“¨å…µå·¥å…·æ¥å®žçŽ°è‡ªåŠ¨åŒ–çš„ç³»ç»Ÿç›‘æŽ§å’Œæ•…éšœæ¢å¤åŠŸèƒ½ã€‚ å“¨å…µçš„ä½œç”¨å°±æ˜¯ç›‘æŽ§ Redis ç³»ç»Ÿçš„è¿è¡ŒçŠ¶å†µï¼Œå®ƒçš„åŠŸèƒ½åŒ…æ‹¬2ä¸ª ç›‘æŽ§ä¸»æ•°æ®åº“å’Œä»Žæ•°æ®åº“æ˜¯å¦æ­£å¸¸å·¥ä½œ ä¸»æ•°æ®åº“å‡ºçŽ°æ•…éšœæ—¶è‡ªåŠ¨å°†ä»Žæ•°æ®åº“è½¬æ¢ä¸ºä¸»æ•°æ®åº“ å“¨å…µæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„è¿›ç¨‹ï¼Œä½¿ç”¨å“¨å…µçš„ä¸€ä¸ªå…¸åž‹æž¶æž„å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚è™šçº¿è¡¨ç¤ºä¸»ä»Žå¤åˆ¶å…³ç³»ï¼Œå®žçº¿è¡¨ç¤ºå“¨å…µçš„ç›‘æŽ§è·¯å¾„ã€‚ åœ¨ä¸€ä¸ªä¸€ä¸»å¤šä»Žçš„Redisç³»ç»Ÿä¸­ï¼Œå¯ä»¥ä½¿ç”¨å¤šä¸ªå“¨å…µè¿›è¡Œç›‘æŽ§ä»»åŠ¡ä»¥ä¿è¯ç³»ç»Ÿæ˜¯è¶³å¤Ÿç¨³å¥çš„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚æ­¤æ—¶ä¸ä»…å“¨å…µä¼šåŒæ—¶ç›‘æŽ§ä¸»ä»Žæ•°æ®åº“ï¼Œå“¨å…µä¹‹é—´ä¹Ÿä¼šäº’ç›¸ç›‘æŽ§ã€‚ ä½¿ç”¨å“¨å…µ åˆ›å»ºå“¨å…µé…ç½®æ–‡ä»¶ï¼Œå¦‚ sentinel.conf 123# sentinel monitor master-name ip redis-port quorumsentinel monitor mymaster 127.0.0.1 6379 1 å…¶ä¸­ï¼Œmymaster æ˜¯è¦ç›‘æŽ§çš„ä¸»æ•°æ®åº“çš„åç§°ï¼Œå¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªã€‚åŽé¢çš„å‚æ•°æ˜¯æ•°æ®åº“çš„IPåœ°å€å’Œç«¯å£å·ã€‚ æœ€åŽçš„å‚æ•° 1 è¡¨ç¤ºæœ€ä½Žé€šè¿‡ç¥¨æ•°ï¼ˆquorumï¼‰ï¼Œå³æ‰§è¡Œæ•…éšœæ¢å¤æ“ä½œå‰è‡³å°‘éœ€è¦å‡ ä¸ªå“¨å…µèŠ‚ç‚¹åŒæ„ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå– quorum çš„å€¼ä¸º N/2 + 1ï¼Œå…¶ä¸­ N è¡¨ç¤ºå“¨å…µæ•°ç›®ï¼Œå³åªæœ‰è¶…è¿‡ä¸€åŠçš„å“¨å…µåŒæ„åŽæ‰ä¼šè¿›è¡Œæ•…éšœæ¢å¤ã€‚ å¯åŠ¨å“¨å…µè¿›ç¨‹ï¼Œå¹¶å°†ä¸Šè¿°é…ç½®æ–‡ä»¶çš„è·¯å¾„ä¼ é€’ç»™å“¨å…µ 1$redis-sentinel /path/to/sentinel.conf éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œé…ç½®å“¨å…µç›‘æŽ§ä¸€ä¸ªç³»ç»Ÿæ—¶ï¼Œåªéœ€è¦é…ç½®å…¶ç›‘æŽ§ä¸»æ•°æ®åº“å³å¯ï¼Œå“¨å…µä¼šè‡ªåŠ¨å‘çŽ°æ‰€æœ‰å¤åˆ¶è¯¥ä¸»æ•°æ®åº“çš„ä»Žæ•°æ®åº“ã€‚ é›†ç¾¤Redis 3.0ç‰ˆæœ¬æä¾›äº†é›†ç¾¤ï¼ˆClusterï¼‰ç‰¹æ€§ã€‚é›†ç¾¤çš„ç‰¹ç‚¹åœ¨äºŽæ‹¥æœ‰å’Œå•æœºå®žä¾‹åŒæ ·çš„æ€§èƒ½ï¼ŒåŒæ—¶åœ¨ç½‘ç»œåˆ†åŒºåŽèƒ½å¤Ÿæä¾›ä¸€å®šçš„å¯è®¿é—®æ€§ä»¥åŠå¯¹ä¸»æ•°æ®åº“æ•…éšœæ¢å¤çš„æ”¯æŒã€‚]]></content>
      <categories>
        <category>Back-End</category>
      </categories>
      <tags>
        <tag>Back-End</tag>
        <tag>DataBase</tag>
        <tag>Redis</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[LeetCode Notes-000-Overview]]></title>
    <url>%2F2020%2F01%2F12%2Fleetcode-otes-000-overview%2F</url>
    <content type="text"><![CDATA[è®°å½•LeetCodeé¢˜ç›®ç¬”è®°ï¼Œæ±‡æ€»LeetCodeè§£ç­”è®°å½• Changelog 2019/02/13ï¼Œæ’°å†™ 2019/06/16ï¼Œæ·»åŠ  LeetCode Notes-1 2020/01/05ï¼Œæ·»åŠ  LeetCode Notes-2 å­¦ä¹ èµ„æ–™æ±‡æ€» leetcode leetcode-cn ç‰›å®¢ç½‘ AlgorithmShare @ JD LeetCodeAnimation Leetcode Solution | github é¢˜è§£è®°å½•æ¨¡æ¿123456789101112131415## XXX### Description* [LeetCode-XX. XXX]()### Approach 1-XX#### Analysis#### Solution* Java* C++* Python* JS åˆ†ç±»æ±‡æ€»é“¾è¡¨ LeetCode- 141. Linked List Cycle - çŽ¯å½¢é“¾è¡¨ LeetCode- 142. Linked List Cycle II - çŽ¯å½¢é“¾è¡¨ å¿«æ…¢æŒ‡é’ˆ LeetCode- 141. Linked List Cycle - çŽ¯å½¢é“¾è¡¨ LeetCode- 142. Linked List Cycle II - çŽ¯å½¢é“¾è¡¨ æ•°ç»„ LeetCode - 463. Island Perimeter - å¸¸è§„è®¡ç®— PopCountï¼ˆæ±‰æ˜Žè·ç¦»ï¼‰ LeetCode-191. Number of 1 Bits LeetCode-338. Counting Bits å›žæ–‡ä¸² LeetCode-409. Longest Palindrome åŠ¨æ€è§„åˆ’ LeetCode-338. Counting Bits æ–‡æ¡£ç›®å½•Notes-1 LeetCode-141. Linked List Cycle - çŽ¯å½¢é“¾è¡¨ LeetCode-142. Linked List Cycle II - çŽ¯å½¢é“¾è¡¨ LeetCode-258. Add Digits - æ•°å­—æŽ¨å¯¼ï¼ˆæ•°å­—æ ¹ï¼‰ LeetCode-461. Hamming Distance - ä½è¿ç®— LeetCode-463. Island Perimeter - å¸¸è§„è®¡ç®— Notes-2 LeetCode-206. Reverse Linked List - é“¾è¡¨æ“ä½œ LeetCode-617. Merge Two Binary Trees - äºŒå‰æ ‘ LeetCode-104. Maximum Depth of Binary Tree - éåŽ†äºŒå‰æ ‘ LeetCode-1290. Convert Binary Number in a Linked List to Integer LeetCode-709. To Lower Case]]></content>
      <categories>
        <category>LeetCode</category>
      </categories>
      <tags>
        <tag>LeetCode</tag>
        <tag>Algorithm</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[React Native å®žçŽ°ä¸‹æ‹‰è‡ªåŠ¨åˆ‡æ¢åˆ†ç±»]]></title>
    <url>%2F2019%2F06%2F08%2Frn-tab-auto-change%2F</url>
    <content type="text"><![CDATA[è®°å½• React Native ä¸­å¦‚ä½•å®žçŽ°ä¸‹æ‹‰è‡ªåŠ¨åˆ‡æ¢åˆ†ç±» é’ˆå¯¹ IOS å’Œ Android å¹³å°å·®å¼‚ï¼Œç»™å‡ºä¸åŒçš„åˆ‡æ¢åˆ†ç±»è§¦å‘æ¡ä»¶ éœ€æ±‚æè¿°å¦‚å›¾æ‰€ç¤ºï¼Œæ•´ä½“ä¸º FlatListï¼Œé¡¶éƒ¨åˆ†ç±»æ å¸é¡¶ï¼Œåº•éƒ¨ä¸º feed æµã€‚è¦å®žçŽ°ä¸‹æ‹‰å•†å“åˆ—è¡¨åˆ°åº•åŽï¼Œç»§ç»­ä¸‹æ‹‰ï¼Œè‡ªåŠ¨åˆ‡æ¢åˆ°ä¸€ä¸‹ä¸ªåˆ†ç±»çš„æ•ˆæžœã€‚ å®žçŽ°åŽŸç†ä»£ç å±‚é¢ï¼Œå¯ä»¥åœ¨ FlatList çš„ onScrollEndDrag ä¸­æ·»åŠ è‡ªåŠ¨ Tab åˆ‡æ¢å‡½æ•°ï¼Œå€ŸåŠ© FlatList å®žä¾‹çš„å†…å®¹åŒºé«˜åº¦ contentLengthï¼Œæ»‘åŠ¨åç§»é‡ offset å’Œå¯è§†åŒºé«˜åº¦ visibleLength ä¸‰è€…å…³ç³»ï¼Œå®žçŽ°ä¸‹æ‹‰è‡ªåŠ¨åˆ‡æ¢TabåŠŸèƒ½ã€‚ ä»£ç å®žçŽ°IOS å¹³å°å®žçŽ°1234567891011121314151617181920212223242526272829//é¡µé¢å¸ƒå±€ç›¸å…³ &lt;FlatList data = &#123;[&#123;banner:[]&#125;,&#123;tab:[]&#125;,&#123;goodList:[]&#125;]&#125; renderItem=&#123;this.renderItem&#125; stickyHeaderIndices=&#123;(Platform.OS !== 'web')?[1]:null&#125; ListFooterComponent=&#123;this._renderFooter&#125; onScroll=&#123;this._onScroll&#125; //æ»‘åŠ¨ç›‘å¬ ref=&#123;this._setScrollRef&#125; keyExtractor = &#123;(item, index) =&gt; &#123; `hScrollView-$&#123;index&#125;` &#125;&#125; refreshing=&#123;this.state.isRefreshing&#125; onRefresh=&#123;this._onRefresh.bind(this)&#125; //ä¸‹æ‹‰åˆ·æ–° getItemLayout=&#123;(data, index) =&gt; ( &#123;length: 305, offset: 305 * index, index&#125; )&#125; onScrollEndDrag = &#123;()=&gt;&#123; //æ»‘åŠ¨åˆ°åº•ç›‘å¬å‡½æ•° if(Platform.OS != 'web')&#123; this._onScrollEndDragFun(); &#125; &#125;&#125;/&gt;/** * èŽ·å–flatList å®žä¾‹ * @param ref * @private */_setScrollRef = (ref) =&gt; &#123; this._secondGoodFlatListRef = ref;&#125;; 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354import isEmpty from "lodash/isEmpty";import &#123;Platform&#125; from "react-native";import &#123;JDDevice&#125; from "@jdreact/jdreact-core-lib";/** * åº•éƒ¨åˆ—è¡¨é¡µæ»‘åŠ¨äº‹ä»¶ å®žçŽ°ä¸Šæ‹‰åˆ‡æ¢å“ç±»åŠŸèƒ½ * @param e * @private */_onScrollEndDragFun = (e) =&gt; &#123; let scrollMetrics = (this._secondGoodFlatListRef &amp;&amp; this._secondGoodFlatListRef._listRef &amp;&amp; this._secondGoodFlatListRef._listRef._scrollMetrics) || null; let &#123;contentLength = 0, offset = 0, visibleLength = 0&#125; = scrollMetrics; // console.log('===scrollMetrics',scrollMetrics); // //åˆ¤æ–­æ˜¯å¦æœ€åŽä¸€Tab å¦‚æžœæ˜¯å°±ä¸å´æ¢ä¸‹ä¸ªç›®å½• // console.log('===this.props',this.props); // console.log('===this.state',this.state); if (contentLength &amp;&amp; offset &amp;&amp; visibleLength) &#123; let &#123;selectedIndex = 0&#125; = this.state; //å½“å‰é€‰ä¸­çš„ä¸‰çº§åˆ†ç±»index let &#123;tabListData = []&#125; = this.props; if (!isEmpty(tabListData) &amp;&amp; (selectedIndex + 1) &lt; tabListData.length) &#123; //æŽ’é™¤æœ€åŽä¸€ä¸ªåˆ†ç±» let item = tabListData[selectedIndex + 1]; if (Platform.OS === 'ios') &#123; //IOS ç³»ç»Ÿå­˜åœ¨å¼¹æ€§ä¸Šæ‹‰ if (offset + visibleLength &gt; contentLength + JDDevice.getRpx(100)) &#123; this._secondGoodFlatListRef.scrollToIndex(&#123; animated: false, index: 0, viewOffset: 1, viewPosition: 0 &#125;); this.ItemCategory._clickCategoryTab2 &amp;&amp; this.ItemCategory._clickCategoryTab2(item, selectedIndex + 1); &#125; &#125; else &#123; //android æ— å¼¹æ€§æ»‘åŠ¨ï¼Œæ»‘åŠ¨åˆ°åº•æ—¶ï¼Œoffset + visibleLength = contentLengthã€‚IOSæœ‰å¼¹æ€§æ»‘åŠ¨ï¼Œéœ€è¦æ”¹å˜åˆ¤æ–­æ¡ä»¶ lbs 2019-03-10 if (offset + visibleLength &gt; contentLength - JDDevice.getRpx(10)) &#123; this._secondGoodFlatListRef.scrollToIndex(&#123; animated: false, index: 0, viewOffset: 1, viewPosition: 0 &#125;); this.ItemCategory._clickCategoryTab2 &amp;&amp; this.ItemCategory._clickCategoryTab2(item, selectedIndex + 1); &#125; &#125; &#125; &#125;&#125;; å…¶ä¸­ï¼ŒcontentLength ä¸ºå†…å®¹åŒºé«˜åº¦ï¼Œoffset ä¸ºæ»‘åŠ¨åç§»é‡ï¼ŒvisibleLength ä¸ºå¯è§†åŒºé«˜åº¦ã€‚ å…³äºŽä¸‰ç§é«˜åº¦å®šä¹‰ï¼Œå¯å‚è€ƒ React Nativeä¸­ListViewå’ŒScrollViewå®žçŽ°ä¸Šæ‹‰åŠ è½½ 12345678let scrollMetrics = (this._secondGoodFlatListRef &amp;&amp; this._secondGoodFlatListRef._listRef &amp;&amp; this._secondGoodFlatListRef._listRef._scrollMetrics) || null;let &#123; contentLength = 0, // å†…å®¹åŒºé«˜åº¦ offset = 0, // æ»‘åŠ¨åç§»é‡ visibleLength = 0 // å¯è§†åŒºé«˜åº¦&#125; = scrollMetrics; Android å¹³å°å®žçŽ°å¯¹äºŽ Android å¹³å°ï¼Œå½“ offset + visibleLength = contentLength æ—¶ï¼Œè¡¨ç¤ºæ»‘åŠ¨åˆ°åº•éƒ¨ã€‚ä¸ºäº†ä»¥å‰è¿›è¡Œåˆ‡æ¢ï¼Œå¯¹æ¡ä»¶è¿›è¡Œä¿®æ­£ï¼Œå½“æ»‘åŠ¨åˆ°è·ç¦»åº•éƒ¨ 10px æ—¶ï¼Œè§¦å‘åˆ‡æ¢ Tab å‡½æ•°ï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤º 1234567891011//android æ— å¼¹æ€§æ»‘åŠ¨ï¼Œæ»‘åŠ¨åˆ°åº•æ—¶ï¼Œoffset + visibleLength = contentLengthã€‚IOSæœ‰å¼¹æ€§æ»‘åŠ¨ï¼Œéœ€è¦æ”¹å˜åˆ¤æ–­æ¡ä»¶ lbs 2019-03-10if (offset + visibleLength &gt; contentLength - JDDevice.getRpx(10)) &#123; this._secondGoodFlatListRef.scrollToIndex(&#123; animated: false, index: 0, viewOffset: 1, viewPosition: 0 &#125;); //åˆ‡æ¢Tab this.ItemCategory._clickCategoryTab2 &amp;&amp; this.ItemCategory._clickCategoryTab2(item, selectedIndex + 1);&#125; å¯¹äºŽ IOS å¹³å°ï¼Œå› ä¸º IOS ç³»ç»Ÿå­˜åœ¨å¼¹æ€§ä¸Šæ‹‰ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚å› æ­¤å¯¹æ»‘åŠ¨åˆ°åº•æ¡ä»¶ä¿®æ­£ä¸º offset + visibleLength &gt; contentLength + JDDevice.getRpx(100)ã€‚ å…¶ä¸­ï¼ŒJDDevice.getRpx(100) è¡¨ç¤ºå¼¹æ€§ä¸Šæ‹‰çš„é«˜åº¦ï¼Œå³ä¸‹å›¾ä¸­çº¢è‰²æ¡†çš„é«˜åº¦ã€‚ 1234567891011if (Platform.OS === 'ios') &#123; if (offset + visibleLength &gt; contentLength + JDDevice.getRpx(100)) &#123; this._secondGoodFlatListRef.scrollToIndex(&#123; animated: false, index: 0, viewOffset: 1, viewPosition: 0 &#125;); this.ItemCategory._clickCategoryTab2 &amp;&amp; this.ItemCategory._clickCategoryTab2(item, selectedIndex + 1); &#125;&#125;]]></content>
      <categories>
        <category>React Native</category>
      </categories>
      <tags>
        <tag>React Native</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JSæ¨¡å—åŒ–â€”â€”CommonJS AMD CMD ES6 Module]]></title>
    <url>%2F2019%2F03%2F28%2Fjs-module-introduce%2F</url>
    <content type="text"><![CDATA[å¯¹ JS å¸¸è§çš„æ¨¡å—åŒ–æ–¹æ¡ˆè¿›è¡Œä»‹ç»å’Œæ¯”è¾ƒâ€”â€”CommonJS AMD CMD ES6 Module å¯¹ ES6 Module å’Œ CommonJS çš„å·®å¼‚è¿›è¡Œå¯¹æ¯”ï¼Œä»‹ç»å¾ªçŽ¯ä¾èµ–å’ŒåŠ¨æ€ import() æ›´æ–°æ—¥å¿— 2018/05/08ï¼Œæ’°å†™ 2019/03/27ï¼Œå†…å®¹æ•´ç† 2019/04/01ï¼ŒåŠ¨æ€ import() å’Œåšæ–‡å‘è¡¨ å‚è€ƒèµ„æ–™ AMD, CMD, CommonJSå’ŒUMD | Segmentfault JSæ¨¡å—åŒ–åŠ è½½ä¹‹CommonJSã€AMDã€CMDã€ES6 ES6 moduleçš„åŠ è½½å’Œå®žçŽ° | é˜®ä¸€å³° å‰ç«¯æ¨¡å—åŒ–å¼€å‘æ–¹æ¡ˆå°å¯¹æ¯” æ¨¡å—åŒ–å¼€å‘ä¼˜ç‚¹ æ¨¡å—åŒ–å¼€å‘ä¸­ï¼Œé€šå¸¸ä¸€ä¸ªæ–‡ä»¶å°±æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œæœ‰è‡ªå·±çš„ä½œç”¨åŸŸï¼Œåªå‘å¤–æš´éœ²ç‰¹å®šçš„å˜é‡å’Œå‡½æ•°ï¼Œå¹¶ä¸”å¯ä»¥æŒ‰éœ€åŠ è½½ã€‚ ä¾èµ–è‡ªåŠ¨åŠ è½½ï¼ŒæŒ‰éœ€åŠ è½½ã€‚ æé«˜ä»£ç å¤ç”¨çŽ‡ï¼Œæ–¹ä¾¿è¿›è¡Œä»£ç çš„ç®¡ç†ï¼Œä½¿å¾—ä»£ç ç®¡ç†æ›´åŠ æ¸…æ™°ã€è§„èŒƒã€‚ å‡å°‘äº†å‘½åå†²çªï¼Œæ¶ˆé™¤å…¨å±€å˜é‡ã€‚ ç›®å‰æµè¡Œçš„jsæ¨¡å—åŒ–è§„èŒƒæœ‰CommonJSã€AMDã€CMDä»¥åŠES6çš„æ¨¡å—ç³»ç»Ÿ å¸¸è§æ¨¡å—åŒ–è§„èŒƒ CommonJs (Node.js) AMD (RequireJS) CMD (SeaJS) CommonJS(Node.js)CommonJSæ˜¯æœåŠ¡å™¨æ¨¡å—çš„è§„èŒƒï¼ŒNode.jsé‡‡ç”¨äº†è¿™ä¸ªè§„èŒƒã€‚ æ ¹æ® CommonJS è§„èŒƒï¼Œä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶å°±æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œæ¯ä¸€ä¸ªæ¨¡å—éƒ½æ˜¯ä¸€ä¸ªå•ç‹¬çš„ä½œç”¨åŸŸï¼Œåœ¨ä¸€ä¸ªæ–‡ä»¶å®šä¹‰çš„å˜é‡ï¼ˆè¿˜åŒ…æ‹¬å‡½æ•°å’Œç±»ï¼‰ï¼Œéƒ½æ˜¯ç§æœ‰çš„ï¼Œå¯¹å…¶ä»–æ–‡ä»¶æ˜¯ä¸å¯è§çš„ã€‚ CommonJSè§„èŒƒåŠ è½½æ¨¡å—æ˜¯åŒæ­¥çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåªæœ‰åŠ è½½å®Œæˆï¼Œæ‰èƒ½æ‰§è¡ŒåŽé¢çš„æ“ä½œã€‚ CommonJS ä¸­ï¼ŒåŠ è½½æ¨¡å—ä½¿ç”¨ require æ–¹æ³•ã€‚è¯¥æ–¹æ³•è¯»å–ä¸€ä¸ªæ–‡ä»¶å¹¶æ‰§è¡Œï¼Œæœ€åŽè¿”å›žæ–‡ä»¶å†…éƒ¨çš„ exports å¯¹è±¡ã€‚ Node.js ä¸»è¦ç”¨äºŽæœåŠ¡å™¨ç¼–ç¨‹ï¼ŒåŠ è½½çš„æ¨¡å—æ–‡ä»¶ä¸€èˆ¬éƒ½å·²ç»å­˜åœ¨æœ¬åœ°ç¡¬ç›˜ï¼ŒåŠ è½½èµ·æ¥è¾ƒå¿«ï¼Œä¸ç”¨è€ƒè™‘å¼‚æ­¥åŠ è½½çš„æ–¹å¼ï¼Œæ‰€ä»¥ CommonJS çš„åŒæ­¥åŠ è½½æ¨¡å—è§„èŒƒæ˜¯æ¯”è¾ƒé€‚ç”¨çš„ã€‚ ä½†å¦‚æžœæ˜¯æµè§ˆå™¨çŽ¯å¢ƒï¼Œè¦ä»ŽæœåŠ¡å™¨åŠ è½½æ¨¡å—ï¼Œè¿™æ˜¯å°±å¿…é¡»é‡‡ç”¨å¼‚æ­¥æ¨¡å¼ã€‚æ‰€ä»¥å°±æœ‰äº† AMDï¼ŒCMD ç­‰è§£å†³æ–¹æ¡ˆã€‚ 1234567891011121314var x = 5;var addX = function(value) &#123; return value + x;&#125;;module.exports.x = x;module.exports.addX = addX;// ä¹Ÿå¯ä»¥æ”¹å†™ä¸ºå¦‚ä¸‹module.exports = &#123; x: x, addX: addX,&#125;; 123let math = require('./math.js');console.log('math.x',math.x);console.log('math.addX', math.addX(4)); AMD (RequireJS) å¼‚æ­¥æ¨¡å—å®šä¹‰ AMD = Asynchronous Module Definitionï¼Œå³ å¼‚æ­¥æ¨¡å—å®šä¹‰ã€‚ AMD è§„èŒƒåŠ è½½æ¨¡å—æ˜¯å¼‚æ­¥çš„ï¼Œå¹¶å…è®¸å‡½æ•°å›žè°ƒï¼Œä¸å¿…ç­‰åˆ°æ‰€æœ‰æ¨¡å—éƒ½åŠ è½½å®Œæˆï¼ŒåŽç»­æ“ä½œå¯ä»¥æ­£å¸¸æ‰§è¡Œã€‚ AMD ä¸­ï¼Œä½¿ç”¨ require èŽ·å–ä¾èµ–æ¨¡å—ï¼Œä½¿ç”¨ exports å¯¼å‡º APIã€‚ 123456789101112131415161718192021//è§„èŒƒ APIdefine(id?, dependencies?, factory);define.amd = &#123;&#125;;// å®šä¹‰æ— ä¾èµ–çš„æ¨¡å—define(&#123; add: function(x,y)&#123; return x + y; &#125;&#125;);// å®šä¹‰æœ‰ä¾èµ–çš„æ¨¡å—define(["alpha"], function(alpha)&#123; return &#123; verb: function()&#123; return alpha.verb() + 1; &#125; &#125;&#125;); å¼‚æ­¥åŠ è½½å’Œå›žè°ƒ require([module], callback) ä¸­ callback ä¸ºæ¨¡å—åŠ è½½å®ŒæˆåŽçš„å›žè°ƒå‡½æ•° 1234//åŠ è½½ mathæ¨¡å—ï¼Œå®Œæˆä¹‹åŽæ‰§è¡Œå›žè°ƒå‡½æ•°require(['math'], function(math) &#123; math.add(2, 3);&#125;); RequireJSRequireJS æ˜¯ä¸€ä¸ªå‰ç«¯æ¨¡å—åŒ–ç®¡ç†çš„å·¥å…·åº“ï¼Œéµå¾ª AMD è§„èŒƒï¼ŒRequireJS æ˜¯å¯¹ AMD è§„èŒƒçš„é˜è¿°ã€‚ RequireJS åŸºæœ¬æ€æƒ³ä¸ºï¼Œé€šè¿‡ä¸€ä¸ªå‡½æ•°æ¥å°†æ‰€æœ‰æ‰€éœ€çš„æˆ–è€…æ‰€ä¾èµ–çš„æ¨¡å—è£…è½½è¿›æ¥ï¼Œç„¶åŽè¿”å›žä¸€ä¸ªæ–°çš„å‡½æ•°ï¼ˆæ¨¡å—ï¼‰ã€‚åŽç»­æ‰€æœ‰çš„å…³äºŽæ–°æ¨¡å—çš„ä¸šåŠ¡ä»£ç éƒ½åœ¨è¿™ä¸ªå‡½æ•°å†…éƒ¨æ“ä½œã€‚ RequireJS è¦æ±‚æ¯ä¸ªæ¨¡å—å‡æ”¾åœ¨ç‹¬ç«‹çš„æ–‡ä»¶ä¹‹ä¸­ï¼Œå¹¶ä½¿ç”¨ define å®šä¹‰æ¨¡å—ï¼Œä½¿ç”¨ require æ–¹æ³•è°ƒç”¨æ¨¡å—ã€‚ æŒ‰ç…§æ˜¯å¦æœ‰ä¾èµ–å…¶ä»–æ¨¡å—æƒ…å†µï¼Œå¯ä»¥åˆ†ä¸º ç‹¬ç«‹æ¨¡å— å’Œ éžç‹¬ç«‹æ¨¡å—ã€‚ ç‹¬ç«‹æ¨¡å—ï¼Œä¸ä¾èµ–å…¶ä»–æ¨¡å—ï¼Œç›´æŽ¥å®šä¹‰ 123456789101112define(&#123; method1: function()&#123;&#125;, method2: function()&#123;&#125;&#125;);//ç­‰ä»·äºŽdefine(function() &#123; return &#123; method1: function()&#123;&#125;, method2: function()&#123;&#125; &#125;&#125;); éžç‹¬ç«‹æ¨¡å—ï¼Œä¾èµ–å…¶ä»–æ¨¡å— 12345678910define([ 'module1', 'module2' ], function(m1, m2) &#123; ...&#125;);//ç­‰ä»·äºŽdefine(function(require) &#123; var m1 = require('module1'); var m2 = require('module2'); ...&#125;); require æ–¹æ³•è°ƒç”¨æ¨¡å— 1234require(['foo', 'bar'], function(foo, bar) &#123; foo.func(); bar.func();&#125;); CMD (SeaJS)CMD = Common Module Definitionï¼Œå³ é€šç”¨æ¨¡å—å®šä¹‰ã€‚CMD æ˜¯ SeaJS åœ¨æŽ¨å¹¿è¿‡ç¨‹ä¸­å¯¹æ¨¡å—å®šä¹‰çš„è§„èŒƒåŒ–äº§å‡ºã€‚ CMDè§„èŒƒå’ŒAMDç±»ä¼¼ï¼Œéƒ½ä¸»è¦è¿è¡ŒäºŽæµè§ˆå™¨ç«¯ï¼Œå†™æ³•ä¸Šçœ‹èµ·æ¥ä¹Ÿå¾ˆç±»ä¼¼ã€‚ä¸»è¦æ˜¯åŒºåˆ«åœ¨äºŽ æ¨¡å—åˆå§‹åŒ–æ—¶æœº AMDä¸­åªè¦æ¨¡å—ä½œä¸ºä¾èµ–æ—¶ï¼Œå°±ä¼šåŠ è½½å¹¶åˆå§‹åŒ– CMDä¸­ï¼Œæ¨¡å—ä½œä¸ºä¾èµ–ä¸”è¢«å¼•ç”¨æ—¶æ‰ä¼šåˆå§‹åŒ–ï¼Œå¦åˆ™åªä¼šåŠ è½½ã€‚ CMD æŽ¨å´‡ä¾èµ–å°±è¿‘ï¼ŒAMD æŽ¨å´‡ä¾èµ–å‰ç½®ã€‚ AMD çš„ API é»˜è®¤æ˜¯ä¸€ä¸ªå½“å¤šä¸ªç”¨ï¼ŒCMD ä¸¥æ ¼çš„åŒºåˆ†æŽ¨å´‡èŒè´£å•ä¸€ã€‚ä¾‹å¦‚ï¼ŒAMD é‡Œ require åˆ†å…¨å±€çš„å’Œå±€éƒ¨çš„ã€‚CMDé‡Œé¢æ²¡æœ‰å…¨å±€çš„ requireï¼Œæä¾› seajs.use() æ¥å®žçŽ°æ¨¡å—ç³»ç»Ÿçš„åŠ è½½å¯åŠ¨ã€‚CMD é‡Œæ¯ä¸ª API éƒ½ç®€å•çº¯ç²¹ã€‚ 12345678910111213141516171819202122//AMDdefine(['./a','./b'], function (a, b) &#123; //ä¾èµ–ä¸€å¼€å§‹å°±å†™å¥½ a.test(); b.test();&#125;); //CMDdefine(function (requie, exports, module) &#123; //ä¾èµ–å¯ä»¥å°±è¿‘ä¹¦å†™ var a = require('./a'); a.test(); ... //è½¯ä¾èµ– if (status) &#123; var b = requie('./b'); b.test(); &#125;&#125;); Sea.js Sea.js Github Page SeaJSä¸ŽRequireJSæœ€å¤§çš„åŒºåˆ« ä½¿ç”¨Sea.jsï¼Œåœ¨ä¹¦å†™æ–‡ä»¶æ—¶ï¼Œéœ€è¦éµå®ˆCMDï¼ˆCommon Module Definitionï¼‰æ¨¡å—å®šä¹‰è§„èŒƒã€‚ä¸€ä¸ªæ–‡ä»¶å°±æ˜¯ä¸€ä¸ªæ¨¡å—ã€‚ ç”¨æ³• é€šè¿‡ exports æš´éœ²æŽ¥å£ã€‚è¿™æ„å‘³ç€ä¸éœ€è¦å‘½åç©ºé—´äº†ï¼Œæ›´ä¸éœ€è¦å…¨å±€å˜é‡ã€‚è¿™æ˜¯ä¸€ç§å½»åº•çš„å‘½åå†²çªè§£å†³æ–¹æ¡ˆã€‚ é€šè¿‡ require å¼•å…¥ä¾èµ–ã€‚è¿™å¯ä»¥è®©ä¾èµ–å†…ç½®ï¼Œå¼€å‘è€…åªéœ€å…³å¿ƒå½“å‰æ¨¡å—çš„ä¾èµ–ï¼Œå…¶ä»–äº‹æƒ… Sea.js éƒ½ä¼šè‡ªåŠ¨å¤„ç†å¥½ã€‚å¯¹æ¨¡å—å¼€å‘è€…æ¥è¯´ï¼Œè¿™æ˜¯ä¸€ç§å¾ˆå¥½çš„ å…³æ³¨åº¦åˆ†ç¦»ï¼Œèƒ½è®©ç¨‹åºå‘˜æ›´å¤šåœ°äº«å—ç¼–ç çš„ä¹è¶£ã€‚ é€šè¿‡ define å®šä¹‰æ¨¡å—ï¼Œæ›´å¤šè¯¦æƒ…å‚è€ƒSeasJS | æžå®¢å­¦é™¢ã€‚ ç¤ºä¾‹ä¾‹å¦‚ï¼Œå¯¹äºŽä¸‹è¿°util.jsä»£ç  1234567891011var org = &#123;&#125;;org.CoolSite = &#123;&#125;;org.CoolSite.Utils = &#123;&#125;;org.CoolSite.Utils.each = function (arr) &#123; // å®žçŽ°ä»£ç &#125;;org.CoolSite.Utils.log = function (str) &#123; // å®žçŽ°ä»£ç &#125;; å¯ä»¥é‡‡ç”¨SeaJSé‡å†™ä¸º 12345678910define(function(require, exports) &#123; exports.each = function (arr) &#123; // å®žçŽ°ä»£ç  &#125;; exports.log = function (str) &#123; // å®žçŽ°ä»£ç  &#125;;&#125;); é€šè¿‡ exports å°±å¯ä»¥å‘å¤–æä¾›æŽ¥å£ã€‚é€šè¿‡ require(&#39;./util.js&#39;) å°±å¯ä»¥æ‹¿åˆ° util.js ä¸­é€šè¿‡ exports æš´éœ²çš„æŽ¥å£ã€‚è¿™é‡Œçš„ require å¯ä»¥è®¤ä¸ºæ˜¯ Sea.js ç»™ JavaScript è¯­è¨€å¢žåŠ çš„ä¸€ä¸ªè¯­æ³•å…³é”®å­—ï¼Œé€šè¿‡ require å¯ä»¥èŽ·å–å…¶ä»–æ¨¡å—æä¾›çš„æŽ¥å£ã€‚ 123456define(function(require, exports) &#123; var util = require('./util.js'); exports.init = function() &#123; // å®žçŽ°ä»£ç  &#125;;&#125;); SeaJSä¸ŽRequireJSåŒºåˆ«äºŒè€…åŒºåˆ«ä¸»è¦è¡¨çŽ°åœ¨æ¨¡å—åˆå§‹åŒ–æ—¶æœº AMDï¼ˆRequireJSï¼‰ä¸­åªè¦æ¨¡å—ä½œä¸ºä¾èµ–æ—¶ï¼Œå°±ä¼šåŠ è½½å¹¶åˆå§‹åŒ–ã€‚å³å°½æ—©åœ°æ‰§è¡Œï¼ˆä¾èµ–ï¼‰æ¨¡å—ã€‚ç›¸å½“äºŽæ‰€æœ‰çš„requireéƒ½è¢«æå‰äº†ï¼Œè€Œä¸”æ¨¡å—æ‰§è¡Œçš„é¡ºåºä¹Ÿä¸ä¸€å®š100%å°±æ˜¯requireä¹¦å†™é¡ºåºã€‚ CMDï¼ˆSeaJSï¼‰ä¸­ï¼Œæ¨¡å—ä½œä¸ºä¾èµ–ä¸”è¢«å¼•ç”¨æ—¶æ‰ä¼šåˆå§‹åŒ–ï¼Œå¦åˆ™åªä¼šåŠ è½½ã€‚å³åªä¼šåœ¨æ¨¡å—çœŸæ­£éœ€è¦ä½¿ç”¨çš„æ—¶å€™æ‰åˆå§‹åŒ–ã€‚æ¨¡å—åŠ è½½çš„é¡ºåºæ˜¯ä¸¥æ ¼æŒ‰ç…§requireä¹¦å†™çš„é¡ºåºã€‚ ä»Žè§„èŒƒä¸Šæ¥è¯´ï¼ŒAMD æ›´åŠ ç®€å•ä¸”ä¸¥è°¨ï¼Œé€‚ç”¨æ€§æ›´å¹¿ï¼Œè€Œåœ¨RequireJSå¼ºåŠ›çš„æŽ¨åŠ¨ä¸‹ï¼Œåœ¨å›½å¤–å‡ ä¹Žæˆäº†äº‹å®žä¸Šçš„å¼‚æ­¥æ¨¡å—æ ‡å‡†ï¼Œå„å¤§ç±»åº“ä¹Ÿç›¸ç»§æ”¯æŒAMDè§„èŒƒã€‚ ä½†ä»ŽSeaJSä¸ŽCMDæ¥è¯´ï¼Œä¹Ÿåšäº†å¾ˆå¤šä¸é”™ä¸œè¥¿ï¼š1ã€ç›¸å¯¹è‡ªç„¶çš„ä¾èµ–å£°æ˜Žé£Žæ ¼ 2ã€å°è€Œç¾Žçš„å†…éƒ¨å®žçŽ° 3ã€è´´å¿ƒçš„å¤–å›´åŠŸèƒ½è®¾è®¡ 4ã€æ›´å¥½çš„ä¸­æ–‡ç¤¾åŒºæ”¯æŒã€‚ UMD UMD = Universal Module Definitionï¼Œå³é€šç”¨æ¨¡å—å®šä¹‰ã€‚UMD æ˜¯AMD å’Œ CommonJSçš„ç³…åˆã€‚ AMD æ¨¡å—ä»¥æµè§ˆå™¨ç¬¬ä¸€çš„åŽŸåˆ™å‘å±•ï¼Œå¼‚æ­¥åŠ è½½æ¨¡å—ã€‚CommonJS æ¨¡å—ä»¥æœåŠ¡å™¨ç¬¬ä¸€åŽŸåˆ™å‘å±•ï¼Œé€‰æ‹©åŒæ­¥åŠ è½½ã€‚å®ƒçš„æ¨¡å—æ— éœ€åŒ…è£…(unwrapped modules)ã€‚è¿™è¿«ä½¿äººä»¬åˆæƒ³å‡ºå¦ä¸€ä¸ªæ›´é€šç”¨çš„æ¨¡å¼ UMDï¼ˆUniversal Module Definition)ï¼Œå®žçŽ°è·¨å¹³å°çš„è§£å†³æ–¹æ¡ˆã€‚ UMD å…ˆåˆ¤æ–­æ˜¯å¦æ”¯æŒ Node.js çš„æ¨¡å—ï¼ˆexportsï¼‰æ˜¯å¦å­˜åœ¨ï¼Œå­˜åœ¨åˆ™ä½¿ç”¨ Node.js æ¨¡å—æ¨¡å¼ã€‚å†åˆ¤æ–­æ˜¯å¦æ”¯æŒ AMDï¼ˆdefine æ˜¯å¦å­˜åœ¨ï¼‰ï¼Œå­˜åœ¨åˆ™ä½¿ç”¨ AMD æ–¹å¼åŠ è½½æ¨¡å—ã€‚ 1234567891011121314(function (window, factory) &#123; if (typeof exports === 'object') &#123; module.exports = factory(); &#125; else if (typeof define === 'function' &amp;&amp; define.amd) &#123; define(factory); &#125; else &#123; window.eventUtil = factory(); &#125;&#125;)(this, function () &#123; //module ...&#125;); ES6 æ¨¡å—ES6æ¨¡å—å’ŒCommonJSåŒºåˆ« ES6 æ¨¡å—è¾“å‡ºçš„æ˜¯å€¼çš„å¼•ç”¨ï¼Œè¾“å‡ºæŽ¥å£åŠ¨æ€ç»‘å®šï¼Œè€Œ CommonJS è¾“å‡ºçš„æ˜¯å€¼çš„æ‹·è´ã€‚ CommonJS æ¨¡å—æ˜¯è¿è¡Œæ—¶åŠ è½½ï¼ŒES6 æ¨¡å—æ˜¯ç¼–è¯‘æ—¶è¾“å‡ºæŽ¥å£ã€‚ CommonJS è¾“å‡ºå€¼çš„æ‹·è´CommonJS æ¨¡å—è¾“å‡ºçš„æ˜¯å€¼çš„æ‹·è´ï¼ˆç±»æ¯”äºŽåŸºæœ¬ç±»åž‹å’Œå¼•ç”¨ç±»åž‹çš„èµ‹å€¼æ“ä½œï¼‰ã€‚å¯¹äºŽåŸºæœ¬ç±»åž‹ï¼Œä¸€æ—¦è¾“å‡ºï¼Œæ¨¡å—å†…éƒ¨çš„å˜åŒ–å½±å“ä¸åˆ°è¿™ä¸ªå€¼ã€‚å¯¹äºŽå¼•ç”¨ç±»åž‹ï¼Œæ•ˆæžœåŒå¼•ç”¨ç±»åž‹çš„èµ‹å€¼æ“ä½œã€‚ 12345678910111213141516// lib.jsvar counter = 3;var obj = &#123; name: 'David'&#125;;function changeValue() &#123; counter++; obj.name = 'Peter';&#125;;module.exports = &#123; counter: counter, obj: obj, changeValue: changeValue,&#125;; 123456789101112// main.jsvar mod = require('./lib');console.log(mod.counter); // 3console.log(mod.obj.name); // 'David'mod.changeValue();console.log(mod.counter); // 3console.log(mod.obj.name); // 'Peter'// Orconsole.log(require('./lib').counter); // 3console.log(require('./lib').obj.name); // 'Peter' counter æ˜¯åŸºæœ¬ç±»åž‹å€¼ï¼Œæ¨¡å—å†…éƒ¨å€¼çš„å˜åŒ–ä¸å½±å“è¾“å‡ºçš„å€¼å˜åŒ–ã€‚ obj æ˜¯å¼•ç”¨ç±»åž‹å€¼ï¼Œæ¨¡å—å†…éƒ¨å€¼çš„å˜åŒ–å½±å“è¾“å‡ºçš„å€¼å˜åŒ–ã€‚ ä¸Šè¿°ä¸¤ç‚¹åŒºåˆ«ï¼Œç±»æ¯”äºŽåŸºæœ¬ç±»åž‹å’Œå¼•ç”¨ç±»åž‹çš„èµ‹å€¼æ“ä½œã€‚ ä¹Ÿå¯ä»¥å€ŸåŠ©å–å€¼å‡½æ•°ï¼ˆgetterï¼‰ï¼Œå°† counter è½¬ä¸ºå¼•ç”¨ç±»åž‹å€¼ï¼Œæ•ˆæžœå¦‚ä¸‹ã€‚ åœ¨ç±»çš„å†…éƒ¨ï¼Œå¯ä»¥ä½¿ç”¨ get å’Œ set å…³é”®å­—ï¼Œå¯¹æŸä¸ªå±žæ€§è®¾ç½®å­˜æ‰§å‡½æ•°å’Œå–å€¼å‡½æ•°ï¼Œæ‹¦æˆªè¯¥å±žæ€§çš„å­˜å–è¡Œä¸ºã€‚ â€”â€” class | é˜®ä¸€å³° 1234567891011// lib.jsvar counter = 3;function incCounter() &#123; counter++;&#125;module.exports = &#123; get counter() &#123; return counter &#125;, incCounter: incCounter,&#125;; 123456// main.jsvar mod = require('./lib');console.log(mod.counter); // 3mod.incCounter();console.log(mod.counter); // 4 ES6 è¾“å‡ºå€¼çš„å¼•ç”¨ES6 æ¨¡å—æ˜¯åŠ¨æ€å…³è”æ¨¡å—ä¸­çš„å€¼ï¼Œè¾“å‡ºçš„æ˜¯å€¼å¾—å¼•ç”¨ã€‚åŽŸå§‹å€¼å˜äº†ï¼Œimport åŠ è½½çš„å€¼ä¹Ÿä¼šè·Ÿç€å˜ã€‚ ES6 æ¨¡å—çš„è¿è¡Œæœºåˆ¶ä¸Ž CommonJS ä¸ä¸€æ ·ã€‚JS å¼•æ“Žå¯¹è„šæœ¬é™æ€åˆ†æžæ—¶ï¼Œé‡åˆ°æ¨¡å—åŠ è½½å‘½ä»¤ importï¼Œå°±ä¼šç”Ÿæˆä¸€ä¸ªåªè¯»å¼•ç”¨ã€‚ç­‰åˆ°è„šæœ¬çœŸæ­£æ‰§è¡Œæ—¶ï¼Œå†æ ¹æ®è¿™ä¸ªåªè¯»å¼•ç”¨ï¼Œåˆ°è¢«åŠ è½½çš„é‚£ä¸ªæ¨¡å—é‡Œé¢åŽ»å–å€¼ã€‚ES6 æ¨¡å—ä¸­ï¼ŒåŽŸå§‹å€¼å˜äº†ï¼Œimport åŠ è½½çš„å€¼ä¹Ÿä¼šè·Ÿç€å˜ã€‚å› æ­¤ï¼ŒES6 æ¨¡å—æ˜¯åŠ¨æ€å¼•ç”¨ï¼Œå¹¶ä¸”ä¸ä¼šç¼“å­˜å€¼ã€‚ â€”â€” ES6 Module çš„åŠ è½½å®žçŽ° | é˜®ä¸€å³° 1234567891011// lib.jsexport let counter = 3;export function incCounter() &#123; counter++;&#125;// main.jsimport &#123; counter, incCounter &#125; from './lib';console.log(counter); // 3incCounter();console.log(counter); // 4 CommonJS è¿è¡Œæ—¶åŠ è½½ ES6é™æ€ç¼–è¯‘CommonJS æ¨¡å—æ˜¯è¿è¡Œæ—¶åŠ è½½ï¼ŒES6 æ¨¡å—æ˜¯ç¼–è¯‘æ—¶è¾“å‡ºæŽ¥å£ã€‚ è¿™æ˜¯å› ä¸ºï¼ŒCommonJS åŠ è½½çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ˆå³ module.exports å±žæ€§ï¼‰ï¼Œè¯¥å¯¹è±¡åªæœ‰åœ¨è„šæœ¬è¿è¡Œå®Œæ‰ä¼šç”Ÿæˆã€‚è€Œ ES6 æ¨¡å—ä¸æ˜¯å¯¹è±¡ï¼Œå®ƒçš„å¯¹å¤–æŽ¥å£åªæ˜¯ä¸€ç§é™æ€å®šä¹‰ï¼Œåœ¨ä»£ç é™æ€è§£æžé˜¶æ®µå°±ä¼šç”Ÿæˆã€‚ ES6 æ¨¡å—æ˜¯ç¼–è¯‘æ—¶è¾“å‡ºæŽ¥å£ï¼Œå› æ­¤æœ‰å¦‚ä¸‹2ä¸ªç‰¹ç‚¹ import å‘½ä»¤ä¼šè¢« JS å¼•æ“Žé™æ€åˆ†æžï¼Œä¼˜å…ˆäºŽæ¨¡å—å†…çš„å…¶ä»–å†…å®¹æ‰§è¡Œ export å‘½ä»¤ä¼šæœ‰å˜é‡å£°æ˜Žæå‡çš„æ•ˆæžœ import ä¼˜å…ˆæ‰§è¡Œåœ¨æ–‡ä»¶ä¸­çš„ä»»ä½•ä½ç½®å¼•å…¥ import æ¨¡å—éƒ½ä¼šè¢«æå‰åˆ°æ–‡ä»¶é¡¶éƒ¨ 1234567891011// a.jsconsole.log('a.js')import &#123; foo &#125; from './b';// b.jsexport let foo = 1;console.log('b.js å…ˆæ‰§è¡Œ');// æ‰§è¡Œç»“æžœ:// b.js å…ˆæ‰§è¡Œ// a.js è™½ç„¶ a æ¨¡å—ä¸­ import å¼•å…¥æ™šäºŽ console.log(&#39;a&#39;)ï¼Œä½†æ˜¯å®ƒè¢« JS å¼•æ“Žé€šè¿‡é™æ€åˆ†æžï¼Œæåˆ°æ¨¡å—æ‰§è¡Œçš„æœ€å‰é¢ï¼Œä¼˜äºŽæ¨¡å—ä¸­çš„å…¶ä»–éƒ¨åˆ†çš„æ‰§è¡Œã€‚ export å‘½ä»¤å˜é‡æå‡æ•ˆæžœç”±äºŽ import å’Œ export æ˜¯é™æ€æ‰§è¡Œï¼Œæ‰€ä»¥ import å’Œ export å…·æœ‰å˜é‡æå‡æ•ˆæžœã€‚å³ import å’Œ export å‘½ä»¤åœ¨æ¨¡å—ä¸­çš„ä½ç½®å¹¶ä¸å½±å“ç¨‹åºçš„è¾“å‡ºã€‚ 12345678910111213141516171819// a.jsimport &#123; foo &#125; from './b';console.log('a.js');export const bar = 1;export const bar2 = () =&gt; &#123; console.log('bar2');&#125;export function bar3() &#123; console.log('bar3');&#125;// b.jsexport let foo = 1;import * as a from './a';console.log(a);// æ‰§è¡Œç»“æžœ:// &#123; bar: undefined, bar2: undefined, bar3: [Function: bar3] &#125;// a.js a æ¨¡å—å¼•ç”¨äº† b æ¨¡å—ï¼Œb æ¨¡å—ä¹Ÿå¼•ç”¨äº† a æ¨¡å—ï¼Œexport å£°æ˜Žçš„å˜é‡ä¹Ÿæ˜¯ä¼˜äºŽæ¨¡å—å…¶å®ƒå†…å®¹çš„æ‰§è¡Œçš„ã€‚ä½†å…·ä½“å¯¹å˜é‡èµ‹å€¼éœ€è¦ç­‰åˆ°æ‰§è¡Œåˆ°ç›¸åº”ä»£ç çš„æ—¶å€™ã€‚ ES6æ¨¡å—å’ŒCommonJSç›¸åŒç‚¹æ¨¡å—ä¸ä¼šé‡å¤æ‰§è¡Œé‡å¤å¼•å…¥æŸä¸ªç›¸åŒçš„æ¨¡å—æ—¶ï¼Œæ¨¡å—åªä¼šæ‰§è¡Œä¸€æ¬¡ã€‚ å¾ªçŽ¯ä¾èµ–CommonJS æ¨¡å—å¾ªçŽ¯ä¾èµ–CommonJS æ¨¡å—çš„é‡è¦ç‰¹æ€§æ˜¯åŠ è½½æ—¶æ‰§è¡Œï¼Œå³è„šæœ¬ä»£ç åœ¨ require çš„æ—¶å€™ï¼Œå°±ä¼šå…¨éƒ¨æ‰§è¡Œã€‚ä¸€æ—¦å‡ºçŽ°æŸä¸ªæ¨¡å—è¢«â€œå¾ªçŽ¯åŠ è½½â€ï¼Œå°±åªè¾“å‡ºå·²ç»æ‰§è¡Œçš„éƒ¨åˆ†ï¼Œè¿˜æœªæ‰§è¡Œçš„éƒ¨åˆ†ä¸ä¼šè¾“å‡ºã€‚ Demo 1123456//a.jsexports.done = false;var b = require('./b.js');console.log('åœ¨ a.js ä¹‹ä¸­ï¼Œb.done = %j', b.done);exports.done = true;console.log('a.js æ‰§è¡Œå®Œæ¯•'); ä¸Šé¢ä»£ç ä¹‹ä¸­ï¼Œa.js è„šæœ¬å…ˆè¾“å‡ºä¸€ä¸ª done å˜é‡ï¼Œç„¶åŽåŠ è½½å¦ä¸€ä¸ªè„šæœ¬æ–‡ä»¶ b.jsã€‚æ³¨æ„ï¼Œæ­¤æ—¶ a.js ä»£ç å°±åœåœ¨è¿™é‡Œï¼Œç­‰å¾… b.js æ‰§è¡Œå®Œæ¯•ï¼Œå†å¾€ä¸‹æ‰§è¡Œã€‚ å†çœ‹ b.js çš„ä»£ç ã€‚ 123456//b.jsexports.done = false;var a = require('./a.js');console.log('åœ¨ b.js ä¹‹ä¸­ï¼Œa.done = %j', a.done);exports.done = true;console.log('b.js æ‰§è¡Œå®Œæ¯•'); ä¸Šé¢ä»£ç ä¹‹ä¸­ï¼Œb.js æ‰§è¡Œåˆ°ç¬¬äºŒè¡Œï¼Œå°±ä¼šåŽ»åŠ è½½ a.jsï¼Œè¿™æ—¶ï¼Œå°±å‘ç”Ÿäº†â€œå¾ªçŽ¯åŠ è½½â€ã€‚ç³»ç»Ÿä¼š a.js æ¨¡å—å¯¹åº”å¯¹è±¡çš„ exports å±žæ€§å–å€¼ï¼Œå¯æ˜¯å› ä¸º a.js è¿˜æ²¡æœ‰æ‰§è¡Œå®Œï¼Œä»Ž exports å±žæ€§åªèƒ½å–å›žå·²ç»æ‰§è¡Œçš„éƒ¨åˆ†ï¼Œè€Œä¸æ˜¯æœ€åŽçš„å€¼ã€‚ a.js å·²ç»æ‰§è¡Œçš„éƒ¨åˆ†ï¼Œåªæœ‰ä¸€è¡Œã€‚ 1exports.done = false; å› æ­¤ï¼Œå¯¹äºŽ b.jsæ¥è¯´ï¼Œå®ƒä»Ž a.js åªè¾“å…¥ä¸€ä¸ªå˜é‡ doneï¼Œå€¼ä¸º falseã€‚ ç„¶åŽï¼Œb.js æŽ¥ç€å¾€ä¸‹æ‰§è¡Œï¼Œç­‰åˆ°å…¨éƒ¨æ‰§è¡Œå®Œæ¯•ï¼Œå†æŠŠæ‰§è¡Œæƒäº¤è¿˜ç»™ a.jsã€‚äºŽæ˜¯ï¼Œa.js æŽ¥ç€å¾€ä¸‹æ‰§è¡Œï¼Œç›´åˆ°æ‰§è¡Œå®Œæ¯•ã€‚æˆ‘ä»¬å†™ä¸€ä¸ªè„šæœ¬ main.jsï¼ŒéªŒè¯è¿™ä¸ªè¿‡ç¨‹ã€‚ 123var a = require('./a.js');var b = require('./b.js');console.log('åœ¨ main.js ä¹‹ä¸­, a.done=%j, b.done=%j', a.done, b.done); æ‰§è¡Œ main.jsï¼Œè¿è¡Œç»“æžœå¦‚ä¸‹ã€‚ 1234567$ node main.jsåœ¨ b.js ä¹‹ä¸­ï¼Œa.done = falseb.js æ‰§è¡Œå®Œæ¯•åœ¨ a.js ä¹‹ä¸­ï¼Œb.done = truea.js æ‰§è¡Œå®Œæ¯•åœ¨ main.js ä¹‹ä¸­, a.done=true, b.done=true ä¸Šé¢çš„ä»£ç è¯æ˜Žäº†2ç‚¹ åœ¨ b.js ä¹‹ä¸­ï¼Œa.js æ²¡æœ‰æ‰§è¡Œå®Œæ¯•ï¼Œåªæ‰§è¡Œäº†ç¬¬ä¸€è¡Œ main.js æ‰§è¡Œåˆ°ç¬¬äºŒè¡Œæ—¶ï¼Œä¸ä¼šå†æ¬¡æ‰§è¡Œ b.jsï¼Œè€Œæ˜¯è¾“å‡ºç¼“å­˜çš„ b.js çš„æ‰§è¡Œç»“æžœï¼Œå³å®ƒçš„ç¬¬å››è¡Œã€‚ 1exports.done = true; æ€»ä¹‹ï¼ŒCommonJS è¾“å…¥çš„æ˜¯è¢«è¾“å‡ºå€¼çš„æ‹·è´ï¼Œä¸æ˜¯å¼•ç”¨ã€‚ å¦å¤–ï¼Œç”±äºŽ CommonJS æ¨¡å—é‡åˆ°å¾ªçŽ¯åŠ è½½æ—¶ï¼Œè¿”å›žçš„æ˜¯å½“å‰å·²ç»æ‰§è¡Œçš„éƒ¨åˆ†çš„å€¼ï¼Œè€Œä¸æ˜¯ä»£ç å…¨éƒ¨æ‰§è¡ŒåŽçš„å€¼ï¼Œä¸¤è€…å¯èƒ½ä¼šæœ‰å·®å¼‚ã€‚æ‰€ä»¥ï¼Œè¾“å…¥å˜é‡çš„æ—¶å€™ï¼Œå¿…é¡»éžå¸¸å°å¿ƒã€‚ 12345678910var a = require('a'); // å®‰å…¨çš„å†™æ³• å¯¼å…¥æ•´ä½“ï¼Œä¿è¯moduleå·²ç»æ‰§è¡Œå®Œæˆvar foo = require('a').foo; // å±é™©çš„å†™æ³•exports.good = function (arg) &#123; return a.foo('good', arg); // ä½¿ç”¨çš„æ˜¯ a.foo çš„æœ€æ–°å€¼&#125;;exports.bad = function (arg) &#123; return foo('bad', arg); // ä½¿ç”¨çš„æ˜¯ä¸€ä¸ªéƒ¨åˆ†åŠ è½½æ—¶çš„å€¼&#125;; ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æžœå‘ç”Ÿå¾ªçŽ¯åŠ è½½ï¼Œrequire(&#39;a&#39;).foo çš„å€¼å¾ˆå¯èƒ½åŽé¢ä¼šè¢«æ”¹å†™ï¼Œæ”¹ç”¨ require(&#39;a&#39;) ä¼šæ›´ä¿é™©ä¸€ç‚¹ã€‚ Demo 2123456789101112131415161718192021222324// a.jsconsole.log('a starting');exports.done = false;const b = require('./b');console.log('in a, b.done =', b.done);exports.done = true;console.log('a done');// b.jsconsole.log('b starting');exports.done = false;const a = require('./a');console.log('in b, a.done =', a.done);exports.done = true;console.log('b done');// node a.js// æ‰§è¡Œç»“æžœï¼š// a starting// b starting// in b, a.done = false// b done// in a, b.done = true// a done ä»Žä¸Šé¢çš„æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œåœ¨ CommonJS è§„èŒƒä¸­ï¼Œå½“é‡åˆ° require() è¯­å¥æ—¶ï¼Œä¼šæ‰§è¡Œ require æ¨¡å—ä¸­çš„ä»£ç ï¼Œå¹¶ç¼“å­˜æ‰§è¡Œçš„ç»“æžœï¼Œå½“ä¸‹æ¬¡å†æ¬¡åŠ è½½æ—¶ä¸ä¼šé‡å¤æ‰§è¡Œï¼Œè€Œæ˜¯ç›´æŽ¥å–ç¼“å­˜çš„ç»“æžœã€‚æ­£å› ä¸ºæ­¤ï¼Œå‡ºçŽ°å¾ªçŽ¯ä¾èµ–æ—¶æ‰ä¸ä¼šå‡ºçŽ°æ— é™å¾ªçŽ¯è°ƒç”¨çš„æƒ…å†µã€‚ ES6 æ¨¡å—å¾ªçŽ¯ä¾èµ–è·Ÿ CommonJS æ¨¡å—ä¸€æ ·ï¼ŒES6 ä¸ä¼šå†åŽ»æ‰§è¡Œé‡å¤åŠ è½½çš„æ¨¡å—ï¼Œåˆç”±äºŽ ES6 åŠ¨æ€è¾“å‡ºç»‘å®šçš„ç‰¹æ€§ï¼Œèƒ½ä¿è¯ ES6 åœ¨ä»»ä½•æ—¶å€™éƒ½èƒ½èŽ·å–å…¶å®ƒæ¨¡å—å½“å‰çš„æœ€æ–°å€¼ã€‚ åŠ¨æ€ import()ES6 æ¨¡å—åœ¨ç¼–è¯‘æ—¶å°±ä¼šé™æ€åˆ†æžï¼Œä¼˜å…ˆäºŽæ¨¡å—å†…çš„å…¶ä»–å†…å®¹æ‰§è¡Œï¼Œæ‰€ä»¥å¯¼è‡´äº†æˆ‘ä»¬æ— æ³•å†™å‡ºåƒä¸‹é¢è¿™æ ·çš„ä»£ç  12345678if(some condition) &#123; import a from './a';&#125;else &#123; import b from './b';&#125;// or import a from (str + 'b'); å› ä¸ºç¼–è¯‘æ—¶é™æ€åˆ†æžï¼Œå¯¼è‡´äº†æˆ‘ä»¬æ— æ³•åœ¨æ¡ä»¶è¯­å¥æˆ–è€…æ‹¼æŽ¥å­—ç¬¦ä¸²æ¨¡å—ï¼Œå› ä¸ºè¿™äº›éƒ½æ˜¯éœ€è¦åœ¨è¿è¡Œæ—¶æ‰èƒ½ç¡®å®šçš„ç»“æžœåœ¨ ES6 æ¨¡å—æ˜¯ä¸è¢«å…è®¸çš„ï¼Œæ‰€ä»¥ åŠ¨æ€å¼•å…¥import() åº”è¿è€Œç”Ÿã€‚ import() å…è®¸ä½ åœ¨è¿è¡Œæ—¶åŠ¨æ€åœ°å¼•å…¥ ES6 æ¨¡å—ï¼Œæƒ³åˆ°è¿™ï¼Œä½ å¯èƒ½ä¹Ÿæƒ³èµ·äº† require.ensure è¿™ä¸ªè¯­æ³•ï¼Œä½†æ˜¯å®ƒä»¬çš„ç”¨é€”å´æˆªç„¶ä¸åŒçš„ã€‚ require.ensure çš„å‡ºçŽ°æ˜¯ webpack çš„äº§ç‰©ï¼Œå®ƒæ˜¯å› ä¸ºæµè§ˆå™¨éœ€è¦ä¸€ç§å¼‚æ­¥çš„æœºåˆ¶å¯ä»¥ç”¨æ¥å¼‚æ­¥åŠ è½½æ¨¡å—ï¼Œä»Žè€Œå‡å°‘åˆå§‹çš„åŠ è½½æ–‡ä»¶çš„ä½“ç§¯ï¼Œæ‰€ä»¥å¦‚æžœåœ¨æœåŠ¡ç«¯çš„è¯ï¼Œ require.ensure å°±æ— ç”¨æ­¦ä¹‹åœ°äº†ï¼Œå› ä¸ºæœåŠ¡ç«¯ä¸å­˜åœ¨å¼‚æ­¥åŠ è½½æ¨¡å—çš„æƒ…å†µï¼Œæ¨¡å—åŒæ­¥è¿›è¡ŒåŠ è½½å°±å¯ä»¥æ»¡è¶³ä½¿ç”¨åœºæ™¯äº†ã€‚ CommonJS æ¨¡å—å¯ä»¥åœ¨è¿è¡Œæ—¶ç¡®è®¤æ¨¡å—åŠ è½½ã€‚ è€Œ import() åˆ™ä¸åŒï¼Œå®ƒä¸»è¦æ˜¯ä¸ºäº†è§£å†³ ES6 æ¨¡å—æ— æ³•åœ¨è¿è¡Œæ—¶ç¡®å®šæ¨¡å—çš„å¼•ç”¨å…³ç³»ï¼Œæ‰€ä»¥éœ€è¦å¼•å…¥ import()ã€‚ å…ˆæ¥çœ‹ä¸‹å®ƒçš„ç”¨æ³• åŠ¨æ€çš„ import() æä¾›ä¸€ä¸ªåŸºäºŽ Promise çš„ API åŠ¨æ€çš„ import() å¯ä»¥åœ¨è„šæœ¬çš„ä»»ä½•åœ°æ–¹ä½¿ç”¨ import() æŽ¥å—å­—ç¬¦ä¸²æ–‡å­—ï¼Œå¯ä»¥æ ¹æ®éœ€è¦æž„é€ è¯´æ˜Žç¬¦ 12345678910111213141516171819// a.jsconst str = './b';const flag = true;if(flag) &#123; import('./b').then((&#123;foo&#125;) =&gt; &#123; console.log(foo); &#125;)&#125;import(str).then((&#123;foo&#125;) =&gt; &#123; console.log(foo);&#125;)// b.jsexport const foo = 'foo';// babel-node a.js// æ‰§è¡Œç»“æžœ// foo// foo å½“ç„¶ï¼Œå¦‚æžœåœ¨æµè§ˆå™¨ç«¯çš„ import() çš„ç”¨é€”å°±ä¼šå˜å¾—æ›´å¹¿æ³›ï¼Œæ¯”å¦‚ æŒ‰éœ€å¼‚æ­¥åŠ è½½æ¨¡å—ï¼Œé‚£ä¹ˆå°±å’Œ require.ensure åŠŸèƒ½ç±»ä¼¼äº†ã€‚ å› ä¸ºæ˜¯åŸºäºŽ Promise çš„ï¼Œæ‰€ä»¥å¦‚æžœä½ æƒ³è¦åŒæ—¶åŠ è½½å¤šä¸ªæ¨¡å—çš„è¯ï¼Œå¯ä»¥æ˜¯ Promise.all è¿›è¡Œå¹¶è¡Œå¼‚æ­¥åŠ è½½ã€‚ 123456789Promise.all([ import('./a.js'), import('./b.js'), import('./c.js'),]).then(([a, &#123;default: b&#125;, &#123;c&#125;]) =&gt; &#123; console.log('a.js is loaded dynamically'); console.log('b.js is loaded dynamically'); console.log('c.js is loaded dynamically');&#125;); è¿˜æœ‰ Promise.race æ–¹æ³•ï¼Œå®ƒæ£€æŸ¥å“ªä¸ª Promise è¢«é¦–å…ˆ resolved æˆ– rejectã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ import() æ¥æ£€æŸ¥å“ªä¸ª CDN é€Ÿåº¦æ›´å¿«ï¼š 1234567891011121314151617181920const CDNs = [ &#123; name: 'jQuery.com', url: 'https://code.jquery.com/jquery-3.1.1.min.js' &#125;, &#123; name: 'googleapis.com', url: 'https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js' &#125;];console.log(`------`);console.log(`jQuery is: $&#123;window.jQuery&#125;`);Promise.race([ import(CDNs[0].url).then(()=&gt;console.log(CDNs[0].name, 'loaded')), import(CDNs[1].url).then(()=&gt;console.log(CDNs[1].name, 'loaded'))]).then(()=&gt; &#123; console.log(`jQuery version: $&#123;window.jQuery.fn.jquery&#125;`);&#125;); å½“ç„¶ï¼Œå¦‚æžœä½ è§‰å¾—è¿™æ ·å†™è¿˜ä¸å¤Ÿä¼˜é›…ï¼Œä¹Ÿå¯ä»¥ç»“åˆ async/await è¯­æ³•ç³–æ¥ä½¿ç”¨ã€‚ 12345678910async function main() &#123; const myModule = await import('./myModule.js'); const &#123;export1, export2&#125; = await import('./myModule.js'); const [module1, module2, module3] = await Promise.all([ import('./module1.js'), import('./module2.js'), import('./module3.js'), ]);&#125; åŠ¨æ€ import() ä¸ºæˆ‘ä»¬æä¾›äº†ä»¥å¼‚æ­¥æ–¹å¼ä½¿ç”¨ ES æ¨¡å—çš„é¢å¤–åŠŸèƒ½ã€‚ æ ¹æ®æˆ‘ä»¬çš„éœ€æ±‚åŠ¨æ€æˆ–æœ‰æ¡ä»¶åœ°åŠ è½½å®ƒä»¬ï¼Œè¿™ä½¿æˆ‘ä»¬èƒ½å¤Ÿæ›´å¿«ï¼Œæ›´å¥½åœ°åˆ›å»ºæ›´å¤šä¼˜åŠ¿åº”ç”¨ç¨‹åºã€‚ webpackä¸­åŠ è½½3ç§æ¨¡å— | è¯­æ³•Webpackå…è®¸ä½¿ç”¨ä¸åŒçš„æ¨¡å—ç±»åž‹ï¼Œä½†æ˜¯åº•å±‚å¿…é¡»ä½¿ç”¨åŒä¸€ç§å®žçŽ°ã€‚æ‰€æœ‰çš„æ¨¡å—å¯ä»¥ç›´æŽ¥åœ¨ç›’å¤–è¿è¡Œã€‚ ES6 æ¨¡å— 1import MyModule from './MyModule.js'; CommonJS(Require) 1var MyModule = require('./MyModule.js'); AMD 12define(['./MyModule.js'], function (MyModule) &#123;&#125;);]]></content>
      <categories>
        <category>Front-End Develop</category>
      </categories>
      <tags>
        <tag>Front-End Developer</tag>
        <tag>JS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[HomePageImage]]></title>
    <url>%2F2018%2F09%2F12%2Fhome-page-img%2F</url>
    <content type="text"><![CDATA[]]></content>
  </entry>
  <entry>
    <title><![CDATA[Hexo Blog æ­å»ºä¸Žé…ç½®]]></title>
    <url>%2F2016%2F03%2F10%2Fblog-configure%2F</url>
    <content type="text"><![CDATA[è®°å½• Hexo Blog çš„æ­å»ºä¸Žé…ç½® å¯¹ Next ä¸»é¢˜è¿›è¡Œå®šåˆ¶ï¼Œæ·»åŠ æœç´¢ï¼Œç»Ÿè®¡ï¼Œç½®é¡¶ï¼ŒåŠ å¯†é˜…è¯»ï¼Œè‡ªå®šä¹‰CSSç­‰ Changelog 2018/08/23ï¼Œæ’°å†™ 2018/09/04ï¼Œæ•´ç† 2018/09/25ï¼Œæ·»åŠ  Font Awesomeä½¿ç”¨ 2019/03/18ï¼Œæ·»åŠ æ–‡ç« åŠ å¯†é˜…è¯» æœ¬åšå®¢å…¨éƒ¨é…ç½®ä¿¡æ¯å¯åœ¨ BlogSpace | lbs0912-github æŸ¥çœ‹ RefHexo åŸºç¡€ä½¿ç”¨ ä½¿ç”¨GitHubå’ŒHexoæ­å»ºå…è´¹é™æ€Blog ä½¿ç”¨HexoåŸºäºŽGitHub-Pagesæ­å»ºä¸ªäººåšå®¢ï¼ˆä¸‰ï¼‰ Blog è¿›é˜¶ç®¡ç† Next Theme å®˜æ–¹é…ç½®æ‰‹å†Œ å¦‚ä½•æ›´å¥½åœ°å¯¹hexoåšå®¢ç®¡ç† Hexo åšå®¢è¿›é˜¶é…ç½® Hexoæ­å»ºçš„GitHubåšå®¢ä¹‹ä¼˜åŒ–å¤§å…¨ Next Theme ç›¸å†Œé…ç½® æ­å»ºHexo ç›¸å†Œ ä¼˜è´¨åšå®¢å‚è€ƒ Sunmengyuan Blog ç¾¡è¾™ Blog BYvoid HexoInstall Hexo is a fast, simple and powerful blog framework. You write posts in Markdown (or other languages) and Hexo generates static files with a beautiful theme in seconds. â€” Hexo å‚è€ƒ Hexoå®˜ç½‘äº†è§£Hexoæ›´å¤šä¿¡æ¯ã€‚ 1234567npm install hexo-cli -gmkdir Blog &amp;&amp; cd Bloghexo init blogcd blognpm installhexo server Hexoç”Ÿæˆçš„ç›®å½•ç»“æž„å¦‚ä¸‹ .deploy : éœ€è¦éƒ¨ç½²çš„æ–‡ä»¶ node_modules public: ç”Ÿæˆçš„é™æ€ç½‘é¡µæ–‡ä»¶ scaffolds: æ¨¡æ¿ source: åšå®¢æ­£æ–‡å’Œå…¶ä»–æºæ–‡ä»¶ï¼Œ404ï¼Œfaviconï¼ŒCNAME _drafts: è‰ç¨¿ _posts: æ–‡ç«  themes: ä¸»é¢˜ _config.yml: å…¨å±€é…ç½®æ–‡ä»¶ package.json å‘½ä»¤è¡Œ123456789101112131415161718hexo new page archive# åˆ›å»ºåˆ†ç±»ç›®å½•å¹¶åˆå§‹åŒ–index.md ç­‰åŒäºŽ hexo nhexo server # run hexo server ç­‰åŒäºŽ hexo shexo generate # Generate static files ç­‰åŒäºŽ hexo ghexo deploy # Deploy to remote sites ç­‰åŒäºŽ hexo dhexo clean # æ¸…ç©ºç¼“å­˜æ–‡ä»¶hexo -v # æŸ¥çœ‹hexoç‰ˆæœ¬hexo help # æŸ¥çœ‹hexoå¸®åŠ©hexo d -g # ç”Ÿæˆéƒ¨ç½² ç»„åˆå‘½ä»¤hexo s -g # ç”Ÿæˆé¢„è§ˆ ç»„åˆå‘½ä»¤hexo s --debug # æœ¬åœ°é¢„è§ˆï¼Œå¹¶å¼€å¯è°ƒè¯•æ¨¡å¼ åœ¨åŽç»­åšæ–‡å‘å¸ƒæ—¶ï¼Œä¾æ¬¡æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ hexo clean: æ¸…ç©ºç¼“å­˜æ–‡ä»¶ hexo g: ç¼–è¯‘äº§ç”Ÿé™æ€æ–‡ä»¶ hexo s: æœ¬åœ°é¢„è§ˆï¼Œå¯é€‰ hexo d: éƒ¨ç½²åˆ°æœåŠ¡ç«¯ Hexo to GitHubåˆ›å»ºGitHubä»“åº“ åˆ›å»ºä¸€ä¸ªä»“åº“ï¼Œå¹¶å‘½åä¸º YourAccountName.github.ioï¼ˆæ­¤å¤„ä»¥lbs0912.github.ioä¸ºä¾‹ï¼‰ è®¾ç½®ä»“åº“å±žæ€§ï¼Œé€‰æ‹© GitHub Page çš„ä¸»é¢˜ï¼Œè®¿é—® https://lbs0912.github.io/è¿›è¡Œé¢„è§ˆ åŒæ­¥å†…å®¹è‡³ GitHubåœ¨Hexoå®‰è£…ç›®å½•ä¸‹æ‰“å¼€ _config.yml æ–‡ä»¶ï¼Œè¿›è¡Œå¦‚ä¸‹ä¿®æ”¹ 123456# Deployment## Docs: https://hexo.io/docs/deployment.htmldeploy: type: git repository: https://github.com/lbs0912/lbs0912.github.io.git branch: master è¯¥é…ç½®æ–‡ä»¶éµå¾ª Yaml è¯­æ³•ï¼Œtype: å’Œ git ä¸­é—´éœ€æœ‰ä¸€ç©ºæ ¼ã€‚ å¯¹é™æ€ç½‘é¡µçš„æ ‡é¢˜ï¼Œå­æ ‡é¢˜ï¼Œä»‹ç»ï¼Œæ—¶åŒºç­‰å†…å®¹è¿›è¡Œå¦‚ä¸‹è®¾ç½®ã€‚ 12345678910111213141516171819202122# Sitetitle: Liu Baoshuai's Blogsubtitle: Do one thing at a time and do well. description: Record and become better myself.author: Liu Baoshuailanguage: zh-Hanstimezone: Asia/Shanghai# URL## If your site is put in a subdirectory, set url as 'http://yoursite.com/child' and root as '/child/'url: https://lbs0912.github.io/root: /permalink: :year/:month/:day/:title/permalink_defaults://...highlight: enable: true line_number: true auto_detect: true tab_replace: é…ç½®æ–‡ä»¶ä¿®æ”¹å®ŒæˆåŽï¼Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼Œå°†æ›´æ–°åŽçš„å†…å®¹åŒæ­¥è‡³GitHubã€‚ 12345npm install hexo-deployer-git --save #deploy to git hexo clean hexo generate # or hexo ghexo deploy # or hexo d æ‰“å¼€ https://lbs0912.github.io/ å¯ä»¥è®¿é—®åšå®¢ç•Œé¢ã€‚ åŸŸåå’ŒDNSåŸŸåç”³è¯·åŸŸåç”¨äºŽåšå®¢è®¿é—®ã€‚æ­¤å¤„ç”³è¯·åŸŸå liubaoshuai.comã€‚ å·²ç”³è¯·çš„åŸŸååŒ…æ‹¬ liubaoshuai.com liubaoshuai.tech è®¾ç½®CNAMEåœ¨Hexoçš„å®‰è£…ç›®å½•ä¸‹çš„ source ç›®å½•ä¸‹ï¼Œåˆ›å»º CNAME æ–‡ä»¶ï¼Œå¹¶å­˜å…¥ç”³è¯·çš„åŸŸå liubaoshuai.comã€‚ DNSæŽ¨èä½¿ç”¨ DNSPod è¿›è¡ŒDNSè§£æžã€‚ æ­¤å¤„ï¼Œç”±äºŽåŸŸå http://liubaoshuai.com/ åœ¨é˜¿é‡Œäº‘è´­ä¹°ï¼Œæ•…ä½¿ç”¨é˜¿é‡Œäº‘çš„ DNS äº‘è§£æžã€‚DNS ç•Œé¢è¿›è¡Œå¦‚ä¸‹è®¾ç½®ã€‚ è®°å½•ç±»åž‹ ä¸»æœºè®°å½• è®°å½•å€¼ CNAME www lbs0912.github.io A @ 192.30.252.154 A @ 192.30.252.153 DNS Update | github å…¶ä¸­Aè®°å½•ä¸ºGitHub Pageæä¾›çš„IPåœ°å€ï¼Œå¯ä»¥è®¿é—® GitHub Page æŸ¥è¯¢æœ€æ–° IP åœ°å€ã€‚ æœ€åŽï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå¹¶è®¿é—® liubaoshuai.com æŸ¥çœ‹ä¿®æ”¹æ•ˆæžœã€‚ 123hexo clean hexo g # or hexo generatehexo d # or hexo deploy è‡³æ­¤ï¼Œä¾¿å¯é€šè¿‡è®¿é—® liubaoshuai.com æ¥è®¿é—®è‡ªå·±çš„åšå®¢ã€‚ è®¿é—® lbs0912.github.ioï¼Œä¼šè¢«é‡å®šå‘åˆ° liubaoshuai.com ç½‘å€ã€‚ Blog é…ç½® Next Theme å®˜æ–¹é…ç½®æ‰‹å†Œ Pluginå®‰è£…Hexoæ’ä»¶æ¥å¢žå¼ºHexoæ•ˆæžœå’Œç¾ŽåŒ–é¡µé¢ã€‚ 123456789101112npm install hexo-generator-index --savenpm install hexo-generator-archive --savenpm install hexo-generator-category --savenpm install hexo-generator-tag --savenpm install hexo-deployer-git --save #deploy to gitnpm install hexo-deployer-heroku --savenpm install hexo-deployer-rsync --savenpm install hexo-deployer-openshift --savenpm install hexo-renderer-marked --savenpm install hexo-renderer-stylus --savenpm install hexo-generator-feed --save # RSSnpm install hexo-generator-sitemap --save #sitemap æ·»åŠ Metaä¿¡æ¯Hexo é»˜è®¤çš„æ–‡ä»¶å¤´åªæœ‰titleã€dateã€tags å±žæ€§ï¼Œç”Ÿæˆçš„ html ç¼ºå°‘ Metaä¿¡æ¯ï¼Œä¸åˆ©äºŽæœç´¢å¼•æ“Žæ”¶å½•ã€‚å»ºè®®è‡ªè¡Œåœ¨æ–‡ä»¶å¤´ä¸­æ·»åŠ  keywords å’Œ description å±žæ€§ã€‚categories å±žæ€§å¯è‡ªè¡Œé€‰æ‹©æ˜¯å¦æ·»åŠ ã€‚ 12345678---title: ##æ–‡ç« æ ‡é¢˜date: ##æ—¶é—´ï¼Œæ ¼å¼ä¸º YYYY-MM-DD HH:mm:sscategories: ##åˆ†ç±»tags: ##æ ‡ç­¾ï¼Œå¤šæ ‡ç­¾æ ¼å¼ä¸º [tag1,tag2,...]keywords: ##æ–‡ç« å…³é”®è¯ï¼Œå¤šå…³é”®è¯æ ¼å¼ä¸º keyword1,keywords2,...description: ##æ–‡ç« æè¿°--- æ–‡ä»¶å¤´æ¨¡æ¿å¦‚ä¸Šæ‰€ç¤ºï¼Œä¸€ä¸ªæ–‡ä»¶å¤´å®žä¾‹å¦‚ä¸‹æ‰€ç¤ºã€‚ 12345678---title: è¿™æ˜¯ä¸€ç¯‡æµ‹è¯•æ–‡ç« date: 2015-03-21 15:13:48categories: Hexotags: [Hexo,æµ‹è¯•]keywords: Hexo,æ–‡ç« ,æµ‹è¯•description: è¿™æ˜¯ä¸€ç¯‡æµ‹è¯•æ–‡ç« ï¼Œç”¨äºŽæµ‹è¯•Hexoæ–‡ç« æ–‡ä»¶å¤´ã€‚--- éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¤šä¸ªæ ‡ç­¾ä¹Ÿå¯é‡‡ç”¨å¦‚ä¸‹å†™æ³• 123tags: - Testing Tag - Another Tag åˆ†é¡µåŠŸèƒ½åœ¨ Hexo å®‰è£…ç›®å½•ä¸‹æ‰“å¼€ _config.ymlï¼Œæ·»åŠ å¦‚ä¸‹é…ç½®ï¼Œ ä¸ºåšå®¢æ·»åŠ åˆ†é¡µåŠŸèƒ½ã€‚ 12345678910111213# Pluginsindex_generator: path: '' per_page: 8 ##é¦–é¡µé»˜è®¤8ç¯‡æ–‡ç« æ ‡é¢˜ï¼Œå¦‚æžœå€¼ä¸º0ä¸åˆ†é¡µ order_by: -datearchive_generator: per_page: 8 ##å½’æ¡£é¡µé¢é»˜è®¤8ç¯‡æ–‡ç« æ ‡é¢˜ï¼Œå¦‚æžœå€¼ä¸º0ä¸åˆ†é¡µ yearly: true ##ç”Ÿæˆå¹´è§†å›¾ monthly: true ##ç”Ÿæˆæœˆè§†å›¾tag_generator: per_page: 8 ##æ ‡ç­¾é¡µé¢é»˜è®¤8ç¯‡æ–‡ç« ï¼Œå¦‚æžœå€¼ä¸º0ä¸åˆ†é¡µcategory_generator: per_page: 8 ##åˆ†ç±»é¡µé¢é»˜è®¤8ç¯‡æ–‡ç« ï¼Œå¦‚æžœå€¼ä¸º0ä¸åˆ†é¡µ Hexo ä¸»é¢˜é…ç½®è®¿é—®å¦‚ä¸‹é“¾æŽ¥ï¼ŒæŸ¥çœ‹ Hexo ä¸»é¢˜åˆ—è¡¨ Hexo Themes List Hexo Themes List on GitHub Next Theme å‚è€ƒ Next Theme | github å®ŒæˆåŸºæœ¬é…ç½®ã€‚ Next Theme Configure å‚è€ƒ Nextä¸»é¢˜ç¾ŽåŒ–è¿›é˜¶ | Segmentfault è¿›è¡Œå®šåˆ¶ã€‚ Install 12$ cd hexo$ git clone https://github.com/theme-next/hexo-theme-next themes/next å°†ä¸‹è½½å¥½çš„ Huno ä¸»é¢˜æ”¾ç½®åœ¨ blog/themes ç›®å½•ä¸‹ã€‚ä¿®æ”¹ Hexo é…ç½®æ–‡ä»¶_config.xml 1theme: next Update 12$ cd themes/next$ git pull è®¾ç½®ç•Œé¢ä¸ªäººå¤´åƒå’Œç½‘é¡µæ”¶è—å¤¹å›¾æ ‡ 1234567# Site favicon#favicon: /favicon.pngfavicon: https://image-bed-20181207-1257458714.cos.ap-shanghai.myqcloud.com/Blog-20190315/blog-logo-1.jpg# Site logo#logo: /avatar.pnglogo: https://image-bed-20181207-1257458714.cos.ap-shanghai.myqcloud.com/Blog-20190315/blog-logo-1.jpg ä½œå“è®¾è®¡å‚è€ƒç½‘ç«™ Dribbble Behance Huno Themeå‚è€ƒ Huno Theme | github å®ŒæˆåŸºæœ¬é…ç½®ã€‚ é›†æˆç¬¬ä¸‰æ–¹æœåŠ¡ Next Theme å®˜æ–¹é…ç½®æ‰‹å†Œ ç™¾åº¦ç»Ÿè®¡ ç”¨æˆ·åï¼š15821929853 å¯†ç ï¼šAb758123aB ç™¾åº¦ç»Ÿè®¡-è„šæœ¬ IDï¼š17082ee15df20dad9762c5512f336eb2 ç™»é™† ç™¾åº¦ç»Ÿè®¡ ç½‘ç«™ï¼Œå¯ä»¥æŸ¥é˜…ç½‘ç«™è®¿é—®é‡ é˜…è¯»æ¬¡æ•°ç»Ÿè®¡ LeanCloud leancloud LeanCloud é…ç½® ä½¿ç”¨ Github ç¬¬ä¸‰æ–¹è´¦ç™»å½• leancloud APP IDï¼šgksxcfwJlMV3zkhz1pQc7pl2-gzGzoHsz APP Keyï¼škjOanp812G7TIGMSQpPCVIhj æœç´¢åŠŸèƒ½ æœç´¢æœåŠ¡é…ç½® NexT ä¸»é¢˜æ”¯æŒé›†æˆ Swiftypeï¼Œå¾®æœç´¢ï¼ŒLocal Search å’Œ Algolia æœç´¢åŠŸèƒ½ã€‚Swiftype å’Œ Algolia å‡æ”¶è´¹ï¼Œå¯ä»¥é‡‡ç”¨ Hexo æä¾›çš„ Local Search æœç´¢æœåŠ¡ï¼Œå…¶åŽŸç†æ˜¯é€šè¿‡ hexo-generator-searchdb æ’ä»¶åœ¨æœ¬åœ°ç”Ÿæˆä¸€ä¸ª search.xml æ–‡ä»¶ï¼Œæœç´¢çš„æ—¶å€™ä»Žè¿™ä¸ªæ–‡ä»¶ä¸­æ ¹æ®å…³é”®å­—æ£€ç´¢å‡ºç›¸åº”çš„é“¾æŽ¥ã€‚ åšæ–‡åˆ†äº«åŠŸèƒ½ hexo nextä¸»é¢˜ä¸ºåšå®¢æ·»åŠ åˆ†äº«åŠŸèƒ½ ç™¾åº¦åˆ†äº« 123baidushare: type: button # éœ€è¦è®¾ç½® type: button baidushare: true likely åˆ†äº« 12345678910111213likely: enable: true look: light # available values: normal, light, small, big networks: twitter: Tweet facebook: Share linkedin: Link #gplus: Plus #vkontakte: Share #odnoklassniki: Class #telegram: Send whatsapp: Send #pinterest: Pin Disqus è¯„è®º ä½¿ç”¨è°·æ­Œè´¦æˆ·ç™»å½•Disqus shortNameï¼šliubaoshuaiBlog ä¹‹åŽï¼Œåœ¨æ’°å†™æ–‡ç« æ—¶ï¼Œé¡¶éƒ¨ä¿¡æ¯æ·»åŠ  comments å­—æ®µå¯æŽ§åˆ¶æ˜¯å¦å±•ç¤ºè¯„è®º 1234567891011---title: Demodate: 2017-03-10 14:35:26categories: Demotags: [LeetCode,Programing,Algorithm]keywords: LeetCodetoc: truepassword: 123456top: 5comments: true--- 404é¡µé¢ æŽ¨èä½¿ç”¨ è…¾è®¯å…¬ç›Š404ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ 404 é¡µé¢ï¼Œä¾‹å¦‚æœ¬åšå®¢é‡‡ç”¨çš„ 404 é¡µé¢ã€‚ åœ¨ blog/source ç›®å½•ä¸‹åˆ›å»º 404.htmlï¼Œå¼•å…¥è…¾è®¯å…¬ç›Š404è„šæœ¬ã€‚(è¯¥æ•ˆæžœéœ€è¦éƒ¨ç½²åˆ°æœåŠ¡å™¨æ‰èƒ½é¢„è§ˆï¼Œæœ¬åœ°æœåŠ¡æ— æ³•é¢„è§ˆ) Fork me on GitHubåœ¨ Fork me on GitHub Theme ä¸ŠèŽ·å–æºä»£ç ï¼ˆæœ‰å¤šç§æ ·å¼å¯é€‰ï¼‰ï¼Œå¹¶å°† &lt;a&gt; æ ‡ç­¾çš„ href å±žæ€§çš„é“¾æŽ¥ä¿®æ”¹ä¸ºè‡ªå·±çš„ GitHub-lbs0912 åœ°å€ã€‚ ä»¥ Huno ä¸»é¢˜ä¸ºä¾‹ï¼Œå°†ä¸Šè¿°ä»£ç æ·»åŠ åˆ° ./themes/huno/layout/_layout.ejs æ–‡ä»¶çš„&lt;body&gt; æ ‡ç­¾å†…å³å¯ã€‚ ä¿®æ”¹æºä»£ç ä¸­imgæ ‡ç­¾çš„æ ·å¼ä¸ºposition:fixedï¼Œå¯ä»¥å°†Fork me on GitHubå›ºå®šäºŽæµè§ˆå™¨ç•Œé¢é¡¶éƒ¨ã€‚ èƒŒæ™¯éŸ³ä¹æ’­æ”¾è®¾ç½®å‚è€ƒ Hexoä¸­æ’­æ”¾ç½‘æ˜“äº‘éŸ³ä¹çš„å®žè·µ å®Œæˆè¯¥éƒ¨åˆ†è®¾ç½®ã€‚ ä»¥ Huno ä¸»é¢˜ä¸ºä¾‹ï¼Œå°†ç½‘æ˜“äº‘éŸ³ä¹æ’­æ”¾å¤–é“¾æ”¾ç½®åœ¨ ./themes/next/layout/_macro/sidebar.swig æ–‡ä»¶ä¸­ã€‚ 123&lt;% if (!is_home()) &#123; %&gt; &lt;iframe frameborder="no" border="0" marginwidth="0" style="margin-top: 40px;" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&amp;id=394653&amp;auto=0&amp;height=66"&gt;&lt;/iframe&gt;&lt;% &#125; %&gt; ä¸º Blog æ·»åŠ  READMEæœ¬åšå®¢ä¸­ï¼Œä½¿ç”¨äº† Github æœåŠ¡å™¨ä½œä¸ºæ‰˜ç®¡ï¼Œåšå®¢å†…å®¹è¢«å­˜å‚¨åˆ° Github ä¸­ã€‚ ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œéœ€è¦ç»™ Github ä¸­æ¯ä¸€ä¸ªé¡¹ç›®æ·»åŠ  README.md æ–‡ä»¶è¿›è¡Œè¯´æ˜Žã€‚ ä½†æ˜¯ï¼Œåœ¨ Blog é¡¹ç›®ä¸­ï¼Œåœ¨ blog\source ç›®å½•ä¸‹åˆ›å»ºçš„ README.md æ–‡ä»¶ï¼Œä¼šè¢« hexo è§£æžæŽ‰ï¼Œå¹¶ä¸ä¼šè¢«éƒ¨ç½²åˆ° Github æœåŠ¡å™¨ä¸Šã€‚ æ–¹å¼1 åœ¨åšå®¢ Source ç›®å½•ä¸‹åˆ›å»º README.md æ–‡ä»¶ ä¿®æ”¹åšå®¢é…ç½®æ–‡ä»¶çš„ skip_render å­—æ®µå¦‚ä¸‹ 1skip_render: README.md æ–¹å¼2æ­£ç¡®çš„è§£å†³æ–¹æ³•å¦‚ä¸‹ã€‚ æŠŠ README.md æ–‡ä»¶çš„åŽç¼€åæ”¹æˆ .MDOWN ä»å°†è¯¥æ–‡ä»¶ç½®äºŽ blog/source æ–‡ä»¶å¤¹ è¿™æ ·å¯ä»¥ä¿è¯ hexo ä¸ä¼šè§£æžè¯¥æ–‡ä»¶ï¼ŒåŒæ—¶ Github ä¹Ÿä¼šå°†å…¶ä½œä¸º.MD æ–‡ä»¶è§£æž èƒŒæ™¯æ•ˆæžœä¼˜åŒ–æ­¤å¤„ä»‹ç»åšå®¢èƒŒæ™¯åŠ¨æ€æ•ˆæžœå›¾çš„æ·»åŠ ï¼Œä»¥åŠé¼ æ ‡ç‚¹å‡»ç•Œé¢å‡ºçŽ°å¿ƒå½¢å›¾æ¡ˆçš„ç›¸å…³è®¾ç½®ã€‚ ä¸‹è½½ love.js å’Œ particle.js æ–‡ä»¶ï¼Œå°†å…¶å­˜æ”¾è‡³\themes\huno\source\js\srcç›®å½•ä¸‹ã€‚ åœ¨ \themes\huno\layout\layout.ejs æ–‡ä»¶æœ«å°¾ï¼Œå¼•å…¥ä¸Šè¿° 2 ä¸ª js æ–‡ä»¶ã€‚ 1234&lt;!-- èƒŒæ™¯åŠ¨ç”» --&gt;&lt;script type="text/javascript" src="/js/src/particle.js"&gt;&lt;/script&gt;&lt;!-- é¡µé¢ç‚¹å‡»å°çº¢å¿ƒ --&gt;&lt;script type="text/javascript" src="/js/src/love.js"&gt;&lt;/script&gt; åšæ–‡ç½®é¡¶ ä¿®æ”¹ ./node_modules/hexo-generator-index/lib/generator.js æ–‡ä»¶çš„ 1var posts = locals.posts.sort(config.index_generator.order_by); ä¸º 1234567891011121314var posts = locals.posts; posts.data = posts.data.sort(function(a, b) &#123; if(a.top &amp;&amp; b.top) &#123; // ä¸¤ç¯‡æ–‡ç« topéƒ½æœ‰å®šä¹‰ if(a.top == b.top) return b.date - a.date; // è‹¥topå€¼ä¸€æ ·åˆ™æŒ‰ç…§æ–‡ç« æ—¥æœŸé™åºæŽ’ else return b.top - a.top; // å¦åˆ™æŒ‰ç…§topå€¼é™åºæŽ’ &#125; else if(a.top &amp;&amp; !b.top) &#123; // ä»¥ä¸‹æ˜¯åªæœ‰ä¸€ç¯‡æ–‡ç« topæœ‰å®šä¹‰ï¼Œé‚£ä¹ˆå°†æœ‰topçš„æŽ’åœ¨å‰é¢ï¼ˆè¿™é‡Œç”¨å¼‚æˆ–æ“ä½œå±…ç„¶ä¸è¡Œ233ï¼‰ return -1; &#125; else if(!a.top &amp;&amp; b.top) &#123; return 1; &#125; else return b.date - a.date; // éƒ½æ²¡å®šä¹‰æŒ‰ç…§æ–‡ç« æ—¥æœŸé™åºæŽ’ &#125;); è®¾ç½®æ–‡ç« ç½®é¡¶ï¼šåœ¨æ–‡ä»¶çš„å¤´éƒ¨æ·»åŠ  top å€¼ï¼Œtop å€¼è¶Šå¤§ï¼Œæ–‡ç« è¶Šé å‰ã€‚è‹¥ä¸¤ç¯‡æ–‡ç« çš„ top å€¼ä¸€æ ·ï¼Œåˆ™æŒ‰ç…§é»˜è®¤çš„æ—¥æœŸæŽ’åºã€‚ 12345678---title: Webpack Notes - 1date: 2017-01-19 11:15:48categories: Front-endtags: [Webpack,Front-end]keywords: webpack,front-end top: 5--- åšæ–‡æ”¶èµ·æ·»åŠ åœ¨ .MD æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹æ ‡è¯†ã€‚ 1&lt;!--more--&gt; è¯¥æ ‡è¯†å‰çš„ä¼šåœ¨åšå®¢é¦–é¡µå±•ç¤ºï¼ˆå¯ä»¥åœ¨è¯¥æ ‡è¯†å‰æ·»åŠ ç®€è¦è¯´æ˜Žï¼‰ è¯¥æ ‡è¯†åŽçš„åšæ–‡ä¼šè¢«æ”¶èµ·æŠ˜å ã€‚ æ–‡ç« åŠ å¯†é˜…è¯» Ref - nextä¸»é¢˜ - æ–‡ç« åŠ å¯†é˜…è¯» æ‰“å¼€ themes-&gt;next-&gt;layout-&gt;_partials-&gt;head.swig æ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹ä»£ç  1234567891011121314&lt;script&gt; (function () &#123; if ('&#123;&#123; page.password &#125;&#125;') &#123; if (prompt('è¯·è¾“å…¥æ–‡ç« å¯†ç ') !== '&#123;&#123; page.password &#125;&#125;') &#123; alert('å¯†ç é”™è¯¯ï¼'); if (history.length === 1) &#123; location.replace("http://xxxxxxx.xxx"); // è¿™é‡Œæ›¿æ¢æˆä½ çš„é¦–é¡µ &#125; else &#123; history.back(); &#125; &#125; &#125; &#125;)();&lt;/script&gt; ä¹‹åŽï¼Œåœ¨æ’°å†™æ–‡ç« æ—¶ï¼Œé¡¶éƒ¨ä¿¡æ¯æ·»åŠ  password å­—æ®µå³å¯ 1234567891011---title: Demodate: 2017-03-10 14:35:26categories: Demotags: [LeetCode,Programing,Algorithm]keywords: LeetCodetoc: truepassword: 123456top: 5comments: true--- å®šåˆ¶CSS åœ¨ .\themes\next\source\css\_custom\custom.styl æ–‡ä»¶ä¸­ï¼Œæ·»åŠ è‡ªå®šä¹‰CSSæ ·å¼ã€‚ å®šåˆ¶CSSæ ·å¼åŽï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ•ˆæžœã€‚ 1234567891011121314151617181920212223242526272829&lt;span id="inline-blue"&gt;Demo&lt;/span&gt;ï¼Œ &lt;span id="inline-purple"&gt;Demo&lt;/span&gt;&lt;span id="inline-green"&gt;Demo&lt;/span&gt;&lt;span id="inline-yellow"&gt;Demo&lt;/span&gt;&lt;p id="div-border-left-red"&gt;Demo&lt;/p&gt;&lt;p id="div-border-left-yellow"&gt;Demo&lt;/p&gt;&lt;p id="div-border-left-green"&gt;Demo&lt;/p&gt;&lt;p id="div-border-left-blue"&gt;Demo&lt;/p&gt;&lt;p id="div-border-left-purple"&gt;Demo&lt;/p&gt;&lt;p id="div-border-right-red"&gt;Demo&lt;/p&gt;&lt;p id="div-border-right-yellow"&gt;Demo&lt;/p&gt;&lt;p id="div-border-right-green"&gt;Demo&lt;/p&gt;&lt;p id="div-border-right-blue"&gt;Demo&lt;/p&gt;&lt;p id="div-border-right-purple"&gt;Demo&lt;/p&gt;&lt;p id="div-border-top-red"&gt;Demo&lt;/p&gt;&lt;p id="div-border-top-yellow"&gt;Demo&lt;/p&gt;&lt;p id="div-border-top-green"&gt;Demo&lt;/p&gt;&lt;p id="div-border-top-blue"&gt;Demo&lt;/p&gt;&lt;p id="div-border-top-purple"&gt;Demo&lt;/p&gt;&lt;span id="yu-1"&gt;åŠ¨ç”»&lt;/span&gt;&lt;a id="download" href="https://git-scm.com/download/win"&gt;&lt;i class="fa fa-download"&gt;&lt;/i&gt;&lt;span&gt; Download Now&lt;/span&gt;&lt;/a&gt;&lt;blockquote class="blockquote-center"&gt;å¼•ç”¨å±…ä¸­æ•ˆæžœ&lt;/blockquote&gt; é“¾æŽ¥æ–‡æœ¬æ ·å¼ä¿®æ”¹å°†é“¾æŽ¥æ–‡æœ¬è®¾ç½®ä¸ºè“è‰²ï¼Œé¼ æ ‡åˆ’è¿‡æ—¶æ–‡å­—é¢œè‰²åŠ æ·±ï¼Œå¹¶æ˜¾ç¤ºä¸‹åˆ’çº¿ã€‚æ‰“å¼€themes\next\source\css\_custom\custom.styl æ–‡ä»¶ ï¼Œæ·»åŠ å¦‚ä¸‹ css æ ·å¼ 123456789// Custom styles..post-body p a &#123; color: #0593d3; border-bottom: none; &amp;:hover &#123; color: #0477ab; text-decoration: underline; &#125;&#125; æ–‡å­—å¢žåŠ èƒŒæ™¯è‰²å— å‚è€ƒ Hexoåšå®¢è®¾ç½®è¿›é˜¶ å®Œæˆè¯¥éƒ¨åˆ†çš„è®¾ç½®ã€‚ ä½¿ç”¨ inline-blue, inline-purple, inline-yellow,inline-green å¯ä»¥å¯¹æ–‡å­—èƒŒæ™¯è‰²å—è¿›è¡Œä¿®æ”¹ã€‚ 12&lt;span id="inline-blue"&gt;ç«™ç‚¹é…ç½®æ–‡ä»¶&lt;/span&gt;ï¼Œ &lt;span id="inline-purple"&gt;ä¸»é¢˜é…ç½®æ–‡ä»¶&lt;/span&gt; å›¾å½¢è¾¹æ¡†æ•ˆæžœå‚è€ƒ Hexoåšå®¢è®¾ç½®è¿›é˜¶ å®Œæˆè¯¥éƒ¨åˆ†çš„è®¾ç½®ã€‚ å¼•ç”¨è¾¹æ¡†å˜è‰²å‚è€ƒHexoåšå®¢è®¾ç½®è¿›é˜¶ å¼•ç”¨å±…ä¸­æ•ˆæžœ1&lt;blockquote class="blockquote-center"&gt;å¼•ç”¨å±…ä¸­æ•ˆæžœ&lt;/blockquote&gt; Font Awesome ä½¿ç”¨ Font Awesome ä½¿ç”¨ Font Awesome å›¾æ ‡æ—¶ï¼Œåªéœ€è¦ä½¿ç”¨ CSS å‰ç¼€ faï¼Œå†åŠ ä¸Šå›¾æ ‡åç§°å³å¯ã€‚ 123456789101112131415161718&lt;i class="fa fa-pencil"&gt;&lt;/i&gt; fa-pencil&lt;i class="fa fa-pencil-square-o"&gt;&lt;/i&gt; fa-pencil-square-o&lt;i class="fa fa-camera-retro"&gt;&lt;/i&gt; fa-camera-retro&lt;i class="fa fa-share-square-o"&gt;&lt;/i&gt; fa-share-square-o&lt;i class="fa fa-tag"&gt;&lt;/i&gt; fa-tag&lt;i class="fa fa-video-camera"&gt;&lt;/i&gt; fa-video-camera&lt;i class="fa fa-ban"&gt;&lt;/i&gt; fa-ban&lt;i class="fa fa-code"&gt;&lt;/i&gt; fa-code&lt;i class="fa fa-cloud"&gt;&lt;/i&gt; fa-cloud&lt;i class="fa fa-pie-chart"&gt;&lt;/i&gt; fa-pie-chart&lt;i class="fa fa-thumbs-o-up"&gt;&lt;/i&gt; fa-thumbs-o-up&lt;i class="fa fa-chain"&gt;&lt;/i&gt; fa-chain&lt;i class="fa fa-link"&gt;&lt;/i&gt; fa-link&lt;i class="fa fa-edit"&gt;&lt;/i&gt; fa-edit&lt;i class="fa fa-share-alt"&gt;&lt;/i&gt; fa-share-alt&lt;i class="fa fa-jsfiddle"&gt;&lt;/i&gt; fa-jsfiddle&lt;i class="fa fa-git"&gt;&lt;/i&gt; fa-git&lt;i class="fa fa-codepen"&gt;&lt;/i&gt; fa-codepen ä¸»é¡µå›¾ç‰‡å±•ç¤º æ–°å»ºåšæ–‡ï¼Œè®¾ç½® type: &quot;picture&quot;ï¼Œä½¿ç”¨ {\% gp x-x \%} ... {\% endgp \%} æ ‡ç­¾å¼•ç”¨è¦å±•ç¤ºçš„å›¾ç‰‡åœ°å€ã€‚ 12345678910111213141516---title: HomePageImagetype: "picture"top: 999999999999999date: 2018-09-12 16:50:21categories: HomePageImagetags: HomePageImage---&#123;% gp 5-3 %&#125;![my-riding-bike](http://ojxk3q6gs.bkt.clouddn.com/my-riding-bike.jpg)![football](http://ojxk3q6gs.bkt.clouddn.com/football.jpg)![sjtu-title-3](http://ol3kbaay9.bkt.clouddn.com/sjtu-title-3.jpg)![front-end-logo-1](http://ol3kbaay9.bkt.clouddn.com/front-end-logo-1.jpg)![java-c-vs123](http://ol3kbaay9.bkt.clouddn.com/java-c-vs123.jpg)&#123;% endgp %&#125; å›¾ç‰‡å±•ç¤ºæ•ˆæžœ {\% gp 5-3 \%} ç”¨äºŽè®¾ç½®å›¾ç‰‡å±•ç¤ºæ•ˆæžœï¼Œå‚è€ƒ theme/next/scripts/tags/group-pictures.js æ³¨é‡Šç¤ºæ„å›¾ã€‚ ä¿®å¤å›¾ç‰‡å±•ç¤º åšå®¢ä¸»é¡µç›®å‰å¯ä»¥æ­£å¸¸æ˜¾ç¤ºä¸Šæ­¥éª¤ä¸­è®¾ç½®çš„å›¾ç‰‡æ¨¡å¼æ•ˆæžœï¼Œä½†æ˜¯ç‚¹å‡»è¿›å…¥åŽï¼Œå›¾ç‰‡æ˜¾ç¤ºæ•ˆæžœä¼šä¸¢å¤±ï¼Œæ‰€ä»¥éœ€ä¿®æ”¹themes\next\source\css\_common\components\tags\group-pictures.styl æ–‡ä»¶ä¸­çš„ä»¥ä¸‹æ ·å¼ 123456.page-post-detail .post-body .group-picture-column &#123; // float: none; margin-top: 10px; // width: auto !important; img &#123; margin: 0 auto; &#125;&#125; åšæ–‡åº•éƒ¨æ ‡ç­¾æ ·å¼ å°†åšæ–‡åº•éƒ¨çš„è¡¨æƒ…æ ·å¼ï¼Œä»Žæ”¹ä¸º # æ”¹ä¸º Font Awesome å›¾æ ‡çš„æ ‡ç­¾æ ·å¼ã€‚ ä¿®æ”¹æ¨¡æ¿ /themes/next/layout/_macro/post.swigï¼Œæœç´¢ rel=&quot;tag&quot;&gt;#ï¼Œå°†å…¶ä¸­çš„ # æ¢æˆ &lt;i class=&quot;fa fa-tag&quot;&gt;&lt;/i&gt;ã€‚ é¦–é¡µ-ç®€åŽ†å’Œç›¸å†Œåˆ†ç±»åˆ›å»º Create 12hexo new page resume hexo new page album Configure 1234menu: home: / || home resume: /resume/ || child album: /album || picture-o åœ¨ç®€åŽ†å’Œç›¸å†Œå¯¹åº”çš„ index.md æ–‡ä»¶å¤´éƒ¨æ·»åŠ  comments: false å¯ä»¥å…³é—­è¯„è®ºåˆ—è¡¨ã€‚ ç®€åŽ†é…ç½®é™¤äº†ç”¨ markdown ä¹¦å†™ä¸ªäººç®€åŽ†å¤–ï¼Œä¹Ÿå¯ä»¥ç”¨ HTML ä¹¦å†™ä¸ªäººç®€åŽ†ã€‚æ­¤æ—¶ï¼Œéœ€è¦åœ¨æ–‡ä»¶å¤´éƒ¨æ·»åŠ ä¸è¿›è¡Œæ¸²æŸ“æŒ‡ä»¤ã€‚ 12345678---layout: falsetitle: ä¸ªäººç®€åŽ†---&lt;!doctype html&gt;&lt;html lang="zh"&gt;&lt;head&gt;&lt;!-- resume code here--&gt; ç›¸å†Œé…ç½®å‚è€ƒèµ„æ–™ Next Theme ç›¸å†Œé…ç½® æ­å»ºHexo ç›¸å†Œ Tip åœ¨ album ç›®å½•ä¸‹æ·»åŠ  assets/empty.jpgï¼Œä½œä¸ºå›¾ç‰‡å±•ç¤ºçš„å ä½å›¾ã€‚ æœ¬ç›¸å†Œé…ç½®ä¸­æ˜¯å°†å›¾ç‰‡å­˜æ”¾åœ¨ githubçš„ï¼Œå…¶è®¿é—®é“¾æŽ¥æ˜¯ https://raw.githubusercontent.com å¼€å¤´çš„ï¼Œå¹¶ä¸æ˜¯å›¾ç‰‡çš„å­˜å‚¨åœ°å€ã€‚å› æ­¤ï¼Œalbum/ins.js ä¸­å›¾ç‰‡é“¾æŽ¥åœ°å€ä¸º 123var minSrc = 'https://raw.githubusercontent.com/lbs0912/HexoBlog/master/source/album/photos_configure/min_photos/' + data.link[i];var src = 'https://raw.githubusercontent.com/lbs0912/HexoBlog/master/source/album/photos_configure/photos/' + data.link[i]; æœ€åŽ è®°å½•ï¼Œæˆä¸ºæ›´å¥½çš„è‡ªå·±ã€‚ æœ¬åšå®¢å…¨éƒ¨é…ç½®ä¿¡æ¯å¯åœ¨ BlogSpace | lbs0912-github æŸ¥çœ‹ã€‚]]></content>
      <categories>
        <category>Front-End Develop</category>
      </categories>
      <tags>
        <tag>Front-End Developer</tag>
        <tag>Hexo</tag>
        <tag>Next</tag>
        <tag>Blog</tag>
      </tags>
  </entry>
</search>
